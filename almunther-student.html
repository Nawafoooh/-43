<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø§ÙØ³ - Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-analytics-compat.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø¹Ù„ÙˆÙŠ */
        .top-bar {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 10px 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .top-bar .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .school-badge {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .school-logo {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 20px;
        }

        .school-info h3 {
            color: #2d3748;
            font-size: 16px;
        }

        .school-info p {
            color: #718096;
            font-size: 12px;
        }

        .user-menu {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: #e2e8f0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #4a5568;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .user-avatar:hover {
            background: #cbd5e0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(135deg, #667eea, #764ba2);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }

        .stat-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 15px;
        }

        .stat-icon.questions { background: #e3f2fd; color: #1976d2; }
        .stat-icon.students { background: #e8f5e9; color: #388e3c; }
        .stat-icon.points { background: #fff3e0; color: #f57c00; }
        .stat-icon.rank { background: #fce4ec; color: #c2185b; }

        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #718096;
            font-size: 14px;
        }

        /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ */
        .welcome-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .welcome-card h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .welcome-card p {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .supervisor-info {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255,255,255,0.2);
        }

        .supervisor-avatar {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        /* Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ù…Ø­ØªÙˆÙ‰ */
        .content-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e2e8f0;
        }

        .card-header h2 {
            color: #2d3748;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-header .badge {
            background: #e2e8f0;
            color: #4a5568;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
        }

        /* Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© */
        .questions-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .question-item {
            background: #f7fafc;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .question-item:hover {
            border-color: #667eea;
            transform: translateX(-5px);
        }

        .question-item.completed {
            background: #f0f9ff;
            border-color: #48bb78;
        }

        .question-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .question-subject {
            background: #e2e8f0;
            color: #4a5568;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 12px;
        }

        .question-status {
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-pending { color: #f59e0b; }
        .status-completed { color: #48bb78; }

        .question-text {
            color: #2d3748;
            font-size: 16px;
            margin-bottom: 10px;
        }

        .question-points {
            color: #667eea;
            font-weight: bold;
            font-size: 14px;
        }

        /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
        .progress-section {
            margin: 20px 0;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: #e2e8f0;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† */
        .leaderboard-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 12px;
            background: #f7fafc;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .leaderboard-item:hover {
            background: #edf2f7;
        }

        .rank {
            width: 30px;
            height: 30px;
            background: #e2e8f0;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #2d3748;
        }

        .rank.gold { background: #fbbf24; color: #92400e; }
        .rank.silver { background: #9ca3af; color: #1f2937; }
        .rank.bronze { background: #d97706; color: #78350f; }

        .student-info {
            flex: 1;
        }

        .student-name {
            font-weight: 600;
            color: #2d3748;
            margin-bottom: 3px;
        }

        .student-grade {
            font-size: 12px;
            color: #718096;
        }

        .student-score {
            font-weight: bold;
            color: #48bb78;
        }

        /* Ù†Ø§ÙØ°Ø© Ù…Ù†Ø¨Ø«Ù‚Ø© Ù„Ù„Ø£Ø³Ø¦Ù„Ø© */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            color: #2d3748;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #718096;
        }

        .options-grid {
            display: grid;
            gap: 15px;
            margin: 20px 0;
        }

        .option {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .option.selected {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }

        .timer {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin: 20px 0;
            color: #2d3748;
        }

        .timer.warning {
            color: #f59e0b;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: white;
            color: #2d3748;
            padding: 15px 30px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            display: none;
            z-index: 3000;
            border-right: 4px solid #48bb78;
        }

        .notification.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translate(-50%, -20px);
            }
            to {
                opacity: 1;
                transform: translate(-50%, 0);
            }
        }

        /* ØªØ°ÙŠÙŠÙ„ Ø§Ù„ØµÙØ­Ø© */
        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: white;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
            
            .top-bar .container {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
    <div class="top-bar">
        <div class="container">
            <div class="school-badge">
                <div class="school-logo">ğŸ«</div>
                <div class="school-info">
                    <h3>Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ</h3>
                    <p>Ø§Ù„Ù…Ø¯ÙŠÙ†Ø© Ø§Ù„Ù…Ù†ÙˆØ±Ø© - Ù…ÙƒØªØ¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø¨Ø¨Ø¯Ø±</p>
                </div>
            </div>
            <div class="user-menu">
                <span id="currentStudentName" style="color: #2d3748;">Ø·Ø§Ù„Ø¨</span>
                <div class="user-avatar" onclick="showStudentMenu()">
                    ğŸ‘¤
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Ù‚Ø³Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
        <div id="loginSection" class="card" style="max-width: 400px; margin: 50px auto;">
            <div style="text-align: center; margin-bottom: 30px;">
                <div style="font-size: 4em; margin-bottom: 20px;">ğŸ“š</div>
                <h2 style="color: #2d3748; margin-bottom: 10px;">Ù†Ø¸Ø§Ù… Ù†Ø§ÙØ³ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠ</h2>
                <p style="color: #718096;">Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ</p>
            </div>
            
            <div style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 8px; color: #4a5568;">Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</label>
                <input type="text" id="studentCode" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…ÙƒÙˆÙ† Ù…Ù† 6 Ø£Ø±Ù‚Ø§Ù…" maxlength="6" style="width: 100%; padding: 12px; border: 2px solid #e2e8f0; border-radius: 10px; font-size: 16px;">
            </div>
            
            <button class="stat-card" onclick="loginStudent()" style="width: 100%; border: none; cursor: pointer; background: linear-gradient(135deg, #667eea, #764ba2); color: white;">
                <div style="font-size: 18px;">Ø¯Ø®ÙˆÙ„</div>
            </button>
            
            <div style="margin-top: 20px; text-align: center; padding: 15px; background: #f7fafc; border-radius: 10px;">
                <p style="color: #718096; font-size: 14px;">
                    <strong>Ø§Ù„Ù…Ø´Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØµØ©:</strong><br>
                    Ø§Ù„Ø£Ø³ØªØ§Ø° Ù†ÙˆØ§Ù Ø§Ù„ØµØ¨Ø­ÙŠ<br>
                    <span style="color: #48bb78;">ğŸ“± Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±: 05xxxxxxxx</span>
                </p>
            </div>
            
            <div style="margin-top: 15px; text-align: center;">
                <small style="color: #a0aec0;">Ø¨Ø¥Ø´Ø±Ø§Ù Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©: Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ø§Ù„Ø¯ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ</small>
            </div>
        </div>

        <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Ù…Ø®ÙÙŠØ© ÙÙŠ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©) -->
        <div id="studentDashboard" style="display: none;">
            <!-- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„ØªØ±Ø­ÙŠØ¨ -->
            <div class="welcome-card">
                <h1>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…Ù†ØµØ© Ù†Ø§ÙØ³</h1>
                <p>Ù…Ù†ØµØ© Ø§Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© - Ù…ØªÙˆØ³Ø·Ø© Ø§Ù„Ù…Ù†Ø°Ø± Ø¨Ù† Ø¹Ù…Ø±Ùˆ Ø§Ù„Ø£Ù†ØµØ§Ø±ÙŠ</p>
                
                <div class="supervisor-info">
                    <div class="supervisor-avatar">ğŸ‘¨â€ğŸ«</div>
                    <div>
                        <div style="font-weight: bold;">Ø§Ù„Ù…Ø´Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù…Ù†ØµØ©</div>
                        <div style="font-size: 14px; opacity: 0.9;">Ø§Ù„Ø£Ø³ØªØ§Ø° Ù†ÙˆØ§Ù Ø§Ù„ØµØ¨Ø­ÙŠ</div>
                    </div>
                </div>
            </div>

            <!-- Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
            <div class="stats-grid">
                <div class="stat-card" onclick="startTest()">
                    <div class="stat-icon questions">ğŸ“</div>
                    <div class="stat-value" id="totalQuestions">0</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon students">âœ…</div>
                    <div class="stat-value" id="answeredQuestions">0</div>
                    <div class="stat-label">Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ø¬Ø§Ø¨Ø©</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon points">ğŸ†</div>
                    <div class="stat-value" id="studentScore">0</div>
                    <div class="stat-label">Ù†Ù‚Ø§Ø·ÙŠ</div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon rank">ğŸ“Š</div>
                    <div class="stat-value" id="studentRank">-</div>
                    <div class="stat-label">ØªØ±ØªÙŠØ¨ÙŠ</div>
                </div>
            </div>

            <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
            <div class="content-grid">
                <!-- Ù‚Ø³Ù… Ø§Ù„Ø£Ø³Ø¦Ù„Ø© -->
                <div class="card">
                    <div class="card-header">
                        <h2>
                            <span>ğŸ“‹</span>
                            Ø£Ø­Ø¯Ø« Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
                        </h2>
                        <span class="badge" id="questionsCount">0 Ø³Ø¤Ø§Ù„</span>
                    </div>
                    
                    <div class="questions-list" id="questionsList">
                        <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ù‡Ù†Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                    </div>
                </div>

                <!-- Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ† -->
                <div>
                    <div class="card">
                        <div class="card-header">
                            <h2>
                                <span>ğŸ†</span>
                                Ø£ÙØ¶Ù„ 5 Ø·Ù„Ø§Ø¨
                            </h2>
                            <span class="badge">Ù‡Ø°Ø§ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</span>
                        </div>
                        
                        <div class="leaderboard-list" id="leaderboardList">
                            <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ±ØªÙŠØ¨ Ù‡Ù†Ø§ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ -->
                        </div>
                    </div>

                    <!-- Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… -->
                    <div class="card">
                        <div class="card-header">
                            <h2>
                                <span>ğŸ“Š</span>
                                ØªÙ‚Ø¯Ù…Ùƒ
                            </h2>
                        </div>
                        
                        <div class="progress-section">
                            <div class="progress-info">
                                <span>ØªÙ‚Ø¯Ù…Ùƒ ÙÙŠ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª</span>
                                <span id="progressPercentage">0%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="progressBar" style="width: 0%;"></div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 20px;">
                            <button class="stat-card" onclick="startTest()" style="width: 100%; border: none; background: linear-gradient(135deg, #48bb78, #38a169); color: white;">
                                <div style="font-size: 16px;">â• Ø¨Ø¯Ø¡ Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø¯ÙŠØ¯</div>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© -->
    <div id="questionModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalQuestionTitle">Ø§Ù„Ø³Ø¤Ø§Ù„</h2>
                <button class="close-btn" onclick="closeModal()">Ã—</button>
            </div>
            
            <div id="modalTimer" class="timer">2:00</div>
            
            <div id="modalQuestionText" style="font-size: 18px; margin: 20px 0;">
                <!-- Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„ -->
            </div>
            
            <div class="options-grid" id="modalOptions">
                <!-- Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª -->
            </div>
            
            <div style="display: flex; gap: 10px;">
                <button class="stat-card" onclick="submitAnswer()" style="flex: 2; border: none; background: linear-gradient(135deg, #667eea, #764ba2); color: white;">
                    Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
                </button>
                <button class="stat-card" onclick="closeModal()" style="flex: 1; border: none; background: #e2e8f0; color: #4a5568;">
                    Ø¥Ù„ØºØ§Ø¡
                </button>
            </div>
        </div>
    </div>

    <!-- Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª -->
    <div id="notification" class="notification">
        <span id="notificationText"></span>
    </div>

    <!-- ØªØ°ÙŠÙŠÙ„ Ø§Ù„ØµÙØ­Ø© -->
    <div class="footer">
        <p>Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Â© 2026 - Ù…Ù†ØµØ© Ù†Ø§ÙØ³ Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ©</p>
        <p style="font-size: 12px;">Ø¨ØªÙƒÙ„ÙŠÙ Ù…Ù† Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø£Ø³ØªØ§Ø° Ø®Ø§Ù„Ø¯ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ</p>
    </div>

    <script>
        // ØªÙ‡ÙŠØ¦Ø© Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyD28cfba2NmXlsfBci9jgbne21U9rZLJ2M",
            authDomain: "nafis-new.firebaseapp.com",
            projectId: "nafis-new",
            storageBucket: "nafis-new.firebasestorage.app",
            messagingSenderId: "366381122504",
            appId: "1:366381122504:web:b76107c74d7d7ec82df6fd",
            measurementId: "G-ZD3Z9LEGGM"
        };

        // ØªÙ‡ÙŠØ¦Ø© Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const analytics = firebase.analytics();

        // Ù…ØªØºÙŠØ±Ø§Øª Ø¹Ø§Ù…Ø©
        const SCHOOL_ID = 'school_almonzer';
        let currentStudent = null;
        let currentQuestion = null;
        let questions = [];
        let timer = null;
        let timeLeft = 120;
        let selectedOption = null;

        // ============================================
        // Ø¯ÙˆØ§Ù„ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        // ============================================

        async function loginStudent() {
            const code = document.getElementById('studentCode').value.trim();
            
            if (!code || code.length !== 6) {
                showNotification('âŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… ØµØ­ÙŠØ­ Ù…ÙƒÙˆÙ† Ù…Ù† 6 Ø£Ø±Ù‚Ø§Ù…', 'error');
                return;
            }

            try {
                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø·Ø§Ù„Ø¨ ÙÙŠ Firebase
                const studentsRef = collection(db, 'students');
                const q = query(studentsRef, 
                    where('code', '==', code),
                    where('schoolId', '==', SCHOOL_ID)
                );
                
                const querySnapshot = await getDocs(q);
                
                if (querySnapshot.empty) {
                    showNotification('âŒ Ø±Ù‚Ù… Ø§Ù„Ø·Ø§Ù„Ø¨ ØºÙŠØ± ØµØ­ÙŠØ­', 'error');
                    return;
                }

                // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø·Ø§Ù„Ø¨
                const studentDoc = querySnapshot.docs[0];
                currentStudent = {
                    id: studentDoc.id,
                    ...studentDoc.data()
                };

                // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('studentDashboard').style.display = 'block';
                document.getElementById('currentStudentName').textContent = currentStudent.name;

                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                await loadQuestions();
                await loadStudentStats();
                await loadLeaderboard();

                showNotification(`âœ¨ Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ${currentStudent.name}`, 'success');

            } catch (error) {
                console.error('Login error:', error);
                showNotification('âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„', 'error');
            }
        }

        // ============================================
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
        // ============================================

        async function loadQuestions() {
            try {
                const questionsRef = collection(db, 'questions');
                const q = query(questionsRef, where('active', '==', true));
                const querySnapshot = await getDocs(q);
                
                questions = [];
                querySnapshot.forEach((doc) => {
                    questions.push({
                        id: doc.id,
                        ...doc.data()
                    });
                });

                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø¯Ø§Ø¯
                document.getElementById('totalQuestions').textContent = questions.length;
                document.getElementById('questionsCount').textContent = questions.length + ' Ø³Ø¤Ø§Ù„';

                // Ø¹Ø±Ø¶ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©
                displayQuestions();

            } catch (error) {
                console.error('Error loading questions:', error);
            }
        }

        function displayQuestions() {
            const questionsList = document.getElementById('questionsList');
            
            if (!questions || questions.length === 0) {
                questionsList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #718096;">
                        <div style="font-size: 3em; margin-bottom: 15px;">ğŸ“­</div>
                        <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø¦Ù„Ø© Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹</p>
                    </div>
                `;
                return;
            }

            // Ø¹Ø±Ø¶ Ø¢Ø®Ø± 5 Ø£Ø³Ø¦Ù„Ø©
            const recentQuestions = questions.slice(0, 5);
            
            questionsList.innerHTML = recentQuestions.map((q, index) => {
                const isCompleted = currentStudent?.answeredQuestions?.includes(q.id);
                return `
                    <div class="question-item ${isCompleted ? 'completed' : ''}" onclick="openQuestion(${index})">
                        <div class="question-meta">
                            <span class="question-subject">${q.subject || 'Ø¹Ø§Ù…'}</span>
                            <span class="question-status ${isCompleted ? 'status-completed' : 'status-pending'}">
                                ${isCompleted ? 'âœ“ ØªÙ…Øª Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©' : 'â³ ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©'}
                            </span>
                        </div>
                        <div class="question-text">
                            ${q.question.length > 100 ? q.question.substring(0, 100) + '...' : q.question}
                        </div>
                        <div class="question-points">
                            â­ ${q.points || 1} Ù†Ù‚Ø·Ø©
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ============================================
        // ÙØªØ­ Ø§Ù„Ø³Ø¤Ø§Ù„
        // ============================================

        function openQuestion(index) {
            currentQuestion = questions[index];
            
            document.getElementById('modalQuestionTitle').textContent = `Ø§Ù„Ø³Ø¤Ø§Ù„ ${index + 1}`;
            document.getElementById('modalQuestionText').textContent = currentQuestion.question;
            
            // Ø¹Ø±Ø¶ Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
            const optionsHtml = currentQuestion.options.map((opt, i) => `
                <div class="option" onclick="selectOption(${i})">
                    ${String.fromCharCode(65 + i)}) ${opt}
                </div>
            `).join('');
            
            document.getElementById('modalOptions').innerHTML = optionsHtml;
            
            // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†Ø§ÙØ°Ø©
            document.getElementById('questionModal').classList.add('active');
            
            // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ù‚Øª
            startTimer();
        }

        function selectOption(index) {
            selectedOption = index;
            
            // ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª
            document.querySelectorAll('.option').forEach((opt, i) => {
                if (i === index) {
                    opt.classList.add('selected');
                } else {
                    opt.classList.remove('selected');
                }
            });
        }

        function startTimer() {
            timeLeft = 120;
            updateTimerDisplay();
            
            if (timer) clearInterval(timer);
            
            timer = setInterval(() => {
                timeLeft--;
                updateTimerDisplay();
                
                if (timeLeft <= 0) {
                    clearInterval(timer);
                    handleTimeOut();
                }
            }, 1000);
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            const display = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            const timerElement = document.getElementById('modalTimer');
            timerElement.textContent = display;
            
            if (timeLeft <= 30) {
                timerElement.classList.add('warning');
            } else {
                timerElement.classList.remove('warning');
            }
        }

        function handleTimeOut() {
            showNotification('â° Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙˆÙ‚Øª!', 'warning');
            closeModal();
        }

        // ============================================
        // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
        // ============================================

        async function submitAnswer() {
            if (selectedOption === null) {
                showNotification('âŒ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ø®ØªÙŠØ§Ø± Ø¥Ø¬Ø§Ø¨Ø©', 'error');
                return;
            }

            if (!currentStudent || !currentQuestion) return;

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©
            const isCorrect = selectedOption === currentQuestion.correct;
            
            if (isCorrect) {
                // ØªØ­Ø¯ÙŠØ« Ù†Ù‚Ø§Ø· Ø§Ù„Ø·Ø§Ù„Ø¨
                currentStudent.score = (currentStudent.score || 0) + (currentQuestion.points || 1);
                
                // ØªØ­Ø¯ÙŠØ« ÙÙŠ Firebase
                try {
                    const studentRef = doc(db, 'students', currentStudent.id);
                    await updateDoc(studentRef, {
                        score: currentStudent.score,
                        lastActive: new Date()
                    });
                    
                    showNotification('âœ… Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! +1 Ù†Ù‚Ø·Ø©', 'success');
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
                    document.getElementById('studentScore').textContent = currentStudent.score;
                    
                } catch (error) {
                    console.error('Error updating score:', error);
                }
            } else {
                showNotification('âŒ Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø©! Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰', 'error');
            }

            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©
            closeModal();
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            await loadStudentStats();
            await loadLeaderboard();
        }

        // ============================================
        // ØªØ­Ù…ÙŠÙ„ Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø·Ø§Ù„Ø¨
        // ============================================

        async function loadStudentStats() {
            if (!currentStudent) return;

            try {
                // Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ù…Ø¬Ø§Ø¨Ø©
                const answeredCount = currentStudent.answeredQuestions?.length || 0;
                document.getElementById('answeredQuestions').textContent = answeredCount;
                
                // Ø§Ù„Ù†Ù‚Ø§Ø·
                document.getElementById('studentScore').textContent = currentStudent.score || 0;
                
                // Ù†Ø³Ø¨Ø© Ø§Ù„ØªÙ‚Ø¯Ù…
                const progress = questions.length > 0 
                    ? Math.round((answeredCount / questions.length) * 100) 
                    : 0;
                document.getElementById('progressPercentage').textContent = progress + '%';
                document.getElementById('progressBar').style.width = progress + '%';

            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        // ============================================
        // ØªØ­Ù…ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ù…ØªØµØ¯Ø±ÙŠÙ†
        // ============================================

        async function loadLeaderboard() {
            try {
                const studentsRef = collection(db, 'students');
                const q = query(
                    studentsRef, 
                    where('schoolId', '==', SCHOOL_ID),
                    orderBy('score', 'desc'),
                    limit(5)
                );
                
                const querySnapshot = await getDocs(q);
                
                let rank = 1;
                let studentRank = 0;
                const leaderboardHtml = [];
                
                querySnapshot.forEach((doc) => {
                    const student = doc.data();
                    
                    // ØªØ­Ø¯ÙŠØ¯ Ù„ÙˆÙ† Ø§Ù„ØªØ±ØªÙŠØ¨
                    let rankClass = '';
                    if (rank === 1) rankClass = 'gold';
                    else if (rank === 2) rankClass = 'silver';
                    else if (rank === 3) rankClass = 'bronze';
                    
                    leaderboardHtml.push(`
                        <div class="leaderboard-item">
                            <div class="rank ${rankClass}">${rank}</div>
                            <div class="student-info">
                                <div class="student-name">${student.name}</div>
                                <div class="student-grade">Ø§Ù„ØµÙ ${student.grade}</div>
                            </div>
                            <div class="student-score">${student.score || 0}</div>
                        </div>
                    `);
                    
                    // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ù‡Ùˆ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ
                    if (student.code === currentStudent.code) {
                        studentRank = rank;
                    }
                    
                    rank++;
                });
                
                document.getElementById('leaderboardList').innerHTML = leaderboardHtml.join('');
                                document.getElementById('studentRank').textContent = studentRank || '-';
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø·Ø§Ù„Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø£ÙØ¶Ù„ 5ØŒ Ù†Ø¨Ø­Ø« Ø¹Ù† ØªØ±ØªÙŠØ¨Ù‡
                if (studentRank === 0) {
                    const allStudentsQuery = query(
                        collection(db, 'students'),
                        where('schoolId', '==', SCHOOL_ID),
                        orderBy('score', 'desc')
                    );
                    
                    const allSnapshot = await getDocs(allStudentsQuery);
                    let allRank = 1;
                    allSnapshot.forEach((doc) => {
                        if (doc.data().code === currentStudent.code) {
                            studentRank = allRank;
                        }
                        allRank++;
                    });
                    
                    document.getElementById('studentRank').textContent = studentRank || '-';
                }

            } catch (error) {
                console.error('Error loading leaderboard:', error);
            }
        }

        // ============================================
        // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø©
        // ============================================

        function closeModal() {
            document.getElementById('questionModal').classList.remove('active');
            if (timer) {
                clearInterval(timer);
                timer = null;
            }
            selectedOption = null;
        }

        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            const notificationText = document.getElementById('notificationText');
            
            notificationText.textContent = message;
            notification.className = 'notification show';
            
            // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± Ø­Ø³Ø¨ Ø§Ù„Ù†ÙˆØ¹
            if (type === 'success') {
                notification.style.borderRightColor = '#48bb78';
            } else if (type === 'error') {
                notification.style.borderRightColor = '#f56565';
            } else if (type === 'warning') {
                notification.style.borderRightColor = '#ed8936';
            }
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function showStudentMenu() {
            // Ù‚Ø§Ø¦Ù…Ø© Ù…Ù†Ø³Ø¯Ù„Ø© Ø¨Ø³ÙŠØ·Ø©
            const menu = document.createElement('div');
            menu.style.cssText = `
                position: absolute;
                top: 70px;
                left: 20px;
                background: white;
                border-radius: 10px;
                box-shadow: 0 4px 15px rgba(0,0,0,0.2);
                padding: 10px;
                z-index: 1001;
            `;
            
            menu.innerHTML = `
                <div style="padding: 10px; cursor: pointer;" onclick="logout()">ğŸšª ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</div>
            `;
            
            document.body.appendChild(menu);
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
            setTimeout(() => {
                document.addEventListener('click', function removeMenu(e) {
                    if (!menu.contains(e.target) && !e.target.classList.contains('user-avatar')) {
                        menu.remove();
                        document.removeEventListener('click', removeMenu);
                    }
                });
            }, 100);
        }

        function logout() {
            currentStudent = null;
            document.getElementById('loginSection').style.display = 'block';
            document.getElementById('studentDashboard').style.display = 'none';
            document.getElementById('studentCode').value = '';
            document.getElementById('currentStudentName').textContent = 'Ø·Ø§Ù„Ø¨';
            showNotification('ğŸ‘‹ ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­', 'info');
        }

        function startTest() {
            if (questions.length === 0) {
                showNotification('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø³Ø¦Ù„Ø© Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹', 'error');
                return;
            }
            
            // ÙØªØ­ Ø£ÙˆÙ„ Ø³Ø¤Ø§Ù„ ØºÙŠØ± Ù…Ø¬Ø§Ø¨
            const unansweredIndex = questions.findIndex(q => 
                !currentStudent?.answeredQuestions?.includes(q.id)
            );
            
            if (unansweredIndex !== -1) {
                openQuestion(unansweredIndex);
            } else {
                showNotification('ğŸ‰ Ù„Ù‚Ø¯ Ø£ØªÙ…Ù…Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¦Ù„Ø©!', 'success');
            }
        }

        // ============================================
        // Ø¥Ø¶Ø§ÙØ© Ø¨Ø¹Ø¶ Ø§Ù„Ø·Ù„Ø§Ø¨ Ù„Ù„Ø§Ø®ØªØ¨Ø§Ø± (Ù„Ù„ØªØ¬Ø±Ø¨Ø©)
        // ============================================

        async function addSampleStudents() {
            const sampleStudents = [
                {
                    name: 'Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯ Ø§Ù„Ø­Ø±Ø¨ÙŠ',
                    grade: '1',
                    code: '123456',
                    schoolId: SCHOOL_ID,
                    score: 15,
                    createdAt: new Date(),
                    lastActive: new Date()
                },
                {
                    name: 'Ø³Ø§Ø±Ø© Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ',
                    grade: '2',
                    code: '123457',
                    schoolId: SCHOOL_ID,
                    score: 12,
                    createdAt: new Date(),
                    lastActive: new Date()
                },
                {
                    name: 'ÙØ§Ø·Ù…Ø© Ø¹Ù„ÙŠ Ø§Ù„Ù‚Ø±Ù†ÙŠ',
                    grade: '3',
                    code: '123458',
                    schoolId: SCHOOL_ID,
                    score: 10,
                    createdAt: new Date(),
                    lastActive: new Date()
                },
                {
                    name: 'Ø¹Ù…Ø± Ø®Ø§Ù„Ø¯ Ø§Ù„Ø¹Ù†Ø²ÙŠ',
                    grade: '1',
                    code: '123459',
                    schoolId: SCHOOL_ID,
                    score: 8,
                    createdAt: new Date(),
                    lastActive: new Date()
                },
                {
                    name: 'Ù†ÙˆØ±Ø© Ø³Ø¹Ø¯ Ø§Ù„Ø¯ÙˆØ³Ø±ÙŠ',
                    grade: '2',
                    code: '123460',
                    schoolId: SCHOOL_ID,
                    score: 6,
                    createdAt: new Date(),
                    lastActive: new Date()
                }
            ];

            try {
                for (const student of sampleStudents) {
                    await addDoc(collection(db, 'students'), student);
                }
                console.log('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠÙŠÙ†');
            } catch (error) {
                console.error('Error adding sample students:', error);
            }
        }

        // ============================================
        // Ø¥Ø¶Ø§ÙØ© Ø£Ø³Ø¦Ù„Ø© ØªØ¬Ø±ÙŠØ¨ÙŠØ©
        // ============================================

        async function addSampleQuestions() {
            const sampleQuestions = [
                {
                    question: 'Ù…Ø§ Ù‡Ùˆ Ø­Ø§ØµÙ„ Ø¶Ø±Ø¨ 7 Ã— 8ØŸ',
                    options: ['54', '56', '58', '60'],
                    correct: 1,
                    subject: 'Ø±ÙŠØ§Ø¶ÙŠØ§Øª',
                    points: 1,
                    active: true
                },
                {
                    question: 'Ù…Ù† Ù‡Ùˆ Ø£ÙˆÙ„ Ø®Ù„ÙŠÙØ© Ø±Ø§Ø´Ø¯ØŸ',
                    options: ['Ø¹Ù…Ø± Ø¨Ù† Ø§Ù„Ø®Ø·Ø§Ø¨', 'Ø£Ø¨Ùˆ Ø¨ÙƒØ± Ø§Ù„ØµØ¯ÙŠÙ‚', 'Ø¹Ø«Ù…Ø§Ù† Ø¨Ù† Ø¹ÙØ§Ù†', 'Ø¹Ù„ÙŠ Ø¨Ù† Ø£Ø¨ÙŠ Ø·Ø§Ù„Ø¨'],
                    correct: 1,
                    subject: 'ØªØ§Ø±ÙŠØ®',
                    points: 1,
                    active: true
                },
                {
                    question: 'ÙƒÙ… Ø¹Ø¯Ø¯ Ø£Ø±ÙƒØ§Ù† Ø§Ù„Ø¥Ø³Ù„Ø§Ù…ØŸ',
                    options: ['3', '4', '5', '6'],
                    correct: 2,
                    subject: 'ØªØ±Ø¨ÙŠØ© Ø¥Ø³Ù„Ø§Ù…ÙŠØ©',
                    points: 1,
                    active: true
                },
                {
                    question: 'Ù…Ø§ Ù‡ÙŠ Ø¹Ø§ØµÙ…Ø© Ø§Ù„Ù…Ù…Ù„ÙƒØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©ØŸ',
                    options: ['Ø¬Ø¯Ø©', 'Ø§Ù„Ø±ÙŠØ§Ø¶', 'Ù…ÙƒØ©', 'Ø§Ù„Ø¯Ù…Ø§Ù…'],
                    correct: 1,
                    subject: 'Ø¬ØºØ±Ø§ÙÙŠØ§',
                    points: 1,
                    active: true
                },
                {
                    question: 'Ù…Ø§ Ù‡Ùˆ Ø£ÙƒØ¨Ø± ÙƒÙˆÙƒØ¨ ÙÙŠ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„Ø´Ù…Ø³ÙŠØ©ØŸ',
                    options: ['Ø§Ù„Ø£Ø±Ø¶', 'Ø§Ù„Ù…Ø±ÙŠØ®', 'Ø§Ù„Ù…Ø´ØªØ±ÙŠ', 'Ø²Ø­Ù„'],
                    correct: 2,
                    subject: 'Ø¹Ù„ÙˆÙ…',
                    points: 1,
                    active: true
                }
            ];

            try {
                for (const question of sampleQuestions) {
                    await addDoc(collection(db, 'questions'), question);
                }
                console.log('âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©');
            } catch (error) {
                console.error('Error adding sample questions:', error);
            }
        }

        // ============================================
        // Ø¯ÙˆØ§Ù„ Ù…Ø³Ø§Ø¹Ø¯Ø© Firebase (ØªØµØ­ÙŠØ­ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡)
        // ============================================

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Collection Reference
        function collection(db, path) {
            return firebase.firestore().collection(path);
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¹Ù…Ù„ Query
        function query(collectionRef, ...conditions) {
            let q = collectionRef;
            conditions.forEach(condition => {
                if (condition.type === 'where') {
                    q = q.where(condition.field, condition.operator, condition.value);
                } else if (condition.type === 'orderBy') {
                    q = q.orderBy(condition.field, condition.direction);
                } else if (condition.type === 'limit') {
                    q = q.limit(condition.limit);
                }
            });
            return q;
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ where
        function where(field, operator, value) {
            return { type: 'where', field, operator, value };
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ orderBy
        function orderBy(field, direction = 'asc') {
            return { type: 'orderBy', field, direction };
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¥Ù†Ø´Ø§Ø¡ limit
        function limit(limit) {
            return { type: 'limit', limit };
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„ØªÙ†ÙÙŠØ° query
        async function getDocs(q) {
            return await q.get();
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Document Reference
        function doc(db, path, ...pathSegments) {
            return firebase.firestore().doc(path + (pathSegments.length ? '/' + pathSegments.join('/') : ''));
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¥Ø¶Ø§ÙØ© Document
        async function addDoc(collectionRef, data) {
            return await collectionRef.add(data);
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„ØªØ­Ø¯ÙŠØ« Document
        async function updateDoc(docRef, data) {
            return await docRef.update(data);
        }

        // ============================================
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙØ­Ø©
        // ============================================

        document.addEventListener('DOMContentLoaded', () => {
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ù„Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Enter ÙÙŠ Ø­Ù‚Ù„ Ø§Ù„Ø±Ù‚Ù…
            document.getElementById('studentCode').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    loginStudent();
                }
            });

            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø¨ÙŠØ§Ù†Ø§ØªØŒ ÙˆØ¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ØªØ¬Ø±ÙŠØ¨ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ÙØ§Ø±ØºØ©
            setTimeout(async () => {
                try {
                    const studentsSnapshot = await getDocs(collection(db, 'students'));
                    if (studentsSnapshot.empty) {
                        await addSampleStudents();
                    }
                    
                    const questionsSnapshot = await getDocs(collection(db, 'questions'));
                    if (questionsSnapshot.empty) {
                        await addSampleQuestions();
                    }
                } catch (error) {
                    console.error('Error checking initial data:', error);
                }
            }, 1000);
        });

        // Ù…Ù†Ø¹ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ø¹Ø±Ø¶ÙŠ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
        window.addEventListener('beforeunload', (e) => {
            if (document.getElementById('questionModal').classList.contains('active')) {
                e.preventDefault();
                e.returnValue = 'Ù„Ø¯ÙŠÙƒ Ø§Ø®ØªØ¨Ø§Ø± Ø¬Ø§Ø±ÙŠ. Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù…ØºØ§Ø¯Ø±Ø©ØŸ';
                return e.returnValue;
            }
        });

    </script>
</body>
</html>
