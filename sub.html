<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠØ© Ø§Ù„Ø°ÙƒÙŠ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .tab-active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
        .tab-inactive { color: #4a5568; }
        .tab-inactive:hover { background-color: #f7fafc; }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .notification { animation: slideIn 0.3s ease-out; }
        .priority-1 { background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); border-right: 4px solid #10b981; }
        .priority-2 { background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border-right: 4px solid #f59e0b; }
        .priority-3 { background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%); border-right: 4px solid #ef4444; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen p-4">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <div class="flex items-center gap-3">
                    <svg class="w-10 h-10 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    <div>
                        <h1 class="text-3xl font-bold text-gray-800">Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø°ÙƒÙŠ</h1>
                        <p class="text-gray-600">Ù†Ø¸Ø§Ù… Ø°ÙƒÙŠ Ù„Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¹Ù„Ù…ÙŠ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­Ø³Ø¨ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª ÙˆØ§Ù„Ø´Ø±ÙˆØ·</p>
                    </div>
                </div>
                <div class="flex gap-2 flex-wrap">
                    <button onclick="saveAllData()" class="flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                        </svg>
                        Ø­ÙØ¸
                    </button>
                    <button onclick="initializeSystem()" class="flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                        </svg>
                        ØªÙ‡ÙŠØ¦Ø©
                    </button>
                    <button onclick="clearAllData()" class="flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                        Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„
                    </button>
                </div>
            </div>
        </div>

        <!-- Notification -->
        <div id="notification" class="hidden mb-4 p-4 rounded-lg notification"></div>

        <!-- Tabs -->
        <div class="bg-white rounded-lg shadow-lg mb-6">
            <div class="flex flex-col md:flex-row border-b">
                <button onclick="switchTab('teachers')" id="tab-teachers" class="flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-active">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                    Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†
                </button>
                <button onclick="switchTab('schedule')" id="tab-schedule" class="flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-inactive">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ
                </button>
                <button onclick="switchTab('smart-substitution')" id="tab-smart-substitution" class="flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-inactive">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒÙŠ
                </button>
                <button onclick="switchTab('absences')" id="tab-absences" class="flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-inactive">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    Ø³Ø¬Ù„ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
                </button>
            </div>
        </div>

        <!-- Content -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <!-- Teachers Tab -->
            <div id="content-teachers" class="tab-content">
                <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† ÙˆØ£ÙˆÙ„ÙˆÙŠØ§Øª Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</h2>
                    <div class="flex gap-2">
                        <button onclick="addTeacher()" class="flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù…</button>
                        <button onclick="generatePriorityReport()" class="flex items-center gap-2 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª</button>
                    </div>
                </div>
                <div id="teachers-list" class="grid gap-4"></div>
            </div>

            <!-- Schedule Tab -->
            <div id="content-schedule" class="tab-content hidden">
                <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800">Ø§Ù„Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ</h2>
                    <button onclick="addScheduleEntry()" class="flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">Ø¥Ø¶Ø§ÙØ© Ø­ØµØ©</button>
                </div>
                <div class="overflow-x-auto">
                    <div id="schedule-list"></div>
                </div>
            </div>

            <!-- Smart Substitution Tab -->
            <div id="content-smart-substitution" class="tab-content hidden">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-gradient-to-br from-green-50 to-blue-50 p-6 rounded-lg border border-green-200">
                        <h2 class="text-2xl font-bold text-gray-800 mb-4">ğŸ¤– Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø°ÙƒÙŠ</h2>
                        <div class="space-y-4">
                            <div class="bg-white p-4 rounded-lg shadow">
                                <h3 class="font-bold text-lg text-green-700 mb-2">ØªØ¹ÙŠÙŠÙ† Ø§Ù†ØªØ¸Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠ</h3>
                                <p class="text-gray-600 mb-3 text-sm">Ø³ÙŠÙ‚ÙˆÙ… Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø§Ø®ØªÙŠØ§Ø± Ø£ÙØ¶Ù„ Ù…Ø¹Ù„Ù… Ù„Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­Ø³Ø¨ Ø§Ù„Ø´Ø±ÙˆØ· Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</p>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„ÙŠÙˆÙ…</label>
                                        <select id="substitution-day" class="w-full p-2 border border-gray-300 rounded-lg">
                                            <option value="Ø§Ù„Ø£Ø­Ø¯">Ø§Ù„Ø£Ø­Ø¯</option>
                                            <option value="Ø§Ù„Ø§Ø«Ù†ÙŠÙ†">Ø§Ù„Ø§Ø«Ù†ÙŠÙ†</option>
                                            <option value="Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡">Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option>
                                            <option value="Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡">Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option>
                                            <option value="Ø§Ù„Ø®Ù…ÙŠØ³">Ø§Ù„Ø®Ù…ÙŠØ³</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">Ø§Ù„Ø­ØµØ©</label>
                                        <select id="substitution-period" class="w-full p-2 border border-gray-300 rounded-lg">
                                            <option value="1">Ø§Ù„Ø­ØµØ© 1</option>
                                            <option value="2">Ø§Ù„Ø­ØµØ© 2</option>
                                            <option value="3">Ø§Ù„Ø­ØµØ© 3</option>
                                            <option value="4">Ø§Ù„Ø­ØµØ© 4</option>
                                            <option value="5">Ø§Ù„Ø­ØµØ© 5</option>
                                            <option value="6">Ø§Ù„Ø­ØµØ© 6</option>
                                            <option value="7">Ø§Ù„Ø­ØµØ© 7</option>
                                        </select>
                                    </div>
                                </div>
                                <button onclick="findBestSubstitute()" class="w-full mt-4 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition font-semibold">
                                    ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø£ÙØ¶Ù„ Ù…Ø¹Ù„Ù… Ù„Ù„Ø§Ù†ØªØ¸Ø§Ø±
                                </button>
                            </div>
                        </div>
                    </div>

                    <div>
                        <div class="bg-white p-6 rounded-lg shadow border">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">ğŸ“Š Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø«</h3>
                            <div id="substitution-results" class="space-y-3">
                                <p class="text-gray-500 text-center py-8">Ø³ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† Ù„Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­Ø³Ø¨ Ø§Ù„Ø´Ø±ÙˆØ·</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Ø´Ø±ÙˆØ· Ø§Ù„Ù†Ø¸Ø§Ù… -->
                <div class="mt-6 bg-yellow-50 p-6 rounded-lg border border-yellow-200">
                    <h3 class="text-lg font-bold text-yellow-800 mb-3">ğŸ“‹ Ø´Ø±ÙˆØ· Ù†Ø¸Ø§Ù… Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø°ÙƒÙŠ</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-yellow-700">
                        <div class="flex items-start gap-2">
                            <span class="bg-yellow-200 rounded-full px-2 py-1 text-xs font-bold">1</span>
                            <span>Ù„Ø§ ÙŠØ£Ø®Ø° Ø§Ù„Ù…Ø¹Ù„Ù… Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù†ØªØ¸Ø§Ø± ÙˆØ§Ø­Ø¯ ÙÙŠ Ø§Ù„ÙŠÙˆÙ…</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="bg-yellow-200 rounded-full px-2 py-1 text-xs font-bold">2</span>
                            <span>Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ© Ù„Ù…Ù† Ù„Ù… ÙŠØ£Ø®Ø° Ø§Ù†ØªØ¸Ø§Ø± ÙÙŠ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="bg-yellow-200 rounded-full px-2 py-1 text-xs font-bold">3</span>
                            <span>Ù…Ø±Ø§Ø¹Ø§Ø© Ø¹Ø¯Ø¯ Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„ÙƒÙ„ Ù…Ø¹Ù„Ù…</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="bg-yellow-200 rounded-full px-2 py-1 text-xs font-bold">4</span>
                            <span>Ø§Ù„Ù…Ø¹Ù„Ù… Ø§Ù„Ù…Ø´ØºÙˆÙ„ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ø­ØµØ© Ù„Ø§ ÙŠØ¯Ø®Ù„ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Absences Tab -->
            <div id="content-absences" class="tab-content hidden">
                <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800">Ø³Ø¬Ù„ Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</h2>
                    <button onclick="exportAbsencesReport()" class="flex items-center gap-2 bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        ØªØµØ¯ÙŠØ± ØªÙ‚Ø±ÙŠØ±
                    </button>
                </div>
                <div id="absences-list" class="space-y-4"></div>
            </div>
        </div>

        <!-- Statistics -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-6">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†</p>
                        <p id="stat-teachers" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">Ø¹Ø¯Ø¯ Ø§Ù„Ø­ØµØµ</p>
                        <p id="stat-schedule" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</p>
                        <p id="stat-absences" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">Ø§Ù„Ù†Ø¸Ø§Ù…</p>
                        <p class="text-3xl font-bold text-gray-800">ğŸš€</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let teachers = [];
        let schedule = [];
        let absences = [];

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© Ù„ÙƒÙ„ Ù…Ø¹Ù„Ù…
        const teacherSubstitutionRequirements = {
            "Ø¹Ø¨Ø¯Ø§Ù„Ù‡Ø§Ø¯ÙŠ Ù…Ø¹ÙŠØ¶ Ø§Ù„Ø´Ø§Ù…Ø§Ù†ÙŠ": 3,
            "Ø¹Ø¨ÙŠØ¯ Ø¨Ù† Ø¯Ø®ÙŠÙ„ Ø§Ù„Ø¹ÙŠØ§Ø¶ÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ": 1,
            "Ø¹Ù„ÙŠ Ù…ØªØ¹Ø¨ Ø§Ù„Ø¹Ù„ÙˆÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ": 0,
            "ÙÙ‡Ø¯ Ø¹ÙˆÙŠØ¶ Ø§Ù„Ø´Ø§Ù…Ø§Ù†ÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ": 7,
            "ÙØ¤Ø§Ø¯ Ø¨Ù† Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¹ØªÙŠØ¨ÙŠ": 0,
            "ÙÙŠØµÙ„ Ø¹Ø·Ø§Ù„Ù„Ù‡ Ø§Ù„ØµØ§Ø¹Ø¯ÙŠ": 10,
            "Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø°Ø¹Ø§Ø± Ø§Ù„Ø¹ÙˆÙÙŠ": 2,
            "Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø¹Ù…Ø§Ø±ÙŠ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ": 4,
            "Ù…Ø­Ù…Ø¯ Ø¹ÙŠØ§Ø¯ Ø§Ù„Ø¹ÙˆÙÙŠ": 9,
            "Ù…Ø´Ø¹Ù„ Ø¨Ù† Ù‡Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù…Ø±ÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ": 0,
            "ÙÙŠØµÙ„ Ø¹ÙˆØ§Ø¯ Ø£Ø¨Ùˆ Ø³Ù„Ù…ÙŠ": 0,
            "Ù…ÙˆØ³Ù‰ ØºØ§Ø²ÙŠ Ø³ÙØ± Ø§Ù„Ø­Ø±Ø¨ÙŠ": 3,
            "Ù…ÙˆÙÙ‚ Ù…Ø±Ø²ÙˆÙ‚ Ø§Ù„Ø³Ø­ÙŠÙ…ÙŠ": 9,
            "Ù†Ø§ÙØ¹ Ø´Ø¹ÙˆÙŠ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ": 3,
            "Ù†Ù…ÙŠØ§Ù† Ø¹Ù„ÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ": 7,
            "Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ø§ÙŠØ¶ Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠ": 10,
            "Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹ÙŠØ§Ø¯ Ø§Ù„Ø¹Ù„ÙˆÙŠ": 5,
            "Ø£Ø­Ù…Ø¯ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø§Ù„ØªØ±ÙƒÙŠ": 8,
            "Ø£Ø­Ù…Ø¯ Ø­Ø§Ù…Ø¯ Ø§Ù„Ø­Ø±Ø¨ÙŠ": 0,
            "Ø§Ø³Ø§Ù…Ù‡ Ù…Ù†ÙˆØ± Ø§Ù„Ø¹ÙˆÙÙŠ": 3,
            "Ø¨Ø¯Ø± Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø§Ù„Ø³Ø­ÙŠÙ…ÙŠ": 11,
            "Ø­Ø¨ÙŠØ¨ Ø¹Ù„ÙŠ Ø§Ù„Ø¹Ù…Ø±ÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ": 7,
            "Ø­Ù…Ø²Ø© ØµØ¯Ù‚Ø© Ø§Ø³Ù„Ø§Ù…": 0,
            "Ø³Ø§ÙŠØ± ÙÙŠØµÙ„ Ø§Ù„Ø¹Ø¶ÙŠÙ„Ù‡ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ": 0,
            "Ø³Ø¹Ø¯ Ø·Ø§Ù„Ø¹ Ø§Ù„Ø­Ø±Ø¨ÙŠ": 10,
            "Ø³Ù„Ø·Ø§Ù† Ø¹ÙˆÙŠØ¶ Ø§Ù„Ø³Ø­ÙŠÙ…ÙŠ": 8,
            "Ø³Ù„Ù…Ø§Ù† ØµØ§Ù„Ø­ Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ": 11,
            "Ø³ÙŠÙ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ù†Ø¹Ù… Ø§Ù„Ø¹Ø§Ø±Ø¶ÙŠ": 3,
            "Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù† ØºÙ„Ø§Ø¨ Ø§Ù„Ù…Ø®Ù„ÙÙŠ": 0,
            "Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ù…ÙÙ„Ø­ Ø§Ù„Ø±ÙˆÙŠØ«ÙŠ": 9,
            "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù…Ø­Ù…Ø¯ Ø§Ù„Ù‚Ø±Ù†ÙŠ": 3,
            "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù…Ø·Ø± Ø§Ù„Ø¹Ù…Ø±ÙŠ": 8,
            "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø­Ù…ÙˆØ¯ Ø§Ù„Ø­Ø±Ø¨ÙŠ": 0,
            "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ ØµÙ„Ø§Ø­ Ø§Ù„Ø±Ø­ÙŠÙ„Ù‰": 0,
            "ÙƒØ§ØªØ¨ Ù…ÙÙ„Ø­ Ø§Ù„Ø±Ø´ÙŠØ¯Ù‰": 3,
            "Ù†ÙˆØ§Ù Ù…Ù†ØµÙˆØ± Ø§Ù„ØµØ¨Ø­ÙŠ": 3,
            "Ù…ÙˆØ³Ù‰ Ù…Ø³Ø¹ÙˆØ¯ Ø§Ù„Ø­ÙŠØ³ÙˆÙ†ÙŠ": 3,
            "ÙÙˆØ§Ø² Ø²Ø§ÙŠØ¯ Ø§Ù„Ù…Ù‡ÙŠÙ…Ø²ÙŠ Ø§Ù„Ø±Ø´ÙŠØ¯ÙŠ": 1
        };

        // Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†
        const excelTeachers = [
            "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù…Ø·Ø± Ø§Ù„Ø¹Ù…Ø±ÙŠ",
            "Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø¹Ù…Ø§Ø±ÙŠ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ",
            "Ù…ÙˆÙÙ‚ Ù…Ø±Ø²ÙˆÙ‚ Ø§Ù„Ø³Ø­ÙŠÙ…ÙŠ",
            "ÙÙˆØ§Ø² Ø²Ø§ÙŠØ¯ Ø§Ù„Ù…Ù‡ÙŠÙ…Ø²ÙŠ Ø§Ù„Ø±Ø´ÙŠØ¯ÙŠ",
            "ÙÙŠØµÙ„ Ø¹Ø·Ø§Ù„Ù„Ù‡ Ø§Ù„ØµØ§Ø¹Ø¯ÙŠ",
            "Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹ÙŠØ§Ø¯ Ø§Ù„Ø¹Ù„ÙˆÙŠ",
            "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø­Ù…ÙˆØ¯ Ø§Ù„Ø­Ø±Ø¨ÙŠ",
            "Ø³Ø§ÙŠØ± ÙÙŠØµÙ„ Ø§Ù„Ø¹Ø¶ÙŠÙ„Ù‡ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ",
            "Ù†Ø§ÙØ¹ Ø´Ø¹ÙˆÙŠ Ø§Ù„Ù…Ø·ÙŠØ±ÙŠ",
            "Ø§Ø³Ø§Ù…Ù‡ Ù…Ù†ÙˆØ± Ø§Ù„Ø¹ÙˆÙÙŠ",
            "Ù…Ø­Ù…Ø¯ Ø¹ÙŠØ§Ø¯ Ø§Ù„Ø¹ÙˆÙÙŠ",
            "Ø£Ø­Ù…Ø¯ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø§Ù„ØªØ±ÙƒÙŠ",
            "Ø£Ø­Ù…Ø¯ Ø­Ø§Ù…Ø¯ Ø§Ù„Ø­Ø±Ø¨ÙŠ",
            "Ù†Ù…ÙŠØ§Ù† Ø¹Ù„ÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ",
            "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ ØµÙ„Ø§Ø­ Ø§Ù„Ø±Ø­ÙŠÙ„Ù‰",
            "Ù…Ø´Ø¹Ù„ Ø¨Ù† Ù‡Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù…Ø±ÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ",
            "Ø¹Ù„ÙŠ Ù…ØªØ¹Ø¨ Ø§Ù„Ø¹Ù„ÙˆÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ",
            "Ø³ÙŠÙ Ø¹Ø¨Ø¯Ø§Ù„Ù…Ù†Ø¹Ù… Ø§Ù„Ø¹Ø§Ø±Ø¶ÙŠ",
            "Ù…Ø­Ù…Ø¯ Ø¨Ù† Ø°Ø¹Ø§Ø± Ø§Ù„Ø¹ÙˆÙÙŠ",
            "ÙØ¤Ø§Ø¯ Ø¨Ù† Ù…Ø­Ù…Ø¯ Ø§Ù„Ø¹ØªÙŠØ¨ÙŠ",
            "Ø­Ù…Ø²Ø© ØµØ¯Ù‚Ø© Ø§Ø³Ù„Ø§Ù…",
            "Ø³Ù„Ù…Ø§Ù† ØµØ§Ù„Ø­ Ø§Ù„Ø­Ø§Ø±Ø«ÙŠ",
            "Ø¹Ø¨ÙŠØ¯ Ø¨Ù† Ø¯Ø®ÙŠÙ„ Ø§Ù„Ø¹ÙŠØ§Ø¶ÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ",
            "Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ù…ÙÙ„Ø­ Ø§Ù„Ø±ÙˆÙŠØ«ÙŠ",
            "ÙÙŠØµÙ„ Ø¹ÙˆØ§Ø¯ Ø£Ø¨Ùˆ Ø³Ù„Ù…ÙŠ",
            "Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ø¨Ù† Ù…Ø­Ù…Ø¯ Ø§Ù„Ù‚Ø±Ù†ÙŠ",
            "ÙƒØ§ØªØ¨ Ù…ÙÙ„Ø­ Ø§Ù„Ø±Ø´ÙŠØ¯Ù‰",
            "Ø­Ø¨ÙŠØ¨ Ø¹Ù„ÙŠ Ø§Ù„Ø¹Ù…Ø±ÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ",
            "Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø¹Ø§ÙŠØ¶ Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠ",
            "Ø³Ù„Ø·Ø§Ù† Ø¹ÙˆÙŠØ¶ Ø§Ù„Ø³Ø­ÙŠÙ…ÙŠ",
            "Ø¹Ø¨Ø¯Ø§Ù„Ù‡Ø§Ø¯ÙŠ Ù…Ø¹ÙŠØ¶ Ø§Ù„Ø´Ø§Ù…Ø§Ù†ÙŠ",
            "Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø¹Ø¨Ø¯Ø§Ù„Ø±Ø­Ù…Ù† ØºÙ„Ø§Ø¨ Ø§Ù„Ù…Ø®Ù„ÙÙŠ",
            "Ø³Ø¹Ø¯ Ø·Ø§Ù„Ø¹ Ø§Ù„Ø­Ø±Ø¨ÙŠ",
            "Ù…ÙˆØ³Ù‰ ØºØ§Ø²ÙŠ Ø³ÙØ± Ø§Ù„Ø­Ø±Ø¨ÙŠ",
            "Ù…ÙˆØ³Ù‰ Ù…Ø³Ø¹ÙˆØ¯ Ø§Ù„Ø­ÙŠØ³ÙˆÙ†ÙŠ",
            "Ù†ÙˆØ§Ù Ù…Ù†ØµÙˆØ± Ø§Ù„ØµØ¨Ø­ÙŠ",
            "Ø¨Ø¯Ø± Ø¹Ø¨Ø¯Ø§Ù„Ø¹Ø²ÙŠØ² Ø§Ù„Ø³Ø­ÙŠÙ…ÙŠ",
            "ÙÙ‡Ø¯ Ø¹ÙˆÙŠØ¶ Ø§Ù„Ø´Ø§Ù…Ø§Ù†ÙŠ Ø§Ù„Ø­Ø±Ø¨ÙŠ"
        ];

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
        function initializeSystem() {
            if (confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† (38 Ù…Ø¹Ù„Ù…) ÙˆØ¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±ØŸ')) {
                teachers = [];
                excelTeachers.forEach(name => {
                    teachers.push({
                        id: Date.now() + Math.random(),
                        name: name,
                        subject: "ØºÙŠØ± Ù…Ø­Ø¯Ø¯",
                        substituteCount: 0,
                        requiredSubstitutions: teacherSubstitutionRequirements[name] || 0,
                        dailySubstitutions: {} // ØªØªØ¨Ø¹ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ÙŠÙˆÙ…ÙŠ
                    });
                });
                renderTeachers();
                updateStats();
                saveAllData();
                showNotification(`ØªÙ… ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù… Ø¨Ù†Ø¬Ø§Ø­ Ù…Ø¹ ${teachers.length} Ù…Ø¹Ù„Ù… ğŸ‰`, 'success');
            }
        }

        // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function saveAllData() {
            localStorage.setItem('teachers', JSON.stringify(teachers));
            localStorage.setItem('schedule', JSON.stringify(schedule));
            localStorage.setItem('absences', JSON.stringify(absences));
            showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­ âœ“', 'success');
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function loadData() {
            const savedTeachers = localStorage.getItem('teachers');
            const savedSchedule = localStorage.getItem('schedule');
            const savedAbsences = localStorage.getItem('absences');

            if (savedTeachers) {
                teachers = JSON.parse(savedTeachers);
                teachers.forEach(t => {
                    t.requiredSubstitutions = teacherSubstitutionRequirements[t.name] || 0;
                    t.dailySubstitutions = t.dailySubstitutions || {};
                });
            }
            if (savedSchedule) schedule = JSON.parse(savedSchedule);
            if (savedAbsences) absences = JSON.parse(savedAbsences);

            renderAll();
        }

        // Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        function clearAllData() {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ âš ï¸')) {
                teachers = [];
                schedule = [];
                absences = [];
                localStorage.clear();
                renderAll();
                showNotification('ØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª', 'success');
            }
        }

        // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
        function showNotification(message, type) {
                        const notification = document.getElementById('notification');
            notification.className = `notification p-4 rounded-lg mb-4 ${type === 'success' ? 'bg-green-100 text-green-800 border border-green-300' : 'bg-red-100 text-red-800 border border-red-300'}`;
            notification.innerHTML = `
                <div class="flex items-center gap-2">
                    <span class="text-lg">${type === 'success' ? 'âœ…' : 'âš ï¸'}</span>
                    <span class="font-semibold">${message}</span>
                </div>
            `;
            notification.classList.remove('hidden');
            setTimeout(() => notification.classList.add('hidden'), 4000);
        }

        // Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª
        function switchTab(tab) {
            document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
            document.querySelectorAll('[id^="tab-"]').forEach(btn => btn.classList.remove('tab-active'));
            document.querySelectorAll('[id^="tab-"]').forEach(btn => btn.classList.add('tab-inactive'));

            document.getElementById(`content-${tab}`).classList.remove('hidden');
            document.getElementById(`tab-${tab}`).classList.add('tab-active');
            document.getElementById(`tab-${tab}`).classList.remove('tab-inactive');
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ†
        function renderTeachers() {
            const list = document.getElementById('teachers-list');
            if (!teachers.length) {
                list.innerHTML = '<p class="text-gray-500 text-center py-8">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ù„Ù…ÙŠÙ† Ù…Ø¶Ø§ÙÙŠÙ† Ø¨Ø¹Ø¯</p>';
                return;
            }

            list.innerHTML = teachers.map(teacher => `
                <div class="bg-gradient-to-r from-gray-50 to-white p-4 rounded-lg shadow border-l-4 border-indigo-500">
                    <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
                        <div class="flex-1">
                            <h3 class="text-lg font-bold text-gray-800">${teacher.name}</h3>
                            <p class="text-sm text-gray-600">${teacher.subject}</p>
                            <div class="mt-2 flex flex-wrap gap-2">
                                <span class="px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium">
                                    Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙƒØªÙ…Ù„: ${teacher.substituteCount} / ${teacher.requiredSubstitutions}
                                </span>
                                <span class="px-2 py-1 ${teacher.substituteCount >= teacher.requiredSubstitutions ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700'} rounded-full text-xs font-medium">
                                    ${teacher.substituteCount >= teacher.requiredSubstitutions ? 'âœ… Ø§ÙƒØªÙ…Ù„' : 'â³ Ù‚ÙŠØ¯ Ø§Ù„ØªÙ†ÙÙŠØ°'}
                                </span>
                            </div>
                        </div>
                        <div class="flex gap-2">
                            <button onclick="editTeacher('${teacher.id}')" class="text-blue-600 hover:text-blue-800 transition">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                                </svg>
                            </button>
                            <button onclick="deleteTeacher('${teacher.id}')" class="text-red-600 hover:text-red-800 transition">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„Ù…
        function addTeacher() {
            const name = prompt('Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…:');
            if (!name) return;
            const subject = prompt('Ø§Ù„Ù…Ø§Ø¯Ø©:') || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            const required = parseInt(prompt('Ø¹Ø¯Ø¯ Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:')) || 0;

            teachers.push({
                id: Date.now() + Math.random(),
                name,
                subject,
                substituteCount: 0,
                requiredSubstitutions: required,
                dailySubstitutions: {}
            });
            renderTeachers();
            updateStats();
            saveAllData();
            showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø¹Ù„Ù… Ø¨Ù†Ø¬Ø§Ø­ âœ“', 'success');
        }

        // ØªØ¹Ø¯ÙŠÙ„ Ù…Ø¹Ù„Ù…
        function editTeacher(id) {
            const teacher = teachers.find(t => t.id == id);
            if (!teacher) return;

            const newName = prompt('Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯:', teacher.name);
            if (!newName) return;
            const newSubject = prompt('Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:', teacher.subject) || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            const newRequired = parseInt(prompt('Ø¹Ø¯Ø¯ Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:', teacher.requiredSubstitutions)) || 0;

            teacher.name = newName;
            teacher.subject = newSubject;
            teacher.requiredSubstitutions = newRequired;
            renderTeachers();
            saveAllData();
            showNotification('ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¹Ù„Ù… Ø¨Ù†Ø¬Ø§Ø­ âœ“', 'success');
        }

        // Ø­Ø°Ù Ù…Ø¹Ù„Ù…
        function deleteTeacher(id) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¹Ù„Ù…ØŸ')) return;
            teachers = teachers.filter(t => t.id != id);
            renderTeachers();
            updateStats();
            saveAllData();
            showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø¹Ù„Ù… Ø¨Ù†Ø¬Ø§Ø­ âœ“', 'success');
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ø¬Ø¯ÙˆÙ„
        function renderSchedule() {
            const list = document.getElementById('schedule-list');
            if (!schedule.length) {
                list.innerHTML = '<p class="text-gray-500 text-center py-8">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø­ØµØµ Ù…Ø¶Ø§ÙØ© Ø¨Ø¹Ø¯</p>';
                return;
            }

            list.innerHTML = `
                <table class="w-full text-right text-sm">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="p-2">Ø§Ù„ÙŠÙˆÙ…</th>
                            <th class="p-2">Ø§Ù„Ø­ØµØ©</th>
                            <th class="p-2">Ø§Ù„Ù…Ø¹Ù„Ù…</th>
                            <th class="p-2">Ø§Ù„Ù…Ø§Ø¯Ø©</th>
                            <th class="p-2">Ø§Ù„ØµÙ</th>
                            <th class="p-2">Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${schedule.map(entry => `
                            <tr class="border-b hover:bg-gray-50">
                                <td class="p-2">${entry.day}</td>
                                <td class="p-2">${entry.period}</td>
                                <td class="p-2">${entry.teacher}</td>
                                <td class="p-2">${entry.subject}</td>
                                <td class="p-2">${entry.class}</td>
                                <td class="p-2 flex gap-2">
                                    <button onclick="editScheduleEntry('${entry.id}')" class="text-blue-600 hover:text-blue-800">ØªØ¹Ø¯ÙŠÙ„</button>
                                    <button onclick="deleteScheduleEntry('${entry.id}')" class="text-red-600 hover:text-red-800">Ø­Ø°Ù</button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
        }

        // Ø¥Ø¶Ø§ÙØ© Ø­ØµØ©
        function addScheduleEntry() {
            const day = prompt('Ø§Ù„ÙŠÙˆÙ…:');
            if (!day) return;
            const period = prompt('Ø±Ù‚Ù… Ø§Ù„Ø­ØµØ©:');
            if (!period) return;
            const teacher = prompt('Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù…:');
            if (!teacher) return;
            const subject = prompt('Ø§Ù„Ù…Ø§Ø¯Ø©:') || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            const cls = prompt('Ø§Ù„ØµÙ:') || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';

            schedule.push({
                id: Date.now() + Math.random(),
                day,
                period,
                teacher,
                subject,
                class: cls
            });
            renderSchedule();
            updateStats();
            saveAllData();
            showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­ØµØ© Ø¨Ù†Ø¬Ø§Ø­ âœ“', 'success');
        }

        // ØªØ¹Ø¯ÙŠÙ„ Ø­ØµØ©
        function editScheduleEntry(id) {
            const entry = schedule.find(s => s.id == id);
            if (!entry) return;

            const newDay = prompt('Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø¬Ø¯ÙŠØ¯:', entry.day);
            if (!newDay) return;
            const newPeriod = prompt('Ø±Ù‚Ù… Ø§Ù„Ø­ØµØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯:', entry.period);
            if (!newPeriod) return;
            const newTeacher = prompt('Ø§Ø³Ù… Ø§Ù„Ù…Ø¹Ù„Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯:', entry.teacher);
            if (!newTeacher) return;
            const newSubject = prompt('Ø§Ù„Ù…Ø§Ø¯Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©:', entry.subject) || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';
            const newClass = prompt('Ø§Ù„ØµÙ Ø§Ù„Ø¬Ø¯ÙŠØ¯:', entry.class) || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯';

            entry.day = newDay;
            entry.period = newPeriod;
            entry.teacher = newTeacher;
            entry.subject = newSubject;
            entry.class = newClass;
            renderSchedule();
            saveAllData();
            showNotification('ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø­ØµØ© Ø¨Ù†Ø¬Ø§Ø­ âœ“', 'success');
        }

        // Ø­Ø°Ù Ø­ØµØ©
        function deleteScheduleEntry(id) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø­ØµØ©ØŸ')) return;
            schedule = schedule.filter(s => s.id != id);
            renderSchedule();
            updateStats();
            saveAllData();
            showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø­ØµØ© Ø¨Ù†Ø¬Ø§Ø­ âœ“', 'success');
        }

        // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£ÙØ¶Ù„ Ù…Ø¹Ù„Ù… Ù„Ù„Ø§Ù†ØªØ¸Ø§Ø±
        function findBestSubstitute() {
            const day = document.getElementById('substitution-day').value;
            const period = document.getElementById('substitution-period').value;

            const available = teachers.filter(t => {
                // Ù„Ø§ ÙŠØ£Ø®Ø° Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù†ØªØ¸Ø§Ø± ÙÙŠ Ø§Ù„ÙŠÙˆÙ…
                if (t.dailySubstitutions[day]) return false;
                // Ù„Ø§ ÙŠÙƒÙˆÙ† Ù…Ø´ØºÙˆÙ„ ÙÙŠ Ù†ÙØ³ Ø§Ù„Ø­ØµØ©
                const busy = schedule.some(s => s.day === day && s.period === period && s.teacher === t.name);
                if (busy) return false;
                // Ù„Ù… ÙŠÙƒÙ…Ù„ Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                return t.substituteCount < t.requiredSubstitutions;
            });

            // ØªØ±ØªÙŠØ¨ Ø­Ø³Ø¨ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©: Ø§Ù„Ø£Ù‚Ù„ Ø§Ù†ØªØ¸Ø§Ø±Ù‹Ø§ Ø£ÙˆÙ„Ø§Ù‹
            available.sort((a, b) => a.substituteCount - b.substituteCount);

            const results = document.getElementById('substitution-results');
            if (!available.length) {
                results.innerHTML = '<p class="text-red-600 text-center py-4">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø¹Ù„Ù…ÙŠÙ† Ù…ØªØ§Ø­ÙŠÙ† Ù„Ù‡Ø°Ù‡ Ø§Ù„Ø­ØµØ©</p>';
                return;
            }

            results.innerHTML = available.map((t, i) => `
                <div class="p-3 rounded-lg ${i === 0 ? 'priority-1' : i === 1 ? 'priority-2' : 'priority-3'}">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="font-bold text-gray-800">${t.name}</p>
                            <p class="text-sm text-gray-600">Ø§Ù†ØªØ¸Ø§Ø± Ù…ÙƒØªÙ…Ù„: ${t.substituteCount} / ${t.requiredSubstitutions}</p>
                        </div>
                        <button onclick="assignSubstitute('${t.name}', '${day}', '${period}')" class="bg-indigo-600 text-white px-3 py-1 rounded hover:bg-indigo-700 transition text-sm">
                            ØªØ¹ÙŠÙŠÙ†
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
        function assignSubstitute(teacherName, day, period) {
            const teacher = teachers.find(t => t.name === teacherName);
            if (!teacher) return;

            teacher.substituteCount++;
            teacher.dailySubstitutions[day] = true;

            absences.push({
                id: Date.now() + Math.random(),
                teacher: teacherName,
                day,
                period,
                date: new Date().toLocaleDateString('ar-SA')
            });

            saveAllData();
            renderAll();
            showNotification(`ØªÙ… ØªØ¹ÙŠÙŠÙ† ${teacherName} Ù„Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø¨Ù†Ø¬Ø§Ø­ âœ“`, 'success');
            findBestSubstitute(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØªØ§Ø¦Ø¬
        }

        // Ø¹Ø±Ø¶ Ø³Ø¬Ù„ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±
        function renderAbsences() {
            const list = document.getElementById('absences-list');
            if (!absences.length) {
                list.innerHTML = '<p class="text-gray-500 text-center py-8">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø³Ø¬Ù„ Ø§Ù†ØªØ¸Ø§Ø± Ø¨Ø¹Ø¯</p>';
                return;
            }

            list.innerHTML = absences.map(abs => `
                <div class="bg-white p-4 rounded-lg shadow border-l-4 border-orange-400">
                    <div class="flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
                        <div>
                            <p class="font-bold text-gray-800">${abs.teacher}</p>
                            <p class="text-sm text-gray-600">${abs.day} - Ø§Ù„Ø­ØµØ© ${abs.period} - ${abs.date}</p>
                        </div>
                        <button onclick="deleteAbsence('${abs.id}')" class="text-red-600 hover:text-red-800 transition">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Ø­Ø°Ù Ø³Ø¬Ù„ Ø§Ù†ØªØ¸Ø§Ø±
        function deleteAbsence(id) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø³Ø¬Ù„ØŸ')) return;
            const abs = absences.find(a => a.id == id);
            if (abs) {
                const teacher = teachers.find(t => t.name === abs.teacher);
                if (teacher) {
                    teacher.substituteCount--;
                    delete teacher.dailySubstitutions[abs.day];
                }
            }
            absences = absences.filter(a => a.id != id);
            renderAbsences();
            renderTeachers();
            saveAllData();
            showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø³Ø¬Ù„ Ø¨Ù†Ø¬Ø§Ø­ âœ“', 'success');
        }

        // ØªØµØ¯ÙŠØ± ØªÙ‚Ø±ÙŠØ±
        function exportAbsencesReport() {
            if (!absences.length) {
                showNotification('Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±', 'error');
                return;
            }

            let csv = 'Ø§Ù„Ù…Ø¹Ù„Ù…,Ø§Ù„ÙŠÙˆÙ…,Ø§Ù„Ø­ØµØ©,Ø§Ù„ØªØ§Ø±ÙŠØ®\n';
            absences.forEach(abs => {
                csv += `${abs.teacher},${abs.day},${abs.period},${abs.date}\n`;
            });

            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±_${new Date().toLocaleDateString('ar-SA')}.csv`;
            link.click();
            showNotification('ØªÙ… ØªØµØ¯ÙŠØ± Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø¨Ù†Ø¬Ø§Ø­ âœ“', 'success');
        }

        // ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª
        function generatePriorityReport() {
            const remaining = teachers.filter(t => t.substituteCount < t.requiredSubstitutions)
                .sort((a, b) => (a.requiredSubstitutions - a.substituteCount) - (b.requiredSubstitutions - b.substituteCount));

            if (!remaining.length) {
                showNotification('Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø¹Ù„Ù…ÙŠÙ† Ø£ÙƒÙ…Ù„ÙˆØ§ Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© âœ…', 'success');
                return;
            }

            let report = 'ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ§Øª:\n\n';
            remaining.forEach((t, i) => {
                report += `${i + 1}. ${t.name} - Ù…ØªØ¨Ù‚ÙŠ: ${t.requiredSubstitutions - t.substituteCount} Ø­ØµØµ\n`;
            });

            alert(report);
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function updateStats() {
            document.getElementById('stat-teachers').textContent = teachers.length;
            document.getElementById('stat-schedule').textContent = schedule.length;
            document.getElementById('stat-absences').textContent = absences.length;
        }

        // Ø¹Ø±Ø¶ Ø§Ù„ÙƒÙ„
        function renderAll() {
            renderTeachers();
            renderSchedule();
            renderAbsences();
            updateStats();
        }

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        window.onload = () => {
            loadData();
            renderAll();
        };
    </script>
</body>
</html>
