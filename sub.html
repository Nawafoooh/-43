<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุธุงู ุฅุฏุงุฑุฉ ุญุตุต ุงูุงูุชุธุงุฑ ุงููุฏุฑุณูุฉ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .tab-active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .tab-inactive {
            color: #4a5568;
        }
        .tab-inactive:hover {
            background-color: #f7fafc;
        }
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .notification {
            animation: slideIn 0.3s ease-out;
        }
        .priority-1 { background-color: #dcfce7; border-right: 4px solid #16a34a; }
        .priority-2 { background-color: #fef9c3; border-right: 4px solid #ca8a04; }
        .priority-3 { background-color: #fee2e2; border-right: 4px solid #dc2626; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen p-4">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <div class="flex items-center gap-3">
                    <svg class="w-10 h-10 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    <div>
                        <h1 class="text-3xl font-bold text-gray-800">ูุธุงู ุฅุฏุงุฑุฉ ุญุตุต ุงูุงูุชุธุงุฑ</h1>
                        <p class="text-gray-600">ูุธุงู ุฐูู ูุงุฎุชูุงุฑ ูุนููู ุงูุงูุชุธุงุฑ ุญุณุจ ุงูุฃููููุงุช</p>
                    </div>
                </div>
                <div class="flex gap-2 flex-wrap">
                    <button onclick="saveAllData()" class="flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                        </svg>
                        ุญูุธ ุงูุจูุงูุงุช
                    </button>
                    <button onclick="clearAllData()" class="flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                        ูุณุญ ุงููู
                    </button>
                    <button onclick="initializeSystem()" class="flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                        </svg>
                        ุชููุฆุฉ ุงููุธุงู
                    </button>
                </div>
            </div>
        </div>

        <!-- Notification -->
        <div id="notification" class="hidden mb-4 p-4 rounded-lg notification"></div>

        <!-- Tabs -->
        <div class="bg-white rounded-lg shadow-lg mb-6">
            <div class="flex flex-col md:flex-row border-b">
                <button onclick="switchTab('teachers')" id="tab-teachers" class="flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-active">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                    ุงููุนูููู
                </button>
                <button onclick="switchTab('substitution')" id="tab-substitution" class="flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-inactive">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
                    </svg>
                    ูุธุงู ุงูุงูุชุธุงุฑ ุงูุฐูู
                </button>
                <button onclick="switchTab('absences')" id="tab-absences" class="flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-inactive">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    ุญุตุต ุงูุงูุชุธุงุฑ
                </button>
            </div>
        </div>

        <!-- Content -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <!-- Teachers Tab -->
            <div id="content-teachers" class="tab-content">
                <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800">ูุงุฆูุฉ ุงููุนูููู ูุฃููููุงุช ุงูุงูุชุธุงุฑ</h2>
                    <div class="flex gap-2">
                        <button onclick="addTeacher()" class="flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                            </svg>
                            ุฅุถุงูุฉ ูุนูู
                        </button>
                        <button onclick="generatePriorityReport()" class="flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            ุชูุฑูุฑ ุงูุฃููููุงุช
                        </button>
                    </div>
                </div>
                <div id="teachers-list" class="grid gap-4">
                    <div class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                        <p class="text-lg">ูุง ุชูุฌุฏ ูุนูููู ุจุนุฏ. ุงุจุฏุฃ ุจุชููุฆุฉ ุงููุธุงู!</p>
                        <button onclick="initializeSystem()" class="mt-4 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
                            ุชููุฆุฉ ุงููุธุงู
                        </button>
                    </div>
                </div>
            </div>

            <!-- Substitution Tab -->
            <div id="content-substitution" class="tab-content hidden">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- ูุธุงู ุงูุงูุชุธุงุฑ ุงูุฐูู -->
                    <div class="bg-gradient-to-br from-green-50 to-blue-50 p-6 rounded-lg border border-green-200">
                        <h2 class="text-2xl font-bold text-gray-800 mb-4">ูุธุงู ุงูุงูุชุธุงุฑ ุงูุฐูู</h2>
                        
                        <div class="space-y-4">
                            <div class="bg-white p-4 rounded-lg shadow">
                                <h3 class="font-bold text-lg text-green-700 mb-2">ุชุนููู ุงูุชุธุงุฑ ุชููุงุฆู</h3>
                                <p class="text-gray-600 mb-3">ุณูููู ุงููุธุงู ุจุงุฎุชูุงุฑ ุฃูุถู ูุนูู ููุงูุชุธุงุฑ ุญุณุจ ุงูุดุฑูุท ุงููุญุฏุฏุฉ</p>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">ุงูููู</label>
                                        <select id="substitution-day" class="w-full p-2 border border-gray-300 rounded-lg">
                                            <option value="ุงูุฃุญุฏ">ุงูุฃุญุฏ</option>
                                            <option value="ุงูุงุซููู">ุงูุงุซููู</option>
                                            <option value="ุงูุซูุงุซุงุก">ุงูุซูุงุซุงุก</option>
                                            <option value="ุงูุฃุฑุจุนุงุก">ุงูุฃุฑุจุนุงุก</option>
                                            <option value="ุงูุฎููุณ">ุงูุฎููุณ</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-1">ุงูุญุตุฉ</label>
                                        <select id="substitution-period" class="w-full p-2 border border-gray-300 rounded-lg">
                                            <option value="1">ุงูุญุตุฉ 1</option>
                                            <option value="2">ุงูุญุตุฉ 2</option>
                                            <option value="3">ุงูุญุตุฉ 3</option>
                                            <option value="4">ุงูุญุตุฉ 4</option>
                                            <option value="5">ุงูุญุตุฉ 5</option>
                                            <option value="6">ุงูุญุตุฉ 6</option>
                                            <option value="7">ุงูุญุตุฉ 7</option>
                                        </select>
                                    </div>
                                </div>
                                <button onclick="findBestSubstitute()" class="w-full mt-4 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition font-semibold">
                                    ุงูุจุญุซ ุนู ุฃูุถู ูุนูู ููุงูุชุธุงุฑ
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- ูุชุงุฆุฌ ุงูุจุญุซ -->
                    <div>
                        <div class="bg-white p-6 rounded-lg shadow border">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">ูุชุงุฆุฌ ุงูุจุญุซ ุนู ุงูุจุฏูู</h3>
                            <div id="substitution-results" class="space-y-3">
                                <p class="text-gray-500 text-center py-8">ุณูุธูุฑ ููุง ุฃูุถู ุงููุนูููู ููุงูุชุธุงุฑ ุญุณุจ ุงูุดุฑูุท</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ุดุฑูุท ุงููุธุงู -->
                <div class="mt-6 bg-yellow-50 p-6 rounded-lg border border-yellow-200">
                    <h3 class="text-lg font-bold text-yellow-800 mb-3">ุดุฑูุท ูุธุงู ุงูุงูุชุธุงุฑ ุงูุฐูู</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-yellow-700">
                        <div class="flex items-start gap-2">
                            <span class="bg-yellow-200 rounded-full p-1">โ</span>
                            <span>ูุง ูุฃุฎุฐ ุงููุนูู ุฃูุซุฑ ูู ุงูุชุธุงุฑ ูุงุญุฏ ูู ุงูููู</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="bg-yellow-200 rounded-full p-1">โ</span>
                            <span>ุงูุฃููููุฉ ููู ูู ูุฃุฎุฐ ุงูุชุธุงุฑ ูู ุงูุฃูุงู ุงูุณุงุจูุฉ</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="bg-yellow-200 rounded-full p-1">โ</span>
                            <span>ุงููุนูู ุงูุฐู ูุฏูู ุฃูุซุฑ ูู 5 ุญุตุต ูู ุงูููู ูุง ูุฏุฎู ุงูุงูุชุธุงุฑ</span>
                        </div>
                        <div class="flex items-start gap-2">
                            <span class="bg-yellow-200 rounded-full p-1">โ</span>
                            <span>ูุฑุงุนุงุฉ ุนุฏุฏ ุญุตุต ุงูุงูุชุธุงุฑ ุงููุทููุจุฉ ููู ูุนูู</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Absences Tab -->
            <div id="content-absences" class="tab-content hidden">
                <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800">ุฅุฏุงุฑุฉ ุญุตุต ุงูุงูุชุธุงุฑ</h2>
                    <button onclick="markAbsent()" class="flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition w-full md:w-auto justify-center">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        ุชุณุฌูู ุบูุงุจ ูุนูู
                    </button>
                </div>
                <div id="absences-list" class="space-y-4">
                    <div class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        <p class="text-lg">ูุง ุชูุฌุฏ ุณุฌูุงุช ุบูุงุจ ุญุชู ุงูุขู</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-6">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุนุฏุฏ ุงููุนูููู</p>
                        <p id="stat-teachers" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุงููุธุงู ุงูุฐูู</p>
                        <p class="text-3xl font-bold text-gray-800">โ</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุญุตุต ุงูุงูุชุธุงุฑ</p>
                        <p id="stat-absences" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุฌุงูุฒ ููุนูู</p>
                        <p class="text-3xl font-bold text-gray-800">๐</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let teachers = [];
        let schedule = [];
        let absences = [];

        // ุจูุงูุงุช ุญุตุต ุงูุงูุชุธุงุฑ ุงููุทููุจุฉ ููู ูุนูู - ูุตุญุญุฉ
        const teacherSubstitutionRequirements = {
            "ุนุจุฏุงููุฌูุฏ ุงูุฑุดูุฏู": 1,
            "ุนุจุฏุงููุงุฏู ุงูุดุงูุงูู": 3,
            "ุนุจูุฏ ุจู ุฏุฎูู ุงูุนูุงุถู ุงูุญุฑุจู": 1,
            "ุนูู ูุชุนุจ ุงูุนููู ุงูุญุฑุจู": 0,
            "ููุฏ ุนููุถ ุงูุดุงูุงูู ุงูุญุฑุจู": 7,
            "ูุคุงุฏ ุจู ูุญูุฏ ุงูุนุชูุจู": 0,
            "ููุตู ุนุทุงููู ุงูุตุงุนุฏู": 10,
            "ูุญูุฏ ุจู ุฐุนุงุฑ ุงูุนููู": 2,
            "ูุญูุฏ ุจู ุนูุงุฑู ุงูุฒูุฑุงูู": 4,
            "ูุญูุฏ ุนูุงุฏ ุงูุนููู": 9,
            "ูุดุนู ุจู ูููู ุงูุนูุฑู ุงูุญุฑุจู": 0,
            "ููุตู ุนูุงุฏ ุฃุจู ุณููู": 0,
            "ููุณู ุบุงุฒู ุณูุฑ ุงูุญุฑุจู": 3,
            "ูููู ูุฑุฒูู ุงูุณุญููู": 9,
            "ูุงูุน ุดุนูู ุงููุทูุฑู": 3,
            "ูููุงู ุนูู ุงูุญุฑุจู": 7,
            "ุงุจุฑุงููู ุนุงูุถ ุงูุฌุงุจุฑู": 10,
            "ุงุจุฑุงููู ุนูุงุฏ ุงูุนููู": 5,
            "ุฃุญูุฏ ุฅุจุฑุงููู ุงูุชุฑูู": 8,
            "ุฃุญูุฏ ุญุงูุฏ ุงูุญุฑุจู": 0,
            "ุงุณุงูู ูููุฑ ุงูุนููู": 3,
            "ุจุฏุฑ ุนุจุฏุงูุนุฒูุฒ ุงูุณุญููู": 11,
            "ุญุจูุจ ุนูู ุงูุนูุฑู ุงูุญุฑุจู": 7,
            "ุญูุฒุฉ ุตุฏูุฉ ุงุณูุงู": 0,
            "ุณุงูุฑ ููุตู ุงูุนุถููู ุงููุทูุฑู": 0,
            "ุณุนุฏ ุทุงูุน ุงูุญุฑุจู": 10,
            "ุณูุทุงู ุนููุถ ุงูุณุญููู": 8,
            "ุณููุงู ุตุงูุญ ุงูุญุงุฑุซู": 11,
            "ุณูู ุนุจุฏุงูููุนู ุงูุนุงุฑุถู": 3,
            "ุนุจุฏุงูุนุฒูุฒ ุบูุงุจ ุงููุฎููู": 0,
            "ุนุจุฏุงูุนุฒูุฒ ูููุญ ุงูุฑููุซู": 9,
            "ุนุจุฏุงููู ุจู ูุญูุฏ ุงููุฑูู": 3,
            "ุนุจุฏุงููู ุจู ูุทุฑ ุงูุนูุฑู": 8,
            "ุนุจุฏุงููู ุญููุฏ ุงูุญุฑุจู": 0,
            "ุนุจุฏุงููู ุตูุงุญ ุงูุฑุญููู": 0,
            "ูุงุชุจ ูููุญ ุงูุฑุดูุฏู": 3,
            "ููุงู ููุตูุฑ ุงูุตุจุญู": 3,
            "ููุณู ูุณุนูุฏ ุงูุญูุณููู": 3
        };

        // ูุงุฆูุฉ ุงููุนูููู ุงูุฃุณุงุณูุฉ - ูุตุญุญุฉ (ุจุฏูู ุชูุฑุงุฑ)
        const excelTeachers = [
            "ุนุจุฏุงููู ุจู ูุทุฑ ุงูุนูุฑู",
            "ูุญูุฏ ุจู ุนูุงุฑู ุงูุฒูุฑุงูู", 
            "ูููู ูุฑุฒูู ุงูุณุญููู",
            "ููุงุฒ ุฒุงูุฏ ุงูููููุฒู ุงูุฑุดูุฏู",
            "ููุตู ุนุทุงููู ุงูุตุงุนุฏู",
            "ุงุจุฑุงููู ุนูุงุฏ ุงูุนููู",
            "ุนุจุฏุงููู ุญููุฏ ุงูุญุฑุจู",
            "ุณุงูุฑ ููุตู ุงูุนุถููู ุงููุทูุฑู",
            "ูุงูุน ุดุนูู ุงููุทูุฑู",
            "ุงุณุงูู ูููุฑ ุงูุนููู",
            "ูุญูุฏ ุนูุงุฏ ุงูุนููู",
            "ุฃุญูุฏ ุฅุจุฑุงููู ุงูุชุฑูู",
            "ุฃุญูุฏ ุญุงูุฏ ุงูุญุฑุจู",
            "ูููุงู ุนูู ุงูุญุฑุจู",
            "ุนุจุฏุงููู ุตูุงุญ ุงูุฑุญููู",
            "ูุดุนู ุจู ูููู ุงูุนูุฑู ุงูุญุฑุจู",
            "ุนูู ูุชุนุจ ุงูุนููู ุงูุญุฑุจู",
            "ุณูู ุนุจุฏุงูููุนู ุงูุนุงุฑุถู",
            "ูุญูุฏ ุจู ุฐุนุงุฑ ุงูุนููู",
            "ูุคุงุฏ ุจู ูุญูุฏ ุงูุนุชูุจู",
            "ุญูุฒุฉ ุตุฏูุฉ ุงุณูุงู",
            "ุณููุงู ุตุงูุญ ุงูุญุงุฑุซู",
            "ุนุจูุฏ ุจู ุฏุฎูู ุงูุนูุงุถู ุงูุญุฑุจู",
            "ุนุจุฏุงูุนุฒูุฒ ูููุญ ุงูุฑููุซู",
            "ููุตู ุนูุงุฏ ุฃุจู ุณููู",
            "ุนุจุฏุงููู ุจู ูุญูุฏ ุงููุฑูู",
            "ูุงุชุจ ูููุญ ุงูุฑุดูุฏ-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        <p class="text-lg">ูุง ุชูุฌุฏ ุณุฌูุงุช ุบูุงุจ ุญุชู ุงูุขู</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-6">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุนุฏุฏ ุงููุนูููู</p>
                        <p id="stat-teachers" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุงููุธุงู ุงูุฐูู</p>
                        <p class="text-3xl font-bold text-gray-800">โ</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุญุตุต ุงูุงูุชุธุงุฑ</p>
                        <p id="stat-absences" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุฌุงูุฒ ููุนูู</p>
                        <p class="text-3xl font-bold text-gray-800">๐</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let teachers = [];
        let schedule = [];
        let absences = [];

        // ุจูุงูุงุช ุญุตุต ุงูุงูุชุธุงุฑ ุงููุทููุจุฉ ููู ูุนูู - ูุตุญุญุฉ
        const teacherSubstitutionRequirements = {
            "ุนุจุฏุงููุฌูุฏ ุงูุฑุดูุฏู": 1,
            "ุนุจุฏุงููุงุฏู ุงูุดุงูุงูู": 3,
            "ุนุจูุฏ ุจู ุฏุฎูู ุงูุนูุงุถู ุงูุญุฑุจู": 1,
            "ุนูู ูุชุนุจ ุงูุนููู ุงูุญุฑุจู": 0,
            "ููุฏ ุนููุถ ุงูุดุงูุงูู ุงูุญุฑุจู": 7,
            "ูุคุงุฏ ุจู ูุญูุฏ ุงูุนุชูุจู": 0,
            "ููุตู ุนุทุงููู ุงูุตุงุนุฏู": 10,
            "ูุญูุฏ ุจู ุฐุนุงุฑ ุงูุนููู": 2,
            "ูุญูุฏ ุจู ุนูุงุฑู ุงูุฒูุฑุงูู": 4,
            "ูุญูุฏ ุนูุงุฏ ุงูุนููู": 9,
            "ูุดุนู ุจู ูููู ุงูุนูุฑู ุงูุญุฑุจู": 0,
            "ููุตู ุนูุงุฏ ุฃุจู ุณููู": 0,
            "ููุณู ุบุงุฒู ุณูุฑ ุงูุญุฑุจู": 3,
            "ูููู ูุฑุฒูู ุงูุณุญููู": 9,
            "ูุงูุน ุดุนูู ุงููุทูุฑู": 3,
            "ูููุงู ุนูู ุงูุญุฑุจู": 7,
            "ุงุจุฑุงููู ุนุงูุถ ุงูุฌุงุจุฑู": 10,
            "ุงุจุฑุงููู ุนูุงุฏ ุงูุนููู": 5,
            "ุฃุญูุฏ ุฅุจุฑุงููู ุงูุชุฑูู": 8,
            "ุฃุญูุฏ ุญุงูุฏ ุงูุญุฑุจู": 0,
            "ุงุณุงูู ูููุฑ ุงูุนููู": 3,
            "ุจุฏุฑ ุนุจุฏุงูุนุฒูุฒ ุงูุณุญููู": 11,
            "ุญุจูุจ ุนูู ุงูุนูุฑู ุงูุญุฑุจู": 7,
            "ุญูุฒุฉ ุตุฏูุฉ ุงุณูุงู": 0,
            "ุณุงูุฑ ููุตู ุงูุนุถููู ุงููุทูุฑู": 0,
            "ุณุนุฏ ุทุงูุน ุงูุญุฑุจู": 10,
            "ุณูุทุงู ุนููุถ ุงูุณุญููู": 8,
            "ุณููุงู ุตุงูุญ ุงูุญุงุฑุซู": 11,
            "ุณูู ุนุจุฏุงูููุนู ุงูุนุงุฑุถู": 3,
            "ุนุจุฏุงูุนุฒูุฒ ุบูุงุจ ุงููุฎููู": 0,
            "ุนุจุฏุงูุนุฒูุฒ ูููุญ ุงูุฑููุซู": 9,
            "ุนุจุฏุงููู ุจู ูุญูุฏ ุงููุฑูู": 3,
            "ุนุจุฏุงููู ุจู ูุทุฑ ุงูุนูุฑู": 8,
            "ุนุจุฏุงููู ุญููุฏ ุงูุญุฑุจู": 0,
            "ุนุจุฏุงููู ุตูุงุญ ุงูุฑุญููู": 0,
            "ูุงุชุจ ูููุญ ุงูุฑุดูุฏู": 3,
            "ููุงู ููุตูุฑ ุงูุตุจุญู": 3,
            "ููุณู ูุณุนูุฏ ุงูุญูุณููู": 3
        };

        // ูุงุฆูุฉ ุงููุนูููู ุงูุฃุณุงุณูุฉ - ูุตุญุญุฉ (ุจุฏูู ุชูุฑุงุฑ)
        const excelTeachers = [
            "ุนุจุฏุงููู ุจู ูุทุฑ ุงูุนูุฑู",
            "ูุญูุฏ ุจู ุนูุงุฑู ุงูุฒูุฑุงูู", 
            "ูููู ูุฑุฒูู ุงูุณุญููู",
            "ููุงุฒ ุฒุงูุฏ ุงูููููุฒู ุงูุฑุดูุฏู",
            "ููุตู ุนุทุงููู ุงูุตุงุนุฏู",
            "ุงุจุฑุงููู ุนูุงุฏ ุงูุนููู",
            "ุนุจุฏุงููู ุญููุฏ ุงูุญุฑุจู",
            "ุณุงูุฑ ููุตู ุงูุนุถููู ุงููุทูุฑู",
            "ูุงูุน ุดุนูู ุงููุทูุฑู",
            "ุงุณุงูู ูููุฑ ุงูุนููู",
            "ูุญูุฏ ุนูุงุฏ ุงูุนููู",
            "ุฃุญูุฏ ุฅุจุฑุงููู ุงูุชุฑูู",
            "ุฃุญูุฏ ุญุงูุฏ ุงูุญุฑุจู",
            "ูููุงู ุนูู ุงูุญุฑุจู",
            "ุนุจุฏุงููู ุตูุงุญ ุงูุฑุญููู",
            "ูุดุนู ุจู ูููู ุงูุนูุฑู ุงูุญุฑุจู",
            "ุนูู ูุชุนุจ ุงูุนููู ุงูุญุฑุจู",
            "ุณูู ุนุจุฏุงูููุนู ุงูุนุงุฑุถู",
            "ูุญูุฏ ุจู ุฐุนุงุฑ ุงูุนููู",
            "ูุคุงุฏ ุจู ูุญูุฏ ุงูุนุชูุจู",
            "ุญูุฒุฉ ุตุฏูุฉ ุงุณูุงู",
            "ุณููุงู ุตุงูุญ ุงูุญุงุฑุซู",
            "ุนุจูุฏ ุจู ุฏุฎูู ุงูุนูุงุถู ุงูุญุฑุจู",
            "ุนุจุฏุงูุนุฒูุฒ ูููุญ ุงูุฑููุซู",
            "ููุตู ุนูุงุฏ ุฃุจู ุณููู",
            "ุนุจุฏุงููู ุจู ูุญูุฏ ุงููุฑูู",
            "ูุงุชุจ ูููุญ ุงูุฑุดูุฏู",
            "ุญุจูุจ ุนูู ุงูุนูุฑู ุงูุญุฑุจู",
            "ุงุจุฑุงููู ุนุงูุถ ุงูุฌุงุจุฑู",
            "ุณูุทุงู ุนููุถ ุงูุณุญููู",
            "ุนุจุฏุงููุงุฏู ูุนูุถ ุงูุดุงูุงูู",
            "ุนุจุฏุงูุนุฒูุฒ ุบูุงุจ ุงููุฎููู",
            "ุณุนุฏ ุทุงูุน ุงูุญุฑุจู",
            "ููุณู ุบุงุฒู ุณูุฑ ุงูุญุฑุจู",
            "ููุณู ูุณุนูุฏ ุงูุญูุณููู",
            "ููุงู ููุตูุฑ ุงูุตุจุญู",
            "ุจุฏุฑ ุนุจุฏุงูุนุฒูุฒ ุงูุณุญููู",
            "ููุฏ ุนููุถ ุงูุดุงูุงูู ุงูุญุฑุจู"
        ];

        // ุชููุฆุฉ ุงููุธุงู
        function initializeSystem() {
            if (confirm('ูู ุชุฑูุฏ ุชููุฆุฉ ุงููุธุงู ุจุฌููุน ุงููุนูููู ูุจูุงูุงุช ุงูุงูุชุธุงุฑุ')) {
                teachers = [];
                
                // ุฅุถุงูุฉ ุฌููุน ุงููุนูููู
                excelTeachers.forEach(name => {
                    const substitutionReq = teacherSubstitutionRequirements[name] || 0;
                    teachers.push({
                        id: Date.now() + Math.random(),
                        name: name,
                        subject: "ุบูุฑ ูุญุฏุฏ",
                        substituteCount: 0,
                        requiredSubstitutions: substitutionReq
                    });
                });
                
                renderTeachers();
                updateStats();
                saveAllData(); // โ ุญูุธ ุชููุงุฆู ุจุนุฏ ุงูุชููุฆุฉ
                showNotification('ุชู ุชููุฆุฉ ุงููุธุงู ุจูุฌุงุญ ูุน ' + teachers.length + ' ูุนูู', 'success');
            }
        }

        // ุญูุธ ุฌููุน ุงูุจูุงูุงุช
        function saveAllData() {
            localStorage.setItem('teachers', JSON.stringify(teachers));
            localStorage.setItem('absences', JSON.stringify(absences));
            showNotification('ุชู ุญูุธ ุงูุจูุงูุงุช ุจูุฌุงุญ', 'success');
        }

        // ุชุญููู ุงูุจูุงูุงุช ูู localStorage
        function loadData() {
            const savedTeachers = localStorage.getItem('teachers');
            const savedAbsences = localStorage.getItem('absences');

            if (savedTeachers) {
                teachers = JSON.parse(savedTeachers);
                // ุฏูุฌ ูุชุทูุจุงุช ุงูุงูุชุธุงุฑ ูู ุงููุตุฏุฑ ุงูุตุญูุญ
                teachers.forEach(t => {
                    t.requiredSubstitutions = teacherSubstitutionRequirements[t.name] || 0;
                });
            }
            if (savedAbsences) absences = JSON.parse(savedAbsences);
            
            renderAll();
        }

        // ูุณุญ ุฌููุน ุงูุจูุงูุงุช
        function clearAllData() {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ุฌููุน ุงูุจูุงูุงุชุ ูุง ูููู ุงูุชุฑุงุฌุน ุนู ูุฐุง ุงูุฅุฌุฑุงุก!')) {
                teachers = [];
                absences = [];
                localStorage.clear();
                renderAll();
                showNotification('ุชู ุญุฐู ุฌููุน ุงูุจูุงูุงุช', 'success');
            }
        }

        // ุฅุธูุงุฑ ุงูุฅุดุนุงุฑุงุช
        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.className = `mb-4 p-4 rounded-lg notification flex items-center gap-3 ${
                type === 'success' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
            }`;
            notification.innerHTML = `
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${
                        type === 'success' 
                            ? 'M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z'
                            : 'M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z'
                    }"></path>
                </svg>
                <span class="font-semibold">${message}</span>
            `;
            notification.classList.remove('hidden');
            setTimeout(() => notification.classList.add('hidden'), 3000);
        }

        // ุงูุชุจุฏูู ุจูู ุงูุชุจููุจุงุช
        function switchTab(tab) {
            const tabs = ['teachers', 'substitution', 'absences'];
            tabs.forEach(t => {
                const tabBtn = document.getElementById(`tab-${t}`);
                const content = document.getElementById(`content-${t}`);
                if (t === tab) {
                    tabBtn.className = 'flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-active';
                    content.classList.remove('hidden');
                } else {
                    tabBtn.className = 'flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-inactive';
                    content.classList.add('hidden');
                }
            });
        }

        // ุฅุถุงูุฉ ูุนูู ุฌุฏูุฏ
        function addTeacher() {
            const name = prompt('ุฃุฏุฎู ุงุณู ุงููุนูู:');
            const subject = prompt('ุฃุฏุฎู ุงูุชุฎุตุต:');
            if (name && subject) {
                const substitutionReq = teacherSubstitutionRequirements[name] || 0;
                teachers.push({
                    id: Date.now(),
                    name,
                    subject,
                    substituteCount: 0,
                    requiredSubstitutions: substitutionReq
                });
                renderTeachers();
                updateStats();
                showNotification('ุชู ุฅุถุงูุฉ ุงููุนูู ุจูุฌุงุญ', 'success');
            }
        }

        // ุญุฐู ูุนูู
        function deleteTeacher(id) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงููุนููุ')) {
                teachers = teachers.filter(t => t.id !== id);
                renderTeachers();
                updateStats();
                showNotification('ุชู ุญุฐู ุงููุนูู', 'success');
            }
        }

        // ุงูุจุญุซ ุนู ุฃูุถู ุจุฏูู ุญุณุจ ุงูุดุฑูุท
        function findBestSubstitute() {
            if (teachers.length === 0) {
                showNotification('ูุฑุฌู ุชููุฆุฉ ุงููุธุงู ุฃููุงู ุจุฅุถุงูุฉ ุงููุนูููู', 'error');
                return;
            }

            const day = document.getElementById('substitution-day').value;
            const period = document.getElementById('substitution-period').value;
            
            const absentTeacherName = prompt('ุฃุฏุฎู ุงุณู ุงููุนูู ุงูุบุงุฆุจ:');
            if (!absentTeacherName) return;

            const availableTeachers = getAvailableTeachers(day, period, absentTeacherName);
            const rankedTeachers = rankTeachersByPriority(availableTeachers, day);

            displaySubstitutionResults(rankedTeachers, day, period, absentTeacherName);
        }

        // ุงูุญุตูู ุนูู ุงููุนูููู ุงููุชุงุญูู
        function getAvailableTeachers(day, period, absentTeacher) {
            // ูู ุงููุธุงู ุงูุญุงููุ ููุชุฑุถ ุฃู ุฌููุน ุงููุนูููู ูุชุงุญูู
            // ูู ูุธุงู ุญููููุ ุณูุชุญูู ูู ุงูุฌุฏูู ุงููุฏุฑุณู
            return teachers.filter(teacher => {
                // ุงูุดุฑูุท ุงูุฃุณุงุณูุฉ
                const isAvailable = teacher.name !== absentTeacher;
                
                // ูุง ูููู ูุฏ ุฃุฎุฐ ุงูุชุธุงุฑ ูู ููุณ ุงูููู
                const hasSubstitutionToday = absences.some(a => 
                    a.day === day && a.substitute === teacher.name
                );

                return isAvailable && !hasSubstitutionToday;
            });
        }

        // ุชุฑุชูุจ ุงููุนูููู ุญุณุจ ุงูุฃููููุฉ
        function rankTeachersByPriority(availableTeachers, day) {
            return availableTeachers.map(teacher => {
                const requiredSubstitutions = teacher.requiredSubstitutions || 0;
                const currentSubstitutions = teacher.substituteCount || 0;
                const remainingSubstitutions = Math.max(0, requiredSubstitutions - currentSubstitutions);
                
                // ุญุณุงุจ ุนุฏุฏ ุงูุฃูุงู ุจุฏูู ุงูุชุธุงุฑ
                const daysWithoutSubstitution = calculateDaysWithoutSubstitution(teacher.name);
                
                // ุญุณุงุจ ุงูุฃููููุฉ
                let priorityScore = 0;
                
                // ุงูุฃููููุฉ ููู ูุฏูู ุญุตุต ุงูุชุธุงุฑ ูุทููุจุฉ ุฃูุซุฑ
                priorityScore += remainingSubstitutions * 10;
                
                // ุงูุฃููููุฉ ููู ูู ูุฃุฎุฐ ุงูุชุธุงุฑ ูู ุงูุฃูุงู ุงูุณุงุจูุฉ
                priorityScore += daysWithoutSubstitution * 5;

                return {
                    ...teacher,
                    priorityScore: priorityScore,
                    remainingSubstitutions: remainingSubstitutions,
                    daysWithoutSubstitution: daysWithoutSubstitution
                };
            }).sort((a, b) => b.priorityScore - a.priorityScore);
        }

        // ุญุณุงุจ ุนุฏุฏ ุงูุฃูุงู ุจุฏูู ุงูุชุธุงุฑ
        function calculateDaysWithoutSubstitution(teacherName) {
            const today = new Date();
            const substitutionDays = absences
                .filter(a => a.substitute === teacherName)
                .map(a => new Date(a.date));
            
            if (substitutionDays.length === 0) return 7; // ุฃุณุจูุน ูุงูู
            
            const lastSubstitution = new Date(Math.max(...substitutionDays));
            const daysDiff = Math.floor((today - lastSubstitution) / (1000 * 60 * 60 * 24));
            
            return Math.min(7, daysDiff);
        }

        // ุนุฑุถ ูุชุงุฆุฌ-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        <p class="text-lg">ูุง ุชูุฌุฏ ุณุฌูุงุช ุบูุงุจ ุญุชู ุงูุขู</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-6">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุนุฏุฏ ุงููุนูููู</p>
                        <p id="stat-teachers" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุงููุธุงู ุงูุฐูู</p>
                        <p class="text-3xl font-bold text-gray-800">โ</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุญุตุต ุงูุงูุชุธุงุฑ</p>
                        <p id="stat-absences" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุฌุงูุฒ ููุนูู</p>
                        <p class="text-3xl font-bold text-gray-800">๐</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let teachers = [];
        let schedule = [];
        let absences = [];

        // ุจูุงูุงุช ุญุตุต ุงูุงูุชุธุงุฑ ุงููุทููุจุฉ ููู ูุนูู - ูุตุญุญุฉ
        const teacherSubstitutionRequirements = {
            "ุนุจุฏุงููุฌูุฏ ุงูุฑุดูุฏู": 1,
            "ุนุจุฏุงููุงุฏู ุงูุดุงูุงูู": 3,
            "ุนุจูุฏ ุจู ุฏุฎูู ุงูุนูุงุถู ุงูุญุฑุจู": 1,
            "ุนูู ูุชุนุจ ุงูุนููู ุงูุญุฑุจู": 0,
            "ููุฏ ุนููุถ ุงูุดุงูุงูู ุงูุญุฑุจู": 7,
            "ูุคุงุฏ ุจู ูุญูุฏ ุงูุนุชูุจู": 0,
            "ููุตู ุนุทุงููู ุงูุตุงุนุฏู": 10,
            "ูุญูุฏ ุจู ุฐุนุงุฑ ุงูุนููู": 2,
            "ูุญูุฏ ุจู ุนูุงุฑู ุงูุฒูุฑุงูู": 4,
            "ูุญูุฏ ุนูุงุฏ ุงูุนููู": 9,
            "ูุดุนู ุจู ูููู ุงูุนูุฑู ุงูุญุฑุจู": 0,
            "ููุตู ุนูุงุฏ ุฃุจู ุณููู": 0,
            "ููุณู ุบุงุฒู ุณูุฑ ุงูุญุฑุจู": 3,
            "ูููู ูุฑุฒูู ุงูุณุญููู": 9,
            "ูุงูุน ุดุนูู ุงููุทูุฑู": 3,
            "ูููุงู ุนูู ุงูุญุฑุจู": 7,
            "ุงุจุฑุงููู ุนุงูุถ ุงูุฌุงุจุฑู": 10,
            "ุงุจุฑุงููู ุนูุงุฏ ุงูุนููู": 5,
            "ุฃุญูุฏ ุฅุจุฑุงููู ุงูุชุฑูู": 8,
            "ุฃุญูุฏ ุญุงูุฏ ุงูุญุฑุจู": 0,
            "ุงุณุงูู ูููุฑ ุงูุนููู": 3,
            "ุจุฏุฑ ุนุจุฏุงูุนุฒูุฒ ุงูุณุญููู": 11,
            "ุญุจูุจ ุนูู ุงูุนูุฑู ุงูุญุฑุจู": 7,
            "ุญูุฒุฉ ุตุฏูุฉ ุงุณูุงู": 0,
            "ุณุงูุฑ ููุตู ุงูุนุถููู ุงููุทูุฑู": 0,
            "ุณุนุฏ ุทุงูุน ุงูุญุฑุจู": 10,
            "ุณูุทุงู ุนููุถ ุงูุณุญููู": 8,
            "ุณููุงู ุตุงูุญ ุงูุญุงุฑุซู": 11,
            "ุณูู ุนุจุฏุงูููุนู ุงูุนุงุฑุถู": 3,
            "ุนุจุฏุงูุนุฒูุฒ ุบูุงุจ ุงููุฎููู": 0,
            "ุนุจุฏุงูุนุฒูุฒ ูููุญ ุงูุฑููุซู": 9,
            "ุนุจุฏุงููู ุจู ูุญูุฏ ุงููุฑูู": 3,
            "ุนุจุฏุงููู ุจู ูุทุฑ ุงูุนูุฑู": 8,
            "ุนุจุฏุงููู ุญููุฏ ุงูุญุฑุจู": 0,
            "ุนุจุฏุงููู ุตูุงุญ ุงูุฑุญููู": 0,
            "ูุงุชุจ ูููุญ ุงูุฑุดูุฏู": 3,
            "ููุงู ููุตูุฑ ุงูุตุจุญู": 3,
            "ููุณู ูุณุนูุฏ ุงูุญูุณููู": 3
        };

        // ูุงุฆูุฉ ุงููุนูููู ุงูุฃุณุงุณูุฉ - ูุตุญุญุฉ (ุจุฏูู ุชูุฑุงุฑ)
        const excelTeachers = [
            "ุนุจุฏุงููู ุจู ูุทุฑ ุงูุนูุฑู",
            "ูุญูุฏ ุจู ุนูุงุฑู ุงูุฒูุฑุงูู", 
            "ูููู ูุฑุฒูู ุงูุณุญููู",
            "ููุงุฒ ุฒุงูุฏ ุงูููููุฒู ุงูุฑุดูุฏู",
            "ููุตู ุนุทุงููู ุงูุตุงุนุฏู",
            "ุงุจุฑุงููู ุนูุงุฏ ุงูุนููู",
            "ุนุจุฏุงููู ุญููุฏ ุงูุญุฑุจู",
            "ุณุงูุฑ ููุตู ุงูุนุถููู ุงููุทูุฑู",
            "ูุงูุน ุดุนูู ุงููุทูุฑู",
            "ุงุณุงูู ูููุฑ ุงูุนููู",
            "ูุญูุฏ ุนูุงุฏ ุงูุนููู",
            "ุฃุญูุฏ ุฅุจุฑุงููู ุงูุชุฑูู",
            "ุฃุญูุฏ ุญุงูุฏ ุงูุญุฑุจู",
            "ูููุงู ุนูู ุงูุญุฑุจู",
            "ุนุจุฏุงููู ุตูุงุญ ุงูุฑุญููู",
            "ูุดุนู ุจู ูููู ุงูุนูุฑู ุงูุญุฑุจู",
            "ุนูู ูุชุนุจ ุงูุนููู ุงูุญุฑุจู",
            "ุณูู ุนุจุฏุงูููุนู ุงูุนุงุฑุถู",
            "ูุญูุฏ ุจู ุฐุนุงุฑ ุงูุนููู",
            "ูุคุงุฏ ุจู ูุญูุฏ ุงูุนุชูุจู",
            "ุญูุฒุฉ ุตุฏูุฉ ุงุณูุงู",
            "ุณููุงู ุตุงูุญ ุงูุญุงุฑุซู",
            "ุนุจูุฏ ุจู ุฏุฎูู ุงูุนูุงุถู ุงูุญุฑุจู",
            "ุนุจุฏุงูุนุฒูุฒ ูููุญ ุงูุฑููุซู",
            "ููุตู ุนูุงุฏ ุฃุจู ุณููู",
            "ุนุจุฏุงููู ุจู ูุญูุฏ ุงููุฑูู",
            "ูุงุชุจ ูููุญ ุงูุฑุดูุฏู",
            "ุญุจูุจ ุนูู ุงูุนูุฑู ุงูุญุฑุจู",
            "ุงุจุฑุงููู ุนุงูุถ ุงูุฌุงุจุฑู",
            "ุณูุทุงู ุนููุถ ุงูุณุญููู",
            "ุนุจุฏุงููุงุฏู ูุนูุถ ุงูุดุงูุงูู",
            "ุนุจุฏุงูุนุฒูุฒ ุบูุงุจ ุงููุฎููู",
            "ุณุนุฏ ุทุงูุน ุงูุญุฑุจู",
            "ููุณู ุบุงุฒู ุณูุฑ ุงูุญุฑุจู",
            "ููุณู ูุณุนูุฏ ุงูุญูุณููู",
            "ููุงู ููุตูุฑ ุงูุตุจุญู",
            "ุจุฏุฑ ุนุจุฏุงูุนุฒูุฒ ุงูุณุญููู",
            "ููุฏ ุนููุถ ุงูุดุงูุงูู ุงูุญุฑุจู"
        ];

        // ุชููุฆุฉ ุงููุธุงู
        function initializeSystem() {
            if (confirm('ูู ุชุฑูุฏ ุชููุฆุฉ ุงููุธุงู ุจุฌููุน ุงููุนูููู ูุจูุงูุงุช ุงูุงูุชุธุงุฑุ')) {
                teachers = [];
                
                // ุฅุถุงูุฉ ุฌููุน ุงููุนูููู
                excelTeachers.forEach(name => {
                    const substitutionReq = teacherSubstitutionRequirements[name] || 0;
                    teachers.push({
                        id: Date.now() + Math.random(),
                        name: name,
                        subject: "ุบูุฑ ูุญุฏุฏ",
                        substituteCount: 0,
                        requiredSubstitutions: substitutionReq
                    });
                });
                
                renderTeachers();
                updateStats();
                saveAllData(); // โ ุญูุธ ุชููุงุฆู ุจุนุฏ ุงูุชููุฆุฉ
                showNotification('ุชู ุชููุฆุฉ ุงููุธุงู ุจูุฌุงุญ ูุน ' + teachers.length + ' ูุนูู', 'success');
            }
        }

        // ุญูุธ ุฌููุน ุงูุจูุงูุงุช
        function saveAllData() {
            localStorage.setItem('teachers', JSON.stringify(teachers));
            localStorage.setItem('absences', JSON.stringify(absences));
            showNotification('ุชู ุญูุธ ุงูุจูุงูุงุช ุจูุฌุงุญ', 'success');
        }

        // ุชุญููู ุงูุจูุงูุงุช ูู localStorage
        function loadData() {
            const savedTeachers = localStorage.getItem('teachers');
            const savedAbsences = localStorage.getItem('absences');

            if (savedTeachers) {
                teachers = JSON.parse(savedTeachers);
                // โ ุฏูุฌ ูุชุทูุจุงุช ุงูุงูุชุธุงุฑ ูู ุงููุตุฏุฑ ุงูุตุญูุญ
                teachers.forEach(t => {
                    t.requiredSubstitutions = teacherSubstitutionRequirements[t.name] || 0;
                });
            }
            if (savedAbsences) absences = JSON.parse(savedAbsences);
            
            renderAll();
        }

        // ูุณุญ ุฌููุน ุงูุจูุงูุงุช
        function clearAllData() {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ุฌููุน ุงูุจูุงูุงุชุ ูุง ูููู ุงูุชุฑุงุฌุน ุนู ูุฐุง ุงูุฅุฌุฑุงุก!')) {
                teachers = [];
                absences = [];
                localStorage.clear();
                renderAll();
                showNotification('ุชู ุญุฐู ุฌููุน ุงูุจูุงูุงุช', 'success');
            }
        }

        // ุฅุธูุงุฑ ุงูุฅุดุนุงุฑุงุช
        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.className = `mb-4 p-4 rounded-lg notification flex items-center gap-3 ${
                type === 'success' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
            }`;
            notification.innerHTML = `
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${
                        type === 'success' 
                            ? 'M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z'
                            : 'M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z'
                    }"></path>
                </svg>
                <span class="font-semibold">${message}</span>
            `;
            notification.classList.remove('hidden');
            setTimeout(() => notification.classList.add('hidden'), 3000);
        }

        // ุงูุชุจุฏูู ุจูู ุงูุชุจููุจุงุช
        function switchTab(tab) {
            const tabs = ['teachers', 'substitution', 'absences'];
            tabs.forEach(t => {
                const tabBtn = document.getElementById(`tab-${t}`);
                const content = document.getElementById(`content-${t}`);
                if (t === tab) {
                    tabBtn.className = 'flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-active';
                    content.classList.remove('hidden');
                } else {
                    tabBtn.className = 'flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-inactive';
                    content.classList.add('hidden');
                }
            });
        }

        // ุฅุถุงูุฉ ูุนูู ุฌุฏูุฏ
        function addTeacher() {
            const name = prompt('ุฃุฏุฎู ุงุณู ุงููุนูู:');
            const subject = prompt('ุฃุฏุฎู ุงูุชุฎุตุต:');
            if (name && subject) {
                const substitutionReq = teacherSubstitutionRequirements[name] || 0;
                teachers.push({
                    id: Date.now(),
                    name,
                    subject,
                    substituteCount: 0,
                    requiredSubstitutions: substitutionReq
                });
                renderTeachers();
                updateStats();
                showNotification('ุชู ุฅุถุงูุฉ ุงููุนูู ุจูุฌุงุญ', 'success');
            }
        }

        // ุญุฐู ูุนูู
        function deleteTeacher(id) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงููุนููุ')) {
                teachers = teachers.filter(t => t.id !== id);
                renderTeachers();
                updateStats();
                showNotification('ุชู ุญุฐู ุงููุนูู', 'success');
            }
        }

        // ุงูุจุญุซ ุนู ุฃูุถู ุจุฏูู ุญุณุจ ุงูุดุฑูุท
        function findBestSubstitute() {
            if (teachers.length === 0) {
                showNotification('ูุฑุฌู ุชููุฆุฉ ุงููุธุงู ุฃููุงู ุจุฅุถุงูุฉ ุงููุนูููู', 'error');
                return;
            }

            const day = document.getElementById('substitution-day').value;
            const period = document.getElementById('substitution-period').value;
            
            const absentTeacherName = prompt('ุฃุฏุฎู ุงุณู ุงููุนูู ุงูุบุงุฆุจ:');
            if (!absentTeacherName) return;

            const availableTeachers = getAvailableTeachers(day, period, absentTeacherName);
            const rankedTeachers = rankTeachersByPriority(availableTeachers, day);

            displaySubstitutionResults(rankedTeachers, day, period, absentTeacherName);
        }

        // ุงูุญุตูู ุนูู ุงููุนูููู ุงููุชุงุญูู
        function getAvailableTeachers(day, period, absentTeacher) {
            // ูู ุงููุธุงู ุงูุญุงููุ ููุชุฑุถ ุฃู ุฌููุน ุงููุนูููู ูุชุงุญูู
            // ูู ูุธุงู ุญููููุ ุณูุชุญูู ูู ุงูุฌุฏูู ุงููุฏุฑุณู
            return teachers.filter(teacher => {
                // ุงูุดุฑูุท ุงูุฃุณุงุณูุฉ
                const isAvailable = teacher.name !== absentTeacher;
                
                // ูุง ูููู ูุฏ ุฃุฎุฐ ุงูุชุธุงุฑ ูู ููุณ ุงูููู
                const hasSubstitutionToday = absences.some(a => 
                    a.day === day && a.substitute === teacher.name
                );

                return isAvailable && !hasSubstitutionToday;
            });
        }

        // ุชุฑุชูุจ ุงููุนูููู ุญุณุจ ุงูุฃููููุฉ
        function rankTeachersByPriority(availableTeachers, day) {
            return availableTeachers.map(teacher => {
                const requiredSubstitutions = teacher.requiredSubstitutions || 0;
                const currentSubstitutions = teacher.substituteCount || 0;
                const remainingSubstitutions = Math.max(0, requiredSubstitutions - currentSubstitutions);
                
                // ุญุณุงุจ ุนุฏุฏ ุงูุฃูุงู ุจุฏูู ุงูุชุธุงุฑ
                const daysWithoutSubstitution = calculateDaysWithoutSubstitution(teacher.name);
                
                // ุญุณุงุจ ุงูุฃููููุฉ
                let priorityScore = 0;
                
                // ุงูุฃููููุฉ ููู ูุฏูู ุญุตุต ุงูุชุธุงุฑ ูุทููุจุฉ ุฃูุซุฑ
                priorityScore += remainingSubstitutions * 10;
                
                // ุงูุฃููููุฉ ููู ูู ูุฃุฎุฐ ุงูุชุธุงุฑ ูู ุงูุฃูุงู ุงูุณุงุจูุฉ
                priorityScore += daysWithoutSubstitution * 5;

                return {
                    ...teacher,
                    priorityScore: priorityScore,
                    remainingSubstitutions: remainingSubstitutions,
                    daysWithoutSubstitution: daysWithoutSubstitution
                };
            }).sort((a, b) => b.priorityScore - a.priorityScore);
        }

        // ุญุณุงุจ ุนุฏุฏ ุงูุฃูุงู ุจุฏูู ุงูุชุธุงุฑ
        function calculateDaysWithoutSubstitution(teacherName) {
            const today = new Date();
            const substitutionDays = absences
                .filter(a => a.substitute === teacherName)
                .map(a => new Date(a.date));
            
            if (substitutionDays.length === 0) return 7; // ุฃุณุจูุน ูุงูู
            
            const lastSubstitution = new Date(Math.max(...substitutionDays));
            const daysDiff = Math.floor((today - lastSubstitution) / (1000 * 60 * 60 * 24));
            
            return Math.min(7, daysDiff);
        }

        // ุนุฑุถ ูุชุงุฆ-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        <p class="text-lg">ูุง ุชูุฌุฏ ุณุฌูุงุช ุบูุงุจ ุญุชู ุงูุขู</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mt-6">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุนุฏุฏ ุงููุนูููู</p>
                        <p id="stat-teachers" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุงููุธุงู ุงูุฐูู</p>
                        <p class="text-3xl font-bold text-gray-800">โ</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุญุตุต ุงูุงูุชุธุงุฑ</p>
                        <p id="stat-absences" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">ุฌุงูุฒ ููุนูู</p>
                        <p class="text-3xl font-bold text-gray-800">๐</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let teachers = [];
        let schedule = [];
        let absences = [];

        // ุจูุงูุงุช ุญุตุต ุงูุงูุชุธุงุฑ ุงููุทููุจุฉ ููู ูุนูู - ูุตุญุญุฉ
        const teacherSubstitutionRequirements = {
            "ุนุจุฏุงููุฌูุฏ ุงูุฑุดูุฏู": 1,
            "ุนุจุฏุงููุงุฏู ุงูุดุงูุงูู": 3,
            "ุนุจูุฏ ุจู ุฏุฎูู ุงูุนูุงุถู ุงูุญุฑุจู": 1,
            "ุนูู ูุชุนุจ ุงูุนููู ุงูุญุฑุจู": 0,
            "ููุฏ ุนููุถ ุงูุดุงูุงูู ุงูุญุฑุจู": 7,
            "ูุคุงุฏ ุจู ูุญูุฏ ุงูุนุชูุจู": 0,
            "ููุตู ุนุทุงููู ุงูุตุงุนุฏู": 10,
            "ูุญูุฏ ุจู ุฐุนุงุฑ ุงูุนููู": 2,
            "ูุญูุฏ ุจู ุนูุงุฑู ุงูุฒูุฑุงูู": 4,
            "ูุญูุฏ ุนูุงุฏ ุงูุนููู": 9,
            "ูุดุนู ุจู ูููู ุงูุนูุฑู ุงูุญุฑุจู": 0,
            "ููุตู ุนูุงุฏ ุฃุจู ุณููู": 0,
            "ููุณู ุบุงุฒู ุณูุฑ ุงูุญุฑุจู": 3,
            "ูููู ูุฑุฒูู ุงูุณุญููู": 9,
            "ูุงูุน ุดุนูู ุงููุทูุฑู": 3,
            "ูููุงู ุนูู ุงูุญุฑุจู": 7,
            "ุงุจุฑุงููู ุนุงูุถ ุงูุฌุงุจุฑู": 10,
            "ุงุจุฑุงููู ุนูุงุฏ ุงูุนููู": 5,
            "ุฃุญูุฏ ุฅุจุฑุงููู ุงูุชุฑูู": 8,
            "ุฃุญูุฏ ุญุงูุฏ ุงูุญุฑุจู": 0,
            "ุงุณุงูู ูููุฑ ุงูุนููู": 3,
            "ุจุฏุฑ ุนุจุฏุงูุนุฒูุฒ ุงูุณุญููู": 11,
            "ุญุจูุจ ุนูู ุงูุนูุฑู ุงูุญุฑุจู": 7,
            "ุญูุฒุฉ ุตุฏูุฉ ุงุณูุงู": 0,
            "ุณุงูุฑ ููุตู ุงูุนุถููู ุงููุทูุฑู": 0,
            "ุณุนุฏ ุทุงูุน ุงูุญุฑุจู": 10,
            "ุณูุทุงู ุนููุถ ุงูุณุญููู": 8,
            "ุณููุงู ุตุงูุญ ุงูุญุงุฑุซู": 11,
            "ุณูู ุนุจุฏุงูููุนู ุงูุนุงุฑุถู": 3,
            "ุนุจุฏุงูุนุฒูุฒ ุบูุงุจ ุงููุฎููู": 0,
            "ุนุจุฏุงูุนุฒูุฒ ูููุญ ุงูุฑููุซู": 9,
            "ุนุจุฏุงููู ุจู ูุญูุฏ ุงููุฑูู": 3,
            "ุนุจุฏุงููู ุจู ูุทุฑ ุงูุนูุฑู": 8,
            "ุนุจุฏุงููู ุญููุฏ ุงูุญุฑุจู": 0,
            "ุนุจุฏุงููู ุตูุงุญ ุงูุฑุญููู": 0,
            "ูุงุชุจ ูููุญ ุงูุฑุดูุฏู": 3,
            "ููุงู ููุตูุฑ ุงูุตุจุญู": 3,
                        "ููุณู ูุณุนูุฏ ุงูุญูุณููู": 3
        };

        // ูุงุฆูุฉ ุงููุนูููู ุงูุฃุณุงุณูุฉ - ูุตุญุญุฉ (ุจุฏูู ุชูุฑุงุฑ)
        const excelTeachers = [
            "ุนุจุฏุงููู ุจู ูุทุฑ ุงูุนูุฑู",
            "ูุญูุฏ ุจู ุนูุงุฑู ุงูุฒูุฑุงูู", 
            "ูููู ูุฑุฒูู ุงูุณุญููู",
            "ููุงุฒ ุฒุงูุฏ ุงูููููุฒู ุงูุฑุดูุฏู",
            "ููุตู ุนุทุงููู ุงูุตุงุนุฏู",
            "ุงุจุฑุงููู ุนูุงุฏ ุงูุนููู",
            "ุนุจุฏุงููู ุญููุฏ ุงูุญุฑุจู",
            "ุณุงูุฑ ููุตู ุงูุนุถููู ุงููุทูุฑู",
            "ูุงูุน ุดุนูู ุงููุทูุฑู",
            "ุงุณุงูู ูููุฑ ุงูุนููู",
            "ูุญูุฏ ุนูุงุฏ ุงูุนููู",
            "ุฃุญูุฏ ุฅุจุฑุงููู ุงูุชุฑูู",
            "ุฃุญูุฏ ุญุงูุฏ ุงูุญุฑุจู",
            "ูููุงู ุนูู ุงูุญุฑุจู",
            "ุนุจุฏุงููู ุตูุงุญ ุงูุฑุญููู",
            "ูุดุนู ุจู ูููู ุงูุนูุฑู ุงูุญุฑุจู",
            "ุนูู ูุชุนุจ ุงูุนููู ุงูุญุฑุจู",
            "ุณูู ุนุจุฏุงูููุนู ุงูุนุงุฑุถู",
            "ูุญูุฏ ุจู ุฐุนุงุฑ ุงูุนููู",
            "ูุคุงุฏ ุจู ูุญูุฏ ุงูุนุชูุจู",
            "ุญูุฒุฉ ุตุฏูุฉ ุงุณูุงู",
            "ุณููุงู ุตุงูุญ ุงูุญุงุฑุซู",
            "ุนุจูุฏ ุจู ุฏุฎูู ุงูุนูุงุถู ุงูุญุฑุจู",
            "ุนุจุฏุงูุนุฒูุฒ ูููุญ ุงูุฑููุซู",
            "ููุตู ุนูุงุฏ ุฃุจู ุณููู",
            "ุนุจุฏุงููู ุจู ูุญูุฏ ุงููุฑูู",
            "ูุงุชุจ ูููุญ ุงูุฑุดูุฏู",
            "ุญุจูุจ ุนูู ุงูุนูุฑู ุงูุญุฑุจู",
            "ุงุจุฑุงููู ุนุงูุถ ุงูุฌุงุจุฑู",
            "ุณูุทุงู ุนููุถ ุงูุณุญููู",
            "ุนุจุฏุงููุงุฏู ูุนูุถ ุงูุดุงูุงูู",
            "ุนุจุฏุงูุนุฒูุฒ ุบูุงุจ ุงููุฎููู",
            "ุณุนุฏ ุทุงูุน ุงูุญุฑุจู",
            "ููุณู ุบุงุฒู ุณูุฑ ุงูุญุฑุจู",
            "ููุณู ูุณุนูุฏ ุงูุญูุณููู",
            "ููุงู ููุตูุฑ ุงูุตุจุญู",
            "ุจุฏุฑ ุนุจุฏุงูุนุฒูุฒ ุงูุณุญููู",
            "ููุฏ ุนููุถ ุงูุดุงูุงูู ุงูุญุฑุจู"
        ];

        // ุชููุฆุฉ ุงููุธุงู
        function initializeSystem() {
            if (confirm('ูู ุชุฑูุฏ ุชููุฆุฉ ุงููุธุงู ุจุฌููุน ุงููุนูููู ูุจูุงูุงุช ุงูุงูุชุธุงุฑุ')) {
                teachers = [];
                
                // ุฅุถุงูุฉ ุฌููุน ุงููุนูููู
                excelTeachers.forEach(name => {
                    const substitutionReq = teacherSubstitutionRequirements[name] || 0;
                    teachers.push({
                        id: Date.now() + Math.random(),
                        name: name,
                        subject: "ุบูุฑ ูุญุฏุฏ",
                        substituteCount: 0,
                        requiredSubstitutions: substitutionReq
                    });
                });
                
                renderTeachers();
                updateStats();
                saveAllData(); // โ ุญูุธ ุชููุงุฆู ุจุนุฏ ุงูุชููุฆุฉ
                showNotification('ุชู ุชููุฆุฉ ุงููุธุงู ุจูุฌุงุญ ูุน ' + teachers.length + ' ูุนูู', 'success');
            }
        }

        // ุญูุธ ุฌููุน ุงูุจูุงูุงุช
        function saveAllData() {
            localStorage.setItem('teachers', JSON.stringify(teachers));
            localStorage.setItem('absences', JSON.stringify(absences));
            showNotification('ุชู ุญูุธ ุงูุจูุงูุงุช ุจูุฌุงุญ', 'success');
        }

        // ุชุญููู ุงูุจูุงูุงุช ูู localStorage
        function loadData() {
            const savedTeachers = localStorage.getItem('teachers');
            const savedAbsences = localStorage.getItem('absences');

            if (savedTeachers) {
                teachers = JSON.parse(savedTeachers);
                // โ ุฏูุฌ ูุชุทูุจุงุช ุงูุงูุชุธุงุฑ ูู ุงููุตุฏุฑ ุงูุตุญูุญ
                teachers.forEach(t => {
                    t.requiredSubstitutions = teacherSubstitutionRequirements[t.name] || 0;
                });
            }
            if (savedAbsences) absences = JSON.parse(savedAbsences);
            
            renderAll();
        }

        // ูุณุญ ุฌููุน ุงูุจูุงูุงุช
        function clearAllData() {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ุฌููุน ุงูุจูุงูุงุชุ ูุง ูููู ุงูุชุฑุงุฌุน ุนู ูุฐุง ุงูุฅุฌุฑุงุก!')) {
                teachers = [];
                absences = [];
                localStorage.clear();
                renderAll();
                showNotification('ุชู ุญุฐู ุฌููุน ุงูุจูุงูุงุช', 'success');
            }
        }

        // ุฅุธูุงุฑ ุงูุฅุดุนุงุฑุงุช
        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.className = `mb-4 p-4 rounded-lg notification flex items-center gap-3 ${
                type === 'success' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
            }`;
            notification.innerHTML = `
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${
                        type === 'success' 
                            ? 'M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z'
                            : 'M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z'
                    }"></path>
                </svg>
                <span class="font-semibold">${message}</span>
            `;
            notification.classList.remove('hidden');
            setTimeout(() => notification.classList.add('hidden'), 3000);
        }

        // ุงูุชุจุฏูู ุจูู ุงูุชุจููุจุงุช
        function switchTab(tab) {
            const tabs = ['teachers', 'substitution', 'absences'];
            tabs.forEach(t => {
                const tabBtn = document.getElementById(`tab-${t}`);
                const content = document.getElementById(`content-${t}`);
                if (t === tab) {
                    tabBtn.className = 'flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-active';
                    content.classList.remove('hidden');
                } else {
                    tabBtn.className = 'flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-inactive';
                    content.classList.add('hidden');
                }
            });
        }

        // ุฅุถุงูุฉ ูุนูู ุฌุฏูุฏ
        function addTeacher() {
            const name = prompt('ุฃุฏุฎู ุงุณู ุงููุนูู:');
            const subject = prompt('ุฃุฏุฎู ุงูุชุฎุตุต:');
            if (name && subject) {
                const substitutionReq = teacherSubstitutionRequirements[name] || 0;
                teachers.push({
                    id: Date.now(),
                    name,
                    subject,
                    substituteCount: 0,
                    requiredSubstitutions: substitutionReq
                });
                renderTeachers();
                updateStats();
                showNotification('ุชู ุฅุถุงูุฉ ุงููุนูู ุจูุฌุงุญ', 'success');
            }
        }

        // ุญุฐู ูุนูู
        function deleteTeacher(id) {
            if (confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงููุนููุ')) {
                teachers = teachers.filter(t => t.id !== id);
                renderTeachers();
                updateStats();
                showNotification('ุชู ุญุฐู ุงููุนูู', 'success');
            }
        }

        // ุงูุจุญุซ ุนู ุฃูุถู ุจุฏูู ุญุณุจ ุงูุดุฑูุท
        function findBestSubstitute() {
            if (teachers.length === 0) {
                showNotification('ูุฑุฌู ุชููุฆุฉ ุงููุธุงู ุฃููุงู ุจุฅุถุงูุฉ ุงููุนูููู', 'error');
                return;
            }

            const day = document.getElementById('substitution-day').value;
            const period = document.getElementById('substitution-period').value;
            
            const absentTeacherName = prompt('ุฃุฏุฎู ุงุณู ุงููุนูู ุงูุบุงุฆุจ:');
            if (!absentTeacherName) return;

            const availableTeachers = getAvailableTeachers(day, period, absentTeacherName);
            const rankedTeachers = rankTeachersByPriority(availableTeachers, day);

            displaySubstitutionResults(rankedTeachers, day, period, absentTeacherName);
        }

        // ุงูุญุตูู ุนูู ุงููุนูููู ุงููุชุงุญูู
        function getAvailableTeachers(day, period, absentTeacher) {
            // ูู ุงููุธุงู ุงูุญุงููุ ููุชุฑุถ ุฃู ุฌููุน ุงููุนูููู ูุชุงุญูู
            // ูู ูุธุงู ุญููููุ ุณูุชุญูู ูู ุงูุฌุฏูู ุงููุฏุฑุณู
            return teachers.filter(teacher => {
                // ุงูุดุฑูุท ุงูุฃุณุงุณูุฉ
                const isAvailable = teacher.name !== absentTeacher;
                
                // ูุง ูููู ูุฏ ุฃุฎุฐ ุงูุชุธุงุฑ ูู ููุณ ุงูููู
                const hasSubstitutionToday = absences.some(a => 
                    a.day === day && a.substitute === teacher.name
                );

                return isAvailable && !hasSubstitutionToday;
            });
        }

        // ุชุฑุชูุจ ุงููุนูููู ุญุณุจ ุงูุฃููููุฉ
        function rankTeachersByPriority(availableTeachers, day) {
            return availableTeachers.map(teacher => {
                const requiredSubstitutions = teacher.requiredSubstitutions || 0;
                const currentSubstitutions = teacher.substituteCount || 0;
                const remainingSubstitutions = Math.max(0, requiredSubstitutions - currentSubstitutions);
                
                // ุญุณุงุจ ุนุฏุฏ ุงูุฃูุงู ุจุฏูู ุงูุชุธุงุฑ
                const daysWithoutSubstitution = calculateDaysWithoutSubstitution(teacher.name);
                
                // ุญุณุงุจ ุงูุฃููููุฉ
                let priorityScore = 0;
                
                // ุงูุฃููููุฉ ููู ูุฏูู ุญุตุต ุงูุชุธุงุฑ ูุทููุจุฉ ุฃูุซุฑ
                priorityScore += remainingSubstitutions * 10;
                
                // ุงูุฃููููุฉ ููู ูู ูุฃุฎุฐ ุงูุชุธุงุฑ ูู ุงูุฃูุงู ุงูุณุงุจูุฉ
                priorityScore += daysWithoutSubstitution * 5;

                return {
                    ...teacher,
                    priorityScore: priorityScore,
                    remainingSubstitutions: remainingSubstitutions,
                    daysWithoutSubstitution: daysWithoutSubstitution
                };
            }).sort((a, b) => b.priorityScore - a.priorityScore);
        }

        // ุญุณุงุจ ุนุฏุฏ ุงูุฃูุงู ุจุฏูู ุงูุชุธุงุฑ
        function calculateDaysWithoutSubstitution(teacherName) {
            const today = new Date();
            const substitutionDays = absences
                .filter(a => a.substitute === teacherName)
                .map(a => new Date(a.date));
            
            if (substitutionDays.length === 0) return 7; // ุฃุณุจูุน ูุงูู
            
            const lastSubstitution = new Date(Math.max(...substitutionDays));
            const daysDiff = Math.floor((today - lastSubstitution) / (1000 * 60 * 60 * 24));
            
            return Math.min(7, daysDiff);
        }

        // ุนุฑุถ ูุชุงุฆุฌ ุงูุจุญุซ ุนู ุงูุจุฏูู
        function displaySubstitutionResults(rankedTeachers, day, period, absentTeacher) {
            const resultsDiv = document.getElementById('substitution-results');
            
            if (rankedTeachers.length === 0) {
                resultsDiv.innerHTML = `
                    <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                        <p class="text-red-700 font-semibold">โ๏ธ ูุง ููุฌุฏ ูุนูููู ูุชุงุญูู ููุงูุชุธุงุฑ</p>
                        <p class="text-red-600 text-sm mt-1">ุฌููุน ุงููุนูููู ุฅูุง ูุดุบูููู ุฃู ูุฏููู ุฃูุซุฑ ูู 5 ุญุตุต ูู ุงูููู</p>
                    </div>
                `;
                return;
            }

            let html = `
                <div class="bg-green-50 p-4 rounded-lg border border-green-200 mb-4">
                    <h4 class="font-bold text-green-800">ุงูุบุงุฆุจ: ${absentTeacher}</h4>
                    <p class="text-green-600">ุงูููู: ${day} - ุงูุญุตุฉ: ${period}</p>
                </div>
            `;

            rankedTeachers.slice(0, 5).forEach((teacher, index) => {
                const priorityClass = index === 0 ? 'priority-1' : 
                                   index === 1 ? 'priority-2' : 'priority-3';
                
                                html += `
                    <div class="p-4 rounded-lg ${priorityClass}">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-bold text-lg ${index === 0 ? 'text-green-700' : 'text-gray-700'}">
                                    ${index + 1}. ${teacher.name}
                                </h4>
                                <div class="grid grid-cols-2 gap-2 text-sm mt-2">
                                    <div><span class="text-gray-600">ุงูุฃููููุฉ:</span> <span class="font-semibold">${teacher.priorityScore}</span></div>
                                    <div><span class="text-gray-600">ุญุตุต ุงูุงูุชุธุงุฑ ุงููุชุจููุฉ:</span> <span class="font-semibold">${teacher.remainingSubstitutions}</span></div>
                                    <div><span class="text-gray-600">ุฃูุงู ุจุฏูู ุงูุชุธุงุฑ:</span> <span class="font-semibold">${teacher.daysWithoutSubstitution}</span></div>
                                    <div><span class="text-gray-600">ุงูุญุตุต ุงูููุฌุฒุฉ:</span> <span class="font-semibold">${teacher.substituteCount}/${teacher.requiredSubstitutions}</span></div>
                                </div>
                            </div>
                            ${index === 0 ? `
                                <button onclick="assignSubstitution('${teacher.name}', '${absentTeacher}', '${day}', '${period}')" 
                                        class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition text-sm">
                                    ุชุนููู
                                </button>
                            ` : ''}
                        </div>
                    </div>
                `;
            });

            resultsDiv.innerHTML = html;
        }

        // ุชุนููู ุงูุงูุชุธุงุฑ
        function assignSubstitution(substituteName, absentTeacher, day, period) {
            // ุชุญุฏูุซ ุนุฏุฏ ุญุตุต ุงูุงูุชุธุงุฑ ูููุนูู ุงูุจุฏูู
            teachers = teachers.map(t =>
                t.name === substituteName
                    ? { ...t, substituteCount: (t.substituteCount || 0) + 1 }
                    : t
            );

            // ุชุณุฌูู ุญุตุฉ ุงูุงูุชุธุงุฑ
            absences.push({
                id: Date.now() + Math.random(),
                date: new Date().toLocaleDateString('ar-SA'),
                absentTeacher: absentTeacher,
                substitute: substituteName,
                day: day,
                period: period,
                subject: "ุญุตุฉ ุงูุชุธุงุฑ",
                className: "ูุฎุชููุฉ"
            });

            renderTeachers();
            renderAbsences();
            updateStats();
            showNotification(`ุชู ุชุนููู ${substituteName} ุจุฏููุงู ุนู ${absentTeacher}`, 'success');
            
            // ุชุญุฏูุซ ุงููุชุงุฆุฌ
            document.getElementById('substitution-results').innerHTML = `
                <div class="bg-green-100 p-4 rounded-lg border border-green-300">
                    <p class="text-green-700 font-semibold">โ ุชู ุงูุชุนููู ุจูุฌุงุญ</p>
                    <p class="text-green-600">ุงููุนูู ${substituteName} ุชู ุชุนูููู ููุงูุชุธุงุฑ</p>
                    <p class="text-green-500 text-sm mt-2">ุงูููู: ${day} - ุงูุญุตุฉ: ${period}</p>
                </div>
            `;
        }

        // ุชุณุฌูู ุบูุงุจ ูุนูู
        function markAbsent() {
            const absentTeacherName = prompt('ุฃุฏุฎู ุงุณู ุงููุนูู ุงูุบุงุฆุจ:');
            if (!absentTeacherName) return;

            // โ ุฌุฏูู ุงูุญุตุต ุงูุญูููู (ูุซุงู ุจุณูุท ูููู ุชูุณูุนู)
            const realSchedule = [
                {day: 'ุงูุฃุญุฏ',   period: '1'},
                {day: 'ุงูุฃุญุฏ',   period: '2'},
                {day: 'ุงูุงุซููู', period: '3'},
                {day: 'ุงูุซูุงุซุงุก',period: '4'},
                {day: 'ุงูุฃุฑุจุนุงุก',period: '5'},
                {day: 'ุงูุฎููุณ',  period: '6'}
            ];

            let assignedCount = 0;

            realSchedule.forEach(({day, period}) => {
                const availableTeachers = getAvailableTeachers(day, period, absentTeacherName);
                const rankedTeachers = rankTeachersByPriority(availableTeachers, day);

                if (rankedTeachers.length > 0) {
                    const bestSubstitute = rankedTeachers[0];
                    teachers = teachers.map(t =>
                        t.name === bestSubstitute.name
                            ? {...t, substituteCount: (t.substituteCount || 0) + 1}
                            : t
                    );

                    absences.push({
                        id: Date.now() + Math.random(),
                        date: new Date().toLocaleDateString('ar-SA'),
                        absentTeacher: absentTeacherName,
                        substitute: bestSubstitute.name,
                        day,
                        period,
                        subject: "ุญุตุฉ ุงูุชุธุงุฑ",
                        className: "ูุฎุชููุฉ"
                    });
                    assignedCount++;
                }
            });

            renderAbsences();
            renderTeachers();
            updateStats();
            showNotification(`ุชู ุชุนููู ${assignedCount} ุญุตุฉ ุงูุชุธุงุฑ ููุบูุงุจ`, 'success');
        }

        // ุญุฐู ุณุฌู ุบูุงุจ
        function deleteAbsence(id) {
            const absence = absences.find(a => a.id === id);
            if (absence && absence.substitute !== 'ูุง ููุฌุฏ ุจุฏูู ูุชุงุญ') {
                // โ ุชุฃูุฏ ุฃู ุงููุนูู ูุง ูุฒุงู ููุฌูุฏุงู
                const teacherExists = teachers.some(t => t.name === absence.substitute);
                if (teacherExists) {
                    teachers = teachers.map(t =>
                        t.name === absence.substitute && t.substituteCount > 0
                            ? {...t, substituteCount: t.substituteCount - 1}
                            : t
                    );
                }
            }
            
            absences = absences.filter(a => a.id !== id);
            renderAbsences();
            renderTeachers();
            updateStats();
            showNotification('ุชู ุญุฐู ุณุฌู ุงูุบูุงุจ', 'success');
        }

        // ุชูููุฏ ุชูุฑูุฑ ุงูุฃููููุงุช
        function generatePriorityReport() {
            let html = '<div class="space-y-3 max-h-96 overflow-y-auto">';
            
            // ุชุฑุชูุจ ุงููุนูููู ุญุณุจ ุงูุฃููููุฉ
            const sortedTeachers = [...teachers].sort((a, b) => {
                const aRemaining = Math.max(0, (a.requiredSubstitutions || 0) - (a.substituteCount || 0));
                const bRemaining = Math.max(0, (b.requiredSubstitutions || 0) - (b.substituteCount || 0));
                return bRemaining - aRemaining;
            });
            
            sortedTeachers.forEach(teacher => {
                const required = teacher.requiredSubstitutions || 0;
                const current = teacher.substituteCount || 0;
                const remaining = Math.max(0, required - current);
                const percentage = required > 0 ? Math.round((current / required) * 100) : 0;
                
                let status = '';
                let statusColor = '';
                let progressColor = '';
                
                if (required === 0) {
                    status = 'ุบูุฑ ูุทููุจ';
                    statusColor = 'text-gray-600';
                    progressColor = 'bg-gray-200';
                } else if (remaining === 0) {
                    status = 'ููุชูู โ';
                    statusColor = 'text-green-600';
                    progressColor = 'bg-green-200';
                } else if (percentage >= 50) {
                    status = `ูุชุจูู ${remaining}`;
                    statusColor = 'text-orange-600';
                    progressColor = 'bg-orange-200';
                } else {
                    status = `ูุชุจูู ${remaining}`;
                    statusColor = 'text-red-600';
                    progressColor = 'bg-red-200';
                }
                
                html += `
                    <div class="bg-white p-4 rounded-lg border border-gray-200">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="font-semibold text-gray-800">${teacher.name}</h4>
                            <span class="${statusColor} font-semibold text-sm">${status}</span>
                        </div>
                        <div class="flex justify-between items-center text-sm text-gray-600 mb-2">
                            <span>ุญุตุต ุงูุงูุชุธุงุฑ: ${current}/${required}</span>
                            <span>${percentage}% ููุชูู</span>
                        </div>
                        ${required > 0 ? `
                            <div class="w-full bg-gray-200 rounded-full h-1.5">
                                <div class="${progressColor} h-1.5 rounded-full" style="width: ${percentage}%"></div>
                            </div>
                        ` : ''}
                    </div>
                `;
            });
            
            html += '</div>';
            
            // ุนุฑุถ ุงูุชูุฑูุฑ ูู ูุงูุฐุฉ ููุจุซูุฉ
            const reportWindow = window.open('', 'ุชูุฑูุฑ ุงูุฃููููุงุช', 'width=600,height=700');
            reportWindow.document.write(`
                <html dir="rtl">
                <head>
                    <title>ุชูุฑูุฑ ุฃููููุงุช ุงููุนูููู</title>
                    <script src="https://cdn.tailwindcss.com"><\/script>
                    <style>
                        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; }
                    </style>
                </head>
                <body class="bg-gray-50">
                    <div class="bg-white rounded-lg shadow-lg p-6 max-w-4xl mx-auto">
                        <h1 class="text-2xl font-bold text-center text-gray-800 mb-6">ุชูุฑูุฑ ุฃููููุงุช ุญุตุต ุงูุงูุชุธุงุฑ</h1>
                        ${html}
                        <div class="mt-6 text-center text-gray-500 text-sm">
                            ุชู ุงูุชุญุฏูุซ: ${new Date().toLocaleString('ar-SA')}
                        </div>
                    </div>
                </body>
                </html>
            `);
            reportWindow.document.close();
        }

        // ุนุฑุถ ูุงุฆูุฉ ุงููุนูููู
        function renderTeachers() {
            const list = document.getElementById('teachers-list');
            if (teachers.length === 0) {
                list.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                        <p class="text-lg">ูุง ุชูุฌุฏ ูุนูููู ุจุนุฏ. ุงุจุฏุฃ ุจุชููุฆุฉ ุงููุธุงู!</p>
                        <button onclick="initializeSystem()" class="mt-4 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
                            ุชููุฆุฉ ุงููุธุงู
                        </button>
                    </div>
                `;
            } else {
                list.innerHTML = teachers.map(teacher => {
                    const required = teacher.requiredSubstitutions || 0;
                    const current = teacher.substituteCount || 0;
                    const remaining = Math.max(0, required - current);
                    const percentage = required > 0 ? Math.round((current / required) * 100) : 0;
                    
                    let statusBadge = '';
                    if (required === 0) {
                        statusBadge = '<span class="bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs">ุบูุฑ ูุทููุจ</span>';
                    } else if (remaining === 0) {
                        statusBadge = '<span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">ููุชูู</span>';
                    } else if (percentage >= 50) {
                        statusBadge = `<span class="bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs">ูุชุจูู ${remaining}</span>`;
                    } else {
                        statusBadge = `<span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs">ูุชุจูู ${remaining}</span>`;
                    }
                    
                    return `
                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                            <div class="flex-1">
                                <div class="flex items-center gap-2 mb-2">
                                    <h3 class="font-bold text-lg text-gray-800">${teacher.name}</h3>
                                    ${statusBadge}
                                </div>
                                <p class="text-gray-600">ุงูุชุฎุตุต: ${teacher.subject}</p>
                                <div class="flex gap-4 text-sm mt-1">
                                    <p class="text-indigo-600">ุญุตุต ุงูุงูุชุธุงุฑ: ${current}/${required}</p>
                                    <p class="text-blue-600">ุงูุฅูุฌุงุฒ: ${percentage}%</p>
                                </div>
                                ${required > 0 ? `
                                    <div class="w-full bg-gray-200 rounded-full h-1.5 mt-2">
                                        <div class="bg-green-500 h-1.5 rounded-full" style="width: ${percentage}%"></div>
                                    </div>
                                ` : ''}
                            </div>
                            <button onclick="deleteTeacher(${teacher.id})" class="text-red-600 hover:bg-red-100 p-2 rounded-lg transition">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    `;
                }).join('');
            }
        }

        // ุนุฑุถ ุณุฌูุงุช ุงูุบูุงุจ
        function renderAbsences() {
            const list = document.getElementById('absences-list');
            if (absences.length === 0) {
                list.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zMุงุจ', 'success');
        }

        // ุชูููุฏ ุชูุฑูุฑ ุงูุฃููููุงุช
        function generatePriorityReport() {
            let html = '<div class="space-y-3 max-h-96 overflow-y-auto">';
            
            // ุชุฑุชูุจ ุงููุนูููู ุญุณุจ ุงูุฃููููุฉ
            const sortedTeachers = [...teachers].sort((a, b) => {
                const aRemaining = Math.max(0, (a.requiredSubstitutions || 0) - (a.substituteCount || 0));
                const bRemaining = Math.max(0, (b.requiredSubstitutions || 0) - (b.substituteCount || 0));
                return bRemaining - aRemaining;
            });
            
            sortedTeachers.forEach(teacher => {
                const required = teacher.requiredSubstitutions || 0;
                const current = teacher.substituteCount || 0;
                const remaining = Math.max(0, required - current);
                const percentage = required > 0 ? Math.round((current / required) * 100) : 0;
                
                let status = '';
                let statusColor = '';
                let progressColor = '';
                
                if (required === 0) {
                    status = 'ุบูุฑ ูุทููุจ';
                    statusColor = 'text-gray-600';
                    progressColor = 'bg-gray-200';
                } else if (remaining === 0) {
                    status = 'ููุชูู โ';
                    statusColor = 'text-green-600';
                    progressColor = 'bg-green-200';
                } else if (percentage >= 50) {
                    status = `ูุชุจูู ${remaining}`;
                    statusColor = 'text-orange-600';
                    progressColor = 'bg-orange-200';
                } else {
                    status = `ูุชุจูู ${remaining}`;
                    statusColor = 'text-red-600';
                    progressColor = 'bg-red-200';
                }
                
                html += `
                    <div class="bg-white p-4 rounded-lg border border-gray-200">
                        <div class="flex justify-between items-center mb-2">
                            <h4 class="font-semibold text-gray-800">${teacher.name}</h4>
                            <span class="${statusColor} font-semibold text-sm">${status}</span>
                        </div>
                        <div class="flex justify-between items-center text-sm text-gray-600 mb-2">
                            <span>ุญุตุต ุงูุงูุชุธุงุฑ: ${current}/${required}</span>
                            <span>${percentage}% ููุชูู</span>
                        </div>
                        ${required > 0 ? `
                            <div class="w-full bg-gray-200 rounded-full h-1.5">
                                <div class="${progressColor} h-1.5 rounded-full" style="width: ${percentage}%"></div>
                            </div>
                        ` : ''}
                    </div>
                `;
            });
            
            html += '</div>';
            
            // ุนุฑุถ ุงูุชูุฑูุฑ ูู ูุงูุฐุฉ ููุจุซูุฉ
            const reportWindow = window.open('', 'ุชูุฑูุฑ ุงูุฃููููุงุช', 'width=600,height=700');
            reportWindow.document.write(`
                <html dir="rtl">
                <head>
                    <title>ุชูุฑูุฑ ุฃููููุงุช ุงููุนูููู</title>
                    <script src="https://cdn.tailwindcss.com"></script>
                    <style>
                        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; padding: 20px; }
                    </style>
                </head>
                <body class="bg-gray-50">
                    <div class="bg-white rounded-lg shadow-lg p-6 max-w-4xl mx-auto">
                        <h1 class="text-2xl font-bold text-center text-gray-800 mb-6">ุชูุฑูุฑ ุฃููููุงุช ุญุตุต ุงูุงูุชุธุงุฑ</h1>
                        ${html}
                        <div class="mt-6 text-center text-gray-500 text-sm">
                            ุชู ุงูุชุญุฏูุซ: ${new Date().toLocaleString('ar-SA')}
                        </div>
                    </div>
                </body>
                </html>
            `);
            reportWindow.document.close();
        }

        // ุนุฑุถ ูุงุฆูุฉ ุงููุนูููู
        function renderTeachers() {
            const list = document.getElementById('teachers-list');
            if (teachers.length === 0) {
                list.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                        <p class="text-lg">ูุง ุชูุฌุฏ ูุนูููู ุจุนุฏ. ุงุจุฏุฃ ุจุชููุฆุฉ ุงููุธุงู!</p>
                        <button onclick="initializeSystem()" class="mt-4 bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
                            ุชููุฆุฉ ุงููุธุงู
                        </button>
                    </div>
                `;
            } else {
                list.innerHTML = teachers.map(teacher => {
                    const required = teacher.requiredSubstitutions || 0;
                    const current = teacher.substituteCount || 0;
                    const remaining = Math.max(0, required - current);
                    const percentage = required > 0 ? Math.round((current / required) * 100) : 0;
                    
                    let statusBadge = '';
                    if (required === 0) {
                        statusBadge = '<span class="bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs">ุบูุฑ ูุทููุจ</span>';
                    } else if (remaining === 0) {
                        statusBadge = '<span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs">ููุชูู</span>';
                    } else if (percentage >= 50) {
                        statusBadge = `<span class="bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs">ูุชุจูู ${remaining}</span>`;
                    } else {
                        statusBadge = `<span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs">ูุชุจูู ${remaining}</span>`;
                    }
                    
                    return `
                        <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                            <div class="flex-1">
                                <div class="flex items-center gap-2 mb-2">
                                    <h3 class="font-bold text-lg text-gray-800">${teacher.name}</h3>
                                    ${statusBadge}
                                </div>
                                <p class="text-gray-600">ุงูุชุฎุตุต: ${teacher.subject}</p>
                                <div class="flex gap-4 text-sm mt-1">
                                    <p class="text-indigo-600">ุญุตุต ุงูุงูุชุธุงุฑ: ${current}/${required}</p>
                                    <p class="text-blue-600">ุงูุฅูุฌุงุฒ: ${percentage}%</p>
                                </div>
                                ${required > 0 ? `
                                    <div class="w-full bg-gray-200 rounded-full h-1.5 mt-2">
                                        <div class="bg-green-500 h-1.5 rounded-full" style="width: ${percentage}%"></div>
                                    </div>
                                ` : ''}
                            </div>
                            <button onclick="deleteTeacher(${teacher.id})" class="text-red-600 hover:bg-red-100 p-2 rounded-lg transition">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    `;
                }).join('');
            }
        }

        // ุนุฑุถ ุณุฌูุงุช ุงูุบูุงุจ
        function renderAbsences() {
            const list = document.getElementById('absences-list');
            if (absences.length === 0) {
                list.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        <p class="text-lg">ูุง ุชูุฌุฏ ุณุฌูุงุช ุบูุงุจ ุญุชู ุงูุขู</p>
                    </div>
                `;
            } else {
                list.innerHTML = absences.map(absence => `
                    <div class="p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg border-r-4 ${absence.substitute === 'ูุง ููุฌุฏ ุจุฏูู ูุชุงุญ' ? 'border-red-500' : 'border-orange-500'}">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="flex items-center gap-2 mb-2 flex-wrap">
                                    <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-semibold">ุบุงุฆุจ</span>
                                    <span class="font-bold text-lg">${absence.absentTeacher}</span>
                                    ${absence.substitute !== 'ูุง ููุฌุฏ ุจุฏูู ูุชุงุญ' ? 
                                        `<span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold">ุจุฏูู: ${absence.substitute}</span>` :
                                        `<span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-semibold">ูุง ููุฌุฏ ุจุฏูู</span>`
                                    }
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
                                    <div><span class="text-gray-600">ุงูุชุงุฑูุฎ:</span> <span class="font-semibold">${absence.date}</span></div>
                                    <div><span class="text-gray-600">ุงูููู:</span> <span class="font-semibold">${absence.day}</span></div>
                                    <div><span class="text-gray-600">ุงูุญุตุฉ:</span> <span class="font-semibold">${absence.period}</span></div>
                                    <div><span class="text-gray-600">ุงููุงุฏุฉ:</span> <span class="font-semibold">${absence.subject}</span></div>
                                </div>
                            </div>
                            <button onclick="deleteAbsence(${absence.id})" class="text-red-600 hover:bg-red-100 p-2 rounded-lg transition">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                `).join('');
            }
        }

        // ุชุญุฏูุซ ุงูุฅุญุตุงุฆูุงุช
        function updateStats() {
            document.getElementById('stat-teachers').textContent = teachers.length;
            document.getElementById('stat-absences').textContent = absences.length;
        }

        // ุนุฑุถ ูู ุงููุญุชูู
        function renderAll() {
            renderTeachers();
            renderAbsences();
            updateStats();
        }

        // ุชููุฆุฉ ุงูุตูุญุฉ
        window.onload = function() {
            loadData();
        };
    </script>
</body>
</html>
