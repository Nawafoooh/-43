<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام إدارة حصص الانتظار المدرسية</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        .tab-active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        .tab-inactive {
            color: #4a5568;
        }
        .tab-inactive:hover {
            background-color: #f7fafc;
        }
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .notification {
            animation: slideIn 0.3s ease-out;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen p-4">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <div class="flex items-center gap-3">
                    <svg class="w-10 h-10 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    <div>
                        <h1 class="text-3xl font-bold text-gray-800">نظام إدارة حصص الانتظار</h1>
                        <p class="text-gray-600">إدارة ذكية للمعلمين والجداول المدرسية</p>
                    </div>
                </div>
                <div class="flex gap-2 flex-wrap">
                    <button onclick="saveAllData()" class="flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path>
                        </svg>
                        حفظ البيانات
                    </button>
                    <button onclick="clearAllData()" class="flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                        </svg>
                        مسح الكل
                    </button>
                    <button onclick="importDefaultSchedule()" class="flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"></path>
                        </svg>
                        استيراد الجدول الافتراضي
                    </button>
                </div>
            </div>
        </div>

        <!-- Notification -->
        <div id="notification" class="hidden mb-4 p-4 rounded-lg notification"></div>

        <!-- Tabs -->
        <div class="bg-white rounded-lg shadow-lg mb-6">
            <div class="flex flex-col md:flex-row border-b">
                <button onclick="switchTab('teachers')" id="tab-teachers" class="flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-active">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                    المعلمين
                </button>
                <button onclick="switchTab('schedule')" id="tab-schedule" class="flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-inactive">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                    </svg>
                    الجدول المدرسي
                </button>
                <button onclick="switchTab('absences')" id="tab-absences" class="flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-inactive">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    حصص الانتظار
                </button>
            </div>
        </div>

        <!-- Content -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <!-- Teachers Tab -->
            <div id="content-teachers" class="tab-content">
                <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800">قائمة المعلمين</h2>
                    <button onclick="addTeacher()" class="flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition w-full md:w-auto justify-center">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                        </svg>
                        إضافة معلم
                    </button>
                </div>
                <div id="teachers-list" class="grid gap-4"></div>
            </div>

            <!-- Schedule Tab -->
            <div id="content-schedule" class="tab-content hidden">
                <!-- أداة استيراد الجدول -->
                <div class="mb-6 bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <h3 class="text-lg font-bold text-blue-800 mb-2">استيراد الجدول المدرسي</h3>
                    <p class="text-blue-600 mb-3">الصق الجدول الكامل من منصة مدرستي وسيتم معالجته تلقائياً</p>
                    <textarea id="schedule-paste-area" rows="10" class="w-full p-3 border border-blue-300 rounded-lg" placeholder="الصق الجدول الكامل هنا..."></textarea>
                    <div class="flex gap-2 mt-2">
                        <button onclick="processPastedSchedule()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition">
                            معالجة الجدول تلقائياً
                        </button>
                        <button onclick="addBulkEntry()" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition">
                            إدخال جماعي
                        </button>
                    </div>
                </div>

                <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800">الجدول المدرسي</h2>
                    <div class="flex gap-2">
                        <button onclick="addScheduleEntry()" class="flex items-center gap-2 bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 transition">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
                            </svg>
                            إضافة حصة
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <div id="schedule-list"></div>
                </div>
            </div>

            <!-- Absences Tab -->
            <div id="content-absences" class="tab-content hidden">
                <div class="flex flex-col md:flex-row justify-between items-center mb-6 gap-4">
                    <h2 class="text-2xl font-bold text-gray-800">إدارة حصص الانتظار</h2>
                    <button onclick="markAbsent()" class="flex items-center gap-2 bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 transition w-full md:w-auto justify-center">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        تسجيل غياب معلم
                    </button>
                </div>
                <div id="absences-list" class="space-y-4"></div>
            </div>
        </div>

        <!-- Statistics -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-6">
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">عدد المعلمين</p>
                        <p id="stat-teachers" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">عدد الحصص</p>
                        <p id="stat-schedule" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
            <div class="bg-white rounded-lg shadow-lg p-6">
                <div class="flex items-center gap-3">
                    <svg class="w-8 h-8 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                    </svg>
                    <div>
                        <p class="text-gray-600 text-sm">حصص الانتظار</p>
                        <p id="stat-absences" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let teachers = [];
        let schedule = [];
        let absences = [];

        // قائمة المعلمين المستخرجة من Excel
        const excelTeachers = [
            "عبدالله بن مطر بن مصلح العمري",
            "محمد بن عماري راضي الزهراني",
            "موفق مرزوق سويرح السحيمي",
            "فواز زايد لافي المهيمزي الرشيدي",
            "فيصل عطالله حويمد الصاعدي",
            "ابراهيم عياد عيد العلوي",
            "عبدالله حمود حامد الحربي",
            "ساير فيصل سعد الله العضيله المطيري",
            "نافع شعوي نافع المطيري",
            "اسامه منور مشعل العوفي",
            "محمد عياد عليثه العوفي",
            "أحمد إبراهيم فخري التركي",
            "أحمد حامد هلال الحربي",
            "نميان علي نميان الحربي",
            "عبدالله صلاح صالح الرحيلى",
            "مشعل بن هليل بن غالب العمري الحربي",
            "علي متعب ناصر العلوي الحربي",
            "سيف عبدالمنعم حمدان العارضي",
            "محمد بن ذعار بن صالح العوفي",
            "فؤاد بن محمد بن حماد العتيبي",
            "حمزة صدقة حمزة اسلام",
            "سلمان صالح أحمد الحارثي",
            "عبيد بن دخيل بن دويهيس العياضي الحربي",
            "عبدالعزيز مفلح نويعم الرويثي",
            "فيصل عواد محمد أبو سلمي",
            "عبدالله بن محمد بن سعيد ال بحران القرني",
            "كاتب مفلح سليمان الرشيدى",
            "حبيب علي نعيس العمري الحربi",
            "ابراهيم عايض عوض الجابري",
            "سلطان عويض معيض السحيمي",
            "عبدالهادي معيض معلا الشاماني",
            "عبدالعزيز عبدالرحمن غلاب المخلفي",
            "سعد طالع حمود الحربي",
            "ناهر مشعل عويد المطيري",
            "موسى غازي سفر الحربي",
            "موسى مسعود عايض الحيسوني",
            "نواف منصور عواد الصبحي",
            "بدر عبدالعزيز شائد السحيمي",
            "فهد عويض عوض الشاماني الحربي"
        ];

        // الجدول المدرسي الافتراضي (محدث مع الصف الثاني - ٤)
        const defaultSchedule = [
            // الصف الثالث - ٦
            { teacherName: "ساير العضيله المطيري", day: "الأحد", period: "1", subject: "التربية البدنية والدفاع عن النفس", className: "الثالث - ٦" },
            { teacherName: "عبيد العياضي الحربي", day: "الأحد", period: "2", subject: "الرياضيات", className: "الثالث - ٦" },
            { teacherName: "أحمد الحربي", day: "الأحد", period: "3", subject: "العلوم", className: "الثالث - ٦" },
            { teacherName: "سعد الحربي", day: "الأحد", period: "4", subject: "التفكير الناقد", className: "الثالث - ٦" },
            { teacherName: "نافع المطيري", day: "الأحد", period: "5", subject: "الدراسات الاجتماعية", className: "الثالث - ٦" },
            { teacherName: "نميان الحربي", day: "الأحد", period: "6", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثالث - ٦" },
            { teacherName: "حبيب العمري الحربي", day: "الأحد", period: "7", subject: "اللغة العربية", className: "الثالث - ٦" },

            // الصف الثالث - ٥
            { teacherName: "سعد الحربي", day: "الأحد", period: "1", subject: "التفكير الناقد", className: "الثالث - ٥" },
            { teacherName: "نميان الحربي", day: "الأحد", period: "2", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثالث - ٥" },
            { teacherName: "عبيد العياضي الحربي", day: "الأحد", period: "3", subject: "الرياضيات", className: "الثالث - ٥" },
            { teacherName: "حبيب العمري الحربي", day: "الأحد", period: "4", subject: "اللغة العربية", className: "الثالث - ٥" },
            { teacherName: "عبيد العياضي الحربي", day: "الأحد", period: "5", subject: "الرياضيات", className: "الثالث - ٥" },
            { teacherName: "نافع المطيري", day: "الأحد", period: "6", subject: "الدراسات الاجتماعية", className: "الثالث - ٥" },
            { teacherName: "نميان الحربي", day: "الأحد", period: "7", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثالث - ٥" },

            // الصف الثالث - ٤
            { teacherName: "فؤاد بن العتيبي", day: "الأحد", period: "1", subject: "اللغة الإنجليزية", className: "الثالث - ٤" },
            { teacherName: "ساير العضيله المطيري", day: "الأحد", period: "2", subject: "التربية البدنية والدفاع عن النفس", className: "الثالث - ٤" },
            { teacherName: "عبدالله الرحيلى", day: "الأحد", period: "3", subject: "الرياضيات", className: "الثالث - ٤" },
            { teacherName: "فواز المهيمزي الرشيدي", day: "الأحد", period: "4", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثالث - ٤" },
            { teacherName: "سعد الحربي", day: "الأحد", period: "5", subject: "التفكير الناقد", className: "الثالث - ٤" },
            { teacherName: "حبيب العمري الحربي", day: "الأحد", period: "6", subject: "اللغة العربية", className: "الثالث - ٤" },
            { teacherName: "موسى الحربي", day: "الأحد", period: "7", subject: "المهارات الحياتية والأسرية", className: "الثالث - ٤" },

            // الصف الثالث - ٣
            { teacherName: "عبدالله الرحيلى", day: "الأحد", period: "1", subject: "الرياضيات", className: "الثالث - ٣" },
            { teacherName: "أحمد الرشيدي", day: "الأحد", period: "2", subject: "اللغة الإنجليزية", className: "الثالث - ٣" },
            { teacherName: "فواز المهيمزي الرشيدي", day: "الأحد", period: "3", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثالث - ٣" },
            { teacherName: "نافع المطيري", day: "الأحد", period: "4", subject: "الدراسات الاجتماعية", className: "الثالث - ٣" },
            { teacherName: "عبدالعزيز الرويثي", day: "الأحد", period: "5", subject: "اللغة العربية", className: "الثالث - ٣" },
            { teacherName: "عبدالله بن ال بحران القرني", day: "الأحد", period: "6", subject: "المهارات الرقمية", className: "الثالث - ٣" },
            { teacherName: "سعد الحربي", day: "الأحد", period: "7", subject: "التفكير الناقد", className: "الثالث - ٣" },

            // الصف الثالث - ٢
            { teacherName: "أحمد الحربي", day: "الأحد", period: "1", subject: "العلوم", className: "الثالث - ٢" },
            { teacherName: "أحمد الحربي", day: "الأحد", period: "2", subject: "العلوم", className: "الثالث - ٢" },
            { teacherName: "عبدالله بن ال بحران القرني", day: "الأحد", period: "3", subject: "المهارات الرقمية", className: "الثالث - ٢" },
            { teacherName: "عبدالله الرحيلى", day: "الأحد", period: "4", subject: "الرياضيات", className: "الثالث - ٢" },
            { teacherName: "ساير العضيله المطيري", day: "الأحد", period: "5", subject: "التربية البدنية والدفاع عن النفس", className: "الثالث - ٢" },
            { teacherName: "عبدالعزيز الرويثي", day: "الأحد", period: "6", subject: "اللغة العربية", className: "الثالث - ٢" },
            { teacherName: "سلطان السحيمي", day: "الأحد", period: "7", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثالث - ٢" },

            // الصف الثالث - ١
            { teacherName: "سلطان السحيمي", day: "الأحد", period: "1", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثالث - ١" },
            { teacherName: "عبدالله الرحيلى", day: "الأحد", period: "2", subject: "الرياضيات", className: "الثالث - ١" },
            { teacherName: "نافع المطيري", day: "الأحد", period: "3", subject: "الدراسات الاجتماعية", className: "الثالث - ١" },
            { teacherName: "سيف العارضي", day: "الأحد", period: "4", subject: "التربية الفنية", className: "الثالث - ١" },
            { teacherName: "سيف العارضي", day: "الأحد", period: "5", subject: "التربية الفنية", className: "الثالث - ١" },
            { teacherName: "سلطان السحيمي", day: "الأحد", period: "6", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثالث - ١" },
            { teacherName: "عبدالعزيز الرويثي", day: "الأحد", period: "7", subject: "اللغة العربية", className: "الثالث - ١" },

            // الصف الثاني - ٦
            { teacherName: "موسى الحربي", day: "الأحد", period: "1", subject: "المهارات الحياتية والأسرية", className: "الثاني - ٦" },
            { teacherName: "عبدالعزيز المخلفي", day: "الأحد", period: "2", subject: "العلوم", className: "الثاني - ٦" },
            { teacherName: "فيصل الصاعدي", day: "الأحد", period: "3", subject: "اللغة العربية", className: "الثاني - ٦" },
            { teacherName: "موفق السحيمي", day: "الأحد", period: "4", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثاني - ٦" },
            { teacherName: "حمزة اسلام", day: "الأحد", period: "5", subject: "اللغة الإنجليزية", className: "الثاني - ٦" },
            { teacherName: "ناهر المطيري", day: "الأحد", period: "6", subject: "الرياضيات", className: "الثاني - ٦" },
            { teacherName: "فيصل أبو سلمي", day: "الأحد", period: "7", subject: "التربية البدنية والدفاع عن النفس", className: "الثاني - ٦" },

            // الصف الثاني - ٥
            { teacherName: "ناهر المطيري", day: "الأحد", period: "1", subject: "الرياضيات", className: "الثاني - ٥" },
            { teacherName: "ناهر المطيري", day: "الأحد", period: "2", subject: "الرياضيات", className: "الثاني - ٥" },
            { teacherName: "اسامه العوفي", day: "الأحد", period: "3", subject: "الدراسات الاجتماعية", className: "الثاني - ٥" },
            { teacherName: "موسى الحربي", day: "الأحد", period: "4", subject: "المهارات الحياتية والأسرية", className: "الثاني - ٥" },
            { teacherName: "عبدالهادي الشاماني", day: "الأحد", period: "5", subject: "التربية الفنية", className: "الثاني - ٥" },
            { teacherName: "عبدالهادي الشاماني", day: "الأحد", period: "6", subject: "التربية الفنية", className: "الثاني - ٥" },
            { teacherName: "فيصل الصاعدي", day: "الأحد", period: "7", subject: "اللغة العربية", className: "الثاني - ٥" },

            // الصف الثاني - ٤ (المضاف حديثاً)
            { teacherName: "عبدالعزيز المخلفي", day: "الأحد", period: "1", subject: "العلوم", className: "الثاني - ٤" },
            { teacherName: "عبدالله الحربي", day: "الأحد", period: "2", subject: "الرياضيات", className: "الثاني - ٤" },
            { teacherName: "حمزة اسلام", day: "الأحد", period: "3", subject: "اللغة الإنجليزية", className: "الثاني - ٤" },
            { teacherName: "فهد الشاماني الحربي", day: "الأحد", period: "4", subject: "اللغة العربية", className: "الثاني - ٤" },
            { teacherName: "اسامه العوفي", day: "الأحد", period: "5", subject: "الدراسات الاجتماعية", className: "الثاني - ٤" },
            { teacherName: "سلمان الحارثي", day: "الأحد", period: "6", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثاني - ٤" },
            { teacherName: "عبدالمجيد الرشيدي", day: "الأحد", period: "7", subject: "المهارات الرقمية", className: "الثاني - ٤" },

            { teacherName: "سلمان الحارثي", day: "الاثنين", period: "1", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثاني - ٤" },
            { teacherName: "عبدالله الحربي", day: "الاثنين", period: "2", subject: "الرياضيات", className: "الثاني - ٤" },
            { teacherName: "عبدالعزيز المخلفي", day: "الاثنين", period: "3", subject: "العلوم", className: "الثاني - ٤" },
            { teacherName: "حمزة اسلام", day: "الاثنين", period: "4", subject: "اللغة الإنجليزية", className: "الثاني - ٤" },
            { teacherName: "فهد الشاماني الحربي", day: "الاثنين", period: "5", subject: "اللغة العربية", className: "الثاني - ٤" },
            { teacherName: "سلمان الحارثي", day: "الاثنين", period: "6", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثاني - ٤" },
            { teacherName: "اسامه العوفي", day: "الاثنين", period: "7", subject: "الدراسات الاجتماعية", className: "الثاني - ٤" },

            { teacherName: "عبدالله الحربي", day: "الثلاثاء", period: "1", subject: "الرياضيات", className: "الثاني - ٤" },
            { teacherName: "عبدالمجيد الرشيدي", day: "الثلاثاء", period: "2", subject: "المهارات الرقمية", className: "الثاني - ٤" },
            { teacherName: "عبدالله الحربي", day: "الثلاثاء", period: "3", subject: "الرياضيات", className: "الثاني - ٤" },
            { teacherName: "سلمان الحارثي", day: "الثلاثاء", period: "4", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثاني - ٤" },
            { teacherName: "فيصل أبو سلمي", day: "الثلاثاء", period: "5", subject: "التربية البدنية والدفاع عن النفس", className: "الثاني - ٤" },
            { teacherName: "فهد الشاماني الحربي", day: "الثلاثاء", period: "6", subject: "اللغة العربية", className: "الثاني - ٤" },
            { teacherName: "عبدالعزيز المخلفي", day: "الثلاثاء", period: "7", subject: "العلوم", className: "الثاني - ٤" },

            { teacherName: "حمزة اسلام", day: "الأربعاء", period: "1", subject: "اللغة الإنجليزية", className: "الثاني - ٤" },
            { teacherName: "عبدالهادي الشاماني", day: "الأربعاء", period: "2", subject: "التربية الفنية", className: "الثاني - ٤" },
            { teacherName: "عبدالهادي الشاماني", day: "الأربعاء", period: "3", subject: "التربية الفنية", className: "الثاني - ٤" },
            { teacherName: "موسى الحربي", day: "الأربعاء", period: "4", subject: "المهارات الحياتية والأسرية", className: "الثاني - ٤" },
            { teacherName: "عبدالعزيز المخلفي", day: "الأربعاء", period: "5", subject: "العلوم", className: "الثاني - ٤" },
            { teacherName: "عبدالله الحربي", day: "الأربعاء", period: "6", subject: "الرياضيات", className: "الثاني - ٤" },
            { teacherName: "فهد الشاماني الحربي", day: "الأربعاء", period: "7", subject: "اللغة العربية", className: "الثاني - ٤" },

            { teacherName: "اسامه العوفي", day: "الخميس", period: "1", subject: "الدراسات الاجتماعية", className: "الثاني - ٤" },
            { teacherName: "فهد الشاماني الحربي", day: "الخميس", period: "2", subject: "اللغة العربية", className: "الثاني - ٤" },
            { teacherName: "حمزة اسلام", day: "الخميس", period: "3", subject: "اللغة الإنجليزية", className: "الثاني - ٤" },
            { teacherName: "فيصل أبو سلمي", day: "الخميس", period: "4", subject: "التربية البدنية والدفاع عن النفس", className: "الثاني - ٤" },
            { teacherName: "عبدالله الحربي", day: "الخميس", period: "5", subject: "الرياضيات", className: "الثاني - ٤" },
            { teacherName: "سلمان الحارثي", day: "الخميس", period: "6", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثاني - ٤" },

            // الصف الثاني - ٣
            { teacherName: "اسامه العوفي", day: "الأحد", period: "1", subject: "الدراسات الاجتماعية", className: "الثاني - ٣" },
            { teacherName: "حمزة اسلام", day: "الأحد", period: "2", subject: "اللغة الإنجليزية", className: "الثاني - ٣" },
            { teacherName: "عبدالعزيز المخلفي", day: "الأحد", period: "3", subject: "العلوم", className: "الثاني - ٣" },
            { teacherName: "عبدالله بن ال بحران القرني", day: "الأحد", period: "4", subject: "المهارات الرقمية", className: "الثاني - ٣" },
            { teacherName: "فهد الشاماني الحربي", day: "الأحد", period: "5", subject: "اللغة العربية", className: "الثاني - ٣" },
            { teacherName: "ساير العضيله المطيري", day: "الأحد", period: "6", subject: "التربية البدنية والدفاع عن النفس", className: "الثاني - ٣" },
            { teacherName: "سلمان الحارثي", day: "الأحد", period: "7", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثاني - ٣" },

            // الصف الثاني - ٢
            { teacherName: "حمزة اسلام", day: "الأحد", period: "1", subject: "اللغة الإنجليزية", className: "الثاني - ٢" },
            { teacherName: "عبدالله بن ال بحران القرني", day: "الأحد", period: "2", subject: "المهارات الرقمية", className: "الثاني - ٢" },
            { teacherName: "عبدالله الحربي", day: "الأحد", period: "3", subject: "الرياضيات", className: "الثاني - ٢" },
            { teacherName: "عبدالله الحربي", day: "الأحد", period: "4", subject: "الرياضيات", className: "الثاني - ٢" },
            { teacherName: "أحمد التركي", day: "الأحد", period: "5", subject: "اللغة العربية", className: "الثاني - ٢" },
            { teacherName: "ابراهيم الجابري", day: "الأحد", period: "6", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثاني - ٢" },
            { teacherName: "اسامه العوفي", day: "الأحد", period: "7", subject: "الدراسات الاجتماعية", className: "الثاني - ٢" },

            // الصف الثاني - ١
            { teacherName: "عبدالله الحربي", day: "الأحد", period: "1", subject: "الرياضيات", className: "الثاني - ١" },
            { teacherName: "اسامه العوفي", day: "الأحد", period: "2", subject: "الدراسات الاجتماعية", className: "الثاني - ١" },
            { teacherName: "ساير العضيله المطيري", day: "الأحد", period: "3", subject: "التربية البدنية والدفاع عن النفس", className: "الثاني - ١" },
            { teacherName: "عبدالعزيز المخلفي", day: "الأحد", period: "4", subject: "العلوم", className: "الثاني - ١" },
            { teacherName: "ابراهيم الجابري", day: "الأحد", period: "5", subject: "القرآن الكريم والدراسات الإسلامية", className: "الثاني - ١" },
            { teacherName: "أحمد التركي", day: "الأحد", period: "6", subject: "اللغة العربية", className: "الثاني - ١" },
            { teacherName: "عبدالله بن ال بحران القرني", day: "الأحد", period: "7", subject: "المهارات الرقمية", className: "الثاني - ١" },

            // الصف الأول - ٦
            { teacherName: "محمد العوفي", day: "الأحد", period: "1", subject: "القرآن الكريم والدراسات الإسلامية", className: "الأول - ٦" },
            { teacherName: "علي العلوي الحربي", day: "الأحد", period: "2", subject: "العلوم", className: "الأول - ٦" },
            { teacherName: "محمد العوفي", day: "الأحد", period: "3", subject: "القرآن الكريم والدراسات الإسلامية", className: "الأول - ٦" },
            { teacherName: "ناهر المطيري", day: "الأحد", period: "4", subject: "الرياضيات", className: "الأول - ٦" },
            { teacherName: "كاتب الرشيدى", day: "الأحد", period: "5", subject: "اللغة الإنجليزية", className: "الأول - ٦" },
            { teacherName: "محمد الزهراني", day: "الأحد", period: "6", subject: "اللغة العربية", className: "الأول - ٦" },
            { teacherName: "نافع المطيري", day: "الأحد", period: "7", subject: "الدراسات الاجتماعية", className: "الأول - ٦" },

            // الصف الأول - ٥
            { teacherName: "علي العلوي الحربي", day: "الأحد", period: "1", subject: "العلوم", className: "الأول - ٥" },
            { teacherName: "كاتب الرشيدى", day: "الأحد", period: "2", subject: "اللغة الإنجليزية", className: "الأول - ٥" },
            { teacherName: "موسى الحربي", day: "الأحد", period: "3", subject: "المهارات الحياتية والأسرية", className: "الأول - ٥" },
            { teacherName: "عبدالمجيد الرشيدي", day: "الأحد", period: "4", subject: "المهارات الرقمية", className: "الأول - ٥" },
            { teacherName: "محمد الزهراني", day: "الأحد", period: "5", subject: "اللغة العربية", className: "الأول - ٥" },
            { teacherName: "عبيد العياضي الحربي", day: "الأحد", period: "6", subject: "الرياضيات", className: "الأول - ٥" },
            { teacherName: "ابراهيم العلوي", day: "الأحد", period: "7", subject: "الدراسات الاجتماعية", className: "الأول - ٥" },

            // الصف الأول - ٤
            { teacherName: "عبدالله العمري", day: "الأحد", period: "1", subject: "القرآن الكريم والدراسات الإسلامية", className: "الأول - ٤" },
            { teacherName: "ابراهيم العلوي", day: "الأحد", period: "2", subject: "الدراسات الاجتماعية", className: "الأول - ٤" },
            { teacherName: "مشعل العمري الحربي", day: "الأحد", period: "3", subject: "الرياضيات", className: "الأول - ٤" },
            { teacherName: "مشعل العمري الحربي", day: "الأحد", period: "4", subject: "الرياضيات", className: "الأول - ٤" },
            { teacherName: "فيصل أبو سلمي", day: "الأحد", period: "5", subject: "التربية البدنية والدفاع عن النفس", className: "الأول - ٤" },
            { teacherName: "كاتب الرشيدى", day: "الأحد", period: "6", subject: "اللغة الإنجليزية", className: "الأول - ٤" },
            { teacherName: "محمد الزهراني", day: "الأحد", period: "7", subject: "اللغة العربية", className: "الأول - ٤" },

            // الصف الأول - ٣
            { teacherName: "كاتب الرشيدى", day: "الأحد", period: "1", subject: "اللغة الإنجليزية", className: "الأول - ٣" },
            { teacherName: "محمد بن العوفي", day: "الأحد", period: "2", subject: "اللغة العربية", className: "الأول - ٣" },
            { teacherName: "علي العلوي الحربي", day: "الأحد", period: "3", subject: "العلوم", className: "الأول - ٣" },
            { teacherName: "فيصل أبو سلمي", day: "الأحد", period: "4", subject: "التربية البدنية والدفاع عن النفس", className: "الأول - ٣" },
            { teacherName: "ابراهيم العلوي", day: "الأحد", period: "5", subject: "الدراسات الاجتماعية", className: "الأول - ٣" },
            { teacherName: "مشعل العمري الحربي", day: "الأحد", period: "6", subject: "الرياضيات", className: "الأول - ٣" },
            { teacherName: "عبدالله العمري", day: "الأحد", period: "7", subject: "القرآن الكريم والدراسات الإسلامية", className: "الأول - ٣" },

            // الصف الأول - ٢
            { teacherName: "مشعل العمري الحربي", day: "الأحد", period: "1", subject: "الرياضيات", className: "الأول - ٢" },
            { teacherName: "عبدالهادي الشاماني", day: "الأحد", period: "2", subject: "التربية الفنية", className: "الأول - ٢" },
            { teacherName: "عبدالهادي الشاماني", day: "الأحد", period: "3", subject: "التربية الفنية", className: "الأول - ٢" },
            { teacherName: "ابراهيم العلوي", day: "الأحد", period: "4", subject: "الدراسات الاجتماعية", className: "الأول - ٢" },
            { teacherName: "محمد بن العوفي", day: "الأحد", period: "5", subject: "اللغة العربية", className: "الأول - ٢" },
            { teacherName: "فيصل أبو سلمي", day: "الأحد", period: "6", subject: "التربية البدنية والدفاع عن النفس", className: "الأول - ٢" },
            { teacherName: "بدر السحيمي", day: "الأحد", period: "7", subject: "القرآن الكريم والدراسات الإسلامية", className: "الأول - ٢" },

            // الصف الأول - ١
            { teacherName: "فيصل أبو سلمي", day: "الأحد", period: "1", subject: "التربية البدنية والدفاع عن النفس", className: "الأول - ١" },
            { teacherName: "مشعل العمري الحربي", day: "الأحد", period: "2", subject: "الرياضيات", className: "الأول - ١" },
            { teacherName: "محمد بن العوفي", day: "الأحد", period: "3", subject: "اللغة العربية", className: "الأول - ١" },
            { teacherName: "بدر السحيمي", day: "الأحد", period: "4", subject: "القرآن الكريم والدراسات الإسلامية", className: "الأول - ١" },
            { teacherName: "مشعل العمري الحربي", day: "الأحد", period: "5", subject: "الرياضيات", className: "الأول - ١" },
            { teacherName: "عبدالمجيد الرشيدي", day: "الأحد", period: "6", subject: "المهارات الرقمية", className: "الأول - ١" },
            { teacherName: "أحمد الرشيدي", day: "الأحد", period: "7", subject: "اللغة الإنجليزية", className: "الأول - ١" }
        ];

        // دمج أسماء Excel مع البيانات الموجودة
        function mergeExcelTeachers() {
            const existingNames = new Set(teachers.map(t => t.name));
            excelTeachers.forEach(name => {
                if (!existingNames.has(name)) {
                    teachers.push({
                        id: Date.now() + Math.random(),
                        name: name,
                        subject: "غير محدد",
                        substituteCount: 0
                    });
                }
            });
        }

        // استيراد الجدول الافتراضي
        function importDefaultSchedule() {
            if (confirm('هل تريد استيراد الجدول المدرسي الافتراضي؟ سيتم إضافة جميع الحصص تلقائياً.')) {
                let addedCount = 0;
                
                defaultSchedule.forEach(entry => {
                    // تجنب التكرار
                    const exists = schedule.some(s => 
                        s.teacherName === entry.teacherName && 
                        s.day === entry.day && 
                        s.period === entry.period && 
                        s.className === entry.className
                    );
                    
                    if (!exists) {
                        schedule.push({
                            id: Date.now() + Math.random(),
                            teacherName: entry.teacherName,
                            day: entry.day,
                            period: entry.period,
                            subject: entry.subject,
                            className: entry.className
                        });
                        addedCount++;
                    }
                });

                renderSchedule();
                updateStats();
                showNotification(`تم استيراد ${addedCount} حصة بنجاح من الجدول الافتراضي`, 'success');
            }
        }

        // تحميل البيانات من localStorage
        function loadData() {
            const savedTeachers = localStorage.getItem('teachers');
            const savedSchedule = localStorage.getItem('schedule');
            const savedAbsences = localStorage.getItem('absences');

            if (savedTeachers) teachers = JSON.parse(savedTeachers);
            if (savedSchedule) schedule = JSON.parse(savedSchedule);
            if (savedAbsences) absences = JSON.parse(savedAbsences);

            // دمج أسماء Excel مع البيانات المحفوظة
            mergeExcelTeachers();
            
            renderAll();

            // إذا لم يكن هناك جدول، نعرض رسالة ترحيب
            if (schedule.length === 0) {
                showNotification('مرحباً! يمكنك استيراد الجدول الافتراضي باستخدام الزر أعلاه', 'success');
            }
        }

        // حفظ جميع البيانات
        function saveAllData() {
            localStorage.setItem('teachers', JSON.stringify(teachers));
            localStorage.setItem('schedule', JSON.stringify(schedule));
            localStorage.setItem('absences', JSON.stringify(absences));
            showNotification('تم حفظ البيانات بنجاح', 'success');
        }

        // مسح جميع البيانات
        function clearAllData() {
            if (confirm('هل أنت متأكد من حذف جميع البيانات؟ لا يمكن التراجع عن هذا الإجراء!')) {
                teachers = [];
                schedule = [];
                absences = [];
                localStorage.clear();
                renderAll();
                showNotification('تم حذف جميع البيانات', 'success');
            }
        }

        // إظهار الإشعارات
        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.className = `mb-4 p-4 rounded-lg notification flex items-center gap-3 ${
                type === 'success' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
            }`;
            notification.innerHTML = `
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${
                        type === 'success' 
                            ? 'M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z'
                            : 'M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z'
                    }"></path>
                </svg>
                <span class="font-semibold">${message}</span>
            `;
            notification.classList.remove('hidden');
            setTimeout(() => notification.classList.add('hidden'), 3000);
        }

        // التبديل بين التبويبات
        function switchTab(tab) {
            const tabs = ['teachers', 'schedule', 'absences'];
            tabs.forEach(t => {
                const tabBtn = document.getElementById(`tab-${t}`);
                const content = document.getElementById(`content-${t}`);
                if (t === tab) {
                    tabBtn.className = 'flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-active';
                    content.classList.remove('hidden');
                } else {
                    tabBtn.className = 'flex-1 flex items-center justify-center gap-2 px-6 py-4 font-semibold transition tab-inactive';
                    content.classList.add('hidden');
                }
            });
        }

        // إضافة معلم جديد
        function addTeacher() {
            const name = prompt('أدخل اسم المعلم:');
            const subject = prompt('أدخل التخصص:');
            if (name && subject) {
                teachers.push({
                    id: Date.now(),
                    name,
                    subject,
                    substituteCount: 0
                });
                renderTeachers();
                updateStats();
                showNotification('تم إضافة المعلم بنجاح', 'success');
            }
        }

        // حذف معلم
        function deleteTeacher(id) {
            if (confirm('هل أنت متأكد من حذف هذا المعلم؟')) {
                teachers = teachers.filter(t => t.id !== id);
                renderTeachers();
                updateStats();
                showNotification('تم حذف المعلم', 'success');
            }
        }

        // إضافة حصة للجدول
        function addScheduleEntry() {
            const teacherName = prompt('اسم المعلم:');
            const day = prompt('اليوم (الأحد، الاثنين، الثلاثاء، الأربعاء، الخميس):');
            const period = prompt('رقم الحصة (1-7):');
            const subject = prompt('المادة:');
            const className = prompt('الصف:');

            if (teacherName && day && period && subject && className) {
                schedule.push({
                    id: Date.now(),
                    teacherName,
                    day,
                    period,
                    subject,
                    className
                });
                renderSchedule();
                updateStats();
                showNotification('تم إضافة الحصة للجدول', 'success');
            }
        }

        // حذف حصة من الجدول
        function deleteSchedule(id) {
            schedule = schedule.filter(s => s.id !== id);
            renderSchedule();
            updateStats();
            showNotification('تم حذف الحصة', 'success');
        }

        // البحث عن معلم بديل
        function findSubstitute(absentTeacher, day, period) {
            const busyTeachers = schedule
                .filter(s => s.day === day && s.period === period)
                .map(s => s.teacherName);

            const availableTeachers = teachers
                .filter(t => t.name !== absentTeacher && !busyTeachers.includes(t.name))
                .sort((a, b) => a.substituteCount - b.substituteCount);

            return availableTeachers[0] || null;
        }

        // تسجيل غياب معلم
        function markAbsent() {
            const absentTeacherName = prompt('أدخل اسم المعلم الغائب:');
            if (!absentTeacherName) return;

            const todaySchedule = schedule.filter(s => s.teacherName === absentTeacherName);

            if (todaySchedule.length === 0) {
                showNotification('لا توجد حصص لهذا المعلم في الجدول', 'error');
                return;
            }

            todaySchedule.forEach(entry => {
                const substitute = findSubstitute(absentTeacherName, entry.day, entry.period);

                if (substitute) {
                    teachers = teachers.map(t =>
                        t.id === substitute.id
                            ? { ...t, substituteCount: t.substituteCount + 1 }
                            : t
                    );

                    absences.push({
                        id: Date.now() + Math.random(),
                        date: new Date().toLocaleDateString('ar-SA'),
                        absentTeacher: absentTeacherName,
                        substitute: substitute.name,
                        day: entry.day,
                        period: entry.period,
                        subject: entry.subject,
                        className: entry.className
                    });
                } else {
                    absences.push({
                        id: Date.now() + Math.random(),
                        date: new Date().toLocaleDateString('ar-SA'),
                        absentTeacher: absentTeacherName,
                        substitute: 'لا يوجد بديل متاح',
                        day: entry.day,
                        period: entry.period,
                        subject: entry.subject,
                        className: entry.className
                    });
                }
            });

            renderAbsences();
            renderTeachers();
            updateStats();
            showNotification(`تم تعيين البدلاء لـ ${todaySchedule.length} حصة`, 'success');
        }

        // حذف سجل غياب
        function deleteAbsence(id) {
            absences = absences.filter(a => a.id !== id);
            renderAbsences();
            updateStats();
            showNotification('تم حذف سجل الغياب', 'success');
        }

        // ========== الميزات الجديدة ==========

        // معالجة الجدول المدرسي المنسوخ
        function processPastedSchedule() {
            const pasteArea = document.getElementById('schedule-paste-area');
            const data = pasteArea.value.trim();
            
            if (!data) {
                showNotification('يرجى لصق الجدول أولاً', 'error');
                return;
            }

            const lines = data.split('\n').filter(line => line.trim());
            let scheduleEntries = [];
            let currentClass = '';
            let currentDay = '';
            let currentPeriod = 1;

            lines.forEach(line => {
                line = line.trim();
                
                // اكتشاف الصف
                if (line.includes('الثالث') || line.includes('الثاني') || line.includes('الأول')) {
                    currentClass = extractClassName(line);
                    return;
                }
                
                // اكتشاف اليوم
                const days = ['الأحد', 'الاثنين', 'الثلاثاء', 'الأربعاء', 'الخميس'];
                const foundDay = days.find(day => line.includes(day));
                if (foundDay) {
                    currentDay = foundDay;
                    currentPeriod = 1;
                    return;
                }
                
                // اكتشاف الحصة
                if (line.includes('الحصة')) {
                    currentPeriod = extractPeriodNumber(line);
                    return;
                }
                
                // استخراج بيانات الحصة
                const periodData = extractPeriodData(line, currentClass, currentDay, currentPeriod);
                if (periodData) {
                    scheduleEntries.push(periodData);
                    currentPeriod++;
                }
            });

            // إضافة الحصص إلى الجدول
            let addedCount = 0;
            scheduleEntries.forEach(entry => {
                if (isValidScheduleEntry(entry)) {
                    // تجنب التكرار
                    const exists = schedule.some(s => 
                        s.teacherName === entry.teacher && 
                        s.day === entry.day && 
                        s.period === entry.period && 
                        s.className === entry.className
                    );
                    
                    if (!exists) {
                        schedule.push({
                            id: Date.now() + Math.random(),
                            teacherName: entry.teacher,
                            day: entry.day,
                            period: entry.period,
                            subject: entry.subject,
                            className: entry.className
                        });
                        addedCount++;
                    }
                }
            });

            renderSchedule();
            updateStats();
            showNotification(`تمت إضافة ${addedCount} حصة بنجاح`, 'success');
            pasteArea.value = '';
        }

        // استخراج اسم الصف
        function extractClassName(line) {
            const classMatch = line.match(/(الثالث|الثاني|الأول)\s*-\s*[\d١٢٣٤٥٦]/);
            return classMatch ? classMatch[0] : '';
        }

        // استخراج رقم الحصة
        function extractPeriodNumber(line) {
            const periodMatch = line.match(/الحصة\s*(\d+)/);
            return periodMatch ? parseInt(periodMatch[1]) : 1;
        }

        // استخراج بيانات الحصة
        function extractPeriodData(line, className, day, period) {
            if (!line || line.includes('اليوم') || line.includes('الحصة') || !className || !day) {
                return null;
            }

            // استخراج المادة والمعلم
            const subjectMatch = line.match(/^([^:]+)/);
            const teacherMatch = line.match(/المعلم\s*:\s*([^\.]+)/);
            
            if (subjectMatch && teacherMatch) {
                return {
                    subject: subjectMatch[1].trim(),
                    teacher: teacherMatch[1].trim(),
                    className: className,
                    day: day,
                    period: period
                };
            }
            
            return null;
        }

        // التحقق من صحة بيانات الحصة
        function isValidScheduleEntry(entry) {
            return entry.teacher && entry.subject && entry.className && entry.day && entry.period;
        }

        // إدخال جماعي للبيانات
        function addBulkEntry() {
            const bulkData = prompt(`📝 أدخل بيانات الحصص (سطر لكل حصة - مفصولة بفاصلة):
            
الصيغة: المعلم,اليوم,الحصة,المادة,الصف

أمثلة:
محمد أحمد, الأحد, 1, رياضيات, أول/أ
علي سالم, الأحد, 2, علوم, ثاني/ب
فاطمة محمد, الأحد, 3, لغة عربية, ثالث/ج`);

            if (bulkData) {
                const lines = bulkData.split('\n');
                let added = 0;
                
                lines.forEach(line => {
                    const [teacher, day, period, subject, className] = line.split(',').map(item => item.trim());
                    if (teacher && day && period && subject && className) {
                        schedule.push({
                            id: Date.now() + Math.random(),
                            teacherName: teacher,
                            day: day,
                            period: period,
                            subject: subject,
                            className: className
                        });
                        added++;
                    }
                });
                
                renderSchedule();
                updateStats();
                showNotification(`تم إضافة ${added} حصة بنجاح`, 'success');
            }
        }

        // ========== نهاية الميزات الجديدة ==========

        // عرض قائمة المعلمين
        function renderTeachers() {
            const list = document.getElementById('teachers-list');
            if (teachers.length === 0) {
                list.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                        <p class="text-lg">لا توجد معلمين بعد. ابدأ بإضافة معلم!</p>
                    </div>
                `;
            } else {
                list.innerHTML = teachers.map(teacher => `
                    <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition">
                        <div>
                            <h3 class="font-bold text-lg text-gray-800">${teacher.name}</h3>
                            <p class="text-gray-600">التخصص: ${teacher.subject}</p>
                            <p class="text-sm text-indigo-600">عدد حصص الانتظار: ${teacher.substituteCount}</p>
                        </div>
                        <button onclick="deleteTeacher(${teacher.id})" class="text-red-600 hover:bg-red-100 p-2 rounded-lg transition">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                            </svg>
                        </button>
                    </div>
                `).join('');
            }
        }

        // عرض الجدول المدرسي
        function renderSchedule() {
            const list = document.getElementById('schedule-list');
            if (schedule.length === 0) {
                list.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                        <p class="text-lg">لا توجد حصص في الجدول. ابدأ باستيراد الجدول الافتراضي!</p>
                    </div>
                `;
            } else {
                list.innerHTML = `
                    <table class="w-full">
                        <thead>
                            <tr class="bg-indigo-600 text-white">
                                <th class="p-3 text-right">اليوم</th>
                                <th class="p-3 text-right">الحصة</th>
                                <th class="p-3 text-right">المعلم</th>
                                <th class="p-3 text-right">المادة</th>
                                <th class="p-3 text-right">الصف</th>
                                <th class="p-3 text-center">إجراءات</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${schedule.map(entry => `
                                <tr class="border-b hover:bg-gray-50">
                                    <td class="p-3">${entry.day}</td>
                                    <td class="p-3">${entry.period}</td>
                                    <td class="p-3 font-semibold">${entry.teacherName}</td>
                                    <td class="p-3">${entry.subject}</td>
                                    <td class="p-3">${entry.className}</td>
                                    <td class="p-3 text-center">
                                        <button onclick="deleteSchedule(${entry.id})" class="text-red-600 hover:bg-red-100 p-2 rounded-lg transition">
                                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                            </svg>
                                        </button>
                                    </td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;
            }
        }

        // عرض سجلات الغياب
        function renderAbsences() {
            const list = document.getElementById('absences-list');
            if (absences.length === 0) {
                list.innerHTML = `
                    <div class="text-center py-12 text-gray-500">
                        <svg class="w-16 h-16 mx-auto mb-4 opacity-50" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                        <p class="text-lg">لا توجد سجلات غياب حتى الآن</p>
                    </div>
                `;
            } else {
                list.innerHTML = absences.map(absence => `
                    <div class="p-4 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg border-r-4 border-orange-500">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <div class="flex items-center gap-2 mb-2 flex-wrap">
                                    <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-semibold">غائب</span>
                                    <span class="font-bold text-lg">${absence.absentTeacher}</span>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm">
                                    <div><span class="text-gray-600">البديل:</span> <span class="font-semibold text-green-700">${absence.substitute}</span></div>
                                    <div><span class="text-gray-600">التاريخ:</span> <span class="font-semibold">${absence.date}</span></div>
                                    <div><span class="text-gray-600">اليوم:</span> <span class="font-semibold">${absence.day}</span></div>
                                    <div><span class="text-gray-600">الحصة:</span> <span class="font-semibold">${absence.period}</span></div>
                                    <div><span class="text-gray-600">المادة:</span> <span class="font-semibold">${absence.subject}</span></div>
                                    <div><span class="text-gray-600">الصف:</span> <span class="font-semibold">${absence.className}</span></div>
                                </div>
                            </div>
                            <button onclick="deleteAbsence(${absence.id})" class="text-red-600 hover:bg-red-100 p-2 rounded-lg transition">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                `).join('');
            }
        }

        // تحديث الإحصائيات
        function updateStats() {
            document.getElementById('stat-teachers').textContent = teachers.length;
            document.getElementById('stat-schedule').textContent = schedule.length;
            document.getElementById('stat-absences').textContent = absences.length;
        }

        // عرض كل المحتوى
        function renderAll() {
            renderTeachers();
            renderSchedule();
            renderAbsences();
            updateStats();
        }

        // تهيئة الصفحة
        window.onload = function() {
            loadData();
        };
    </script>
</body>
</html>
